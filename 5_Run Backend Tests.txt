2026-01-11T11:20:28.1248478Z ##[group]Run # Only run if tests exist
2026-01-11T11:20:28.1248831Z [36;1m# Only run if tests exist[0m
2026-01-11T11:20:28.1249076Z [36;1mif [ -d "tests" ]; then[0m
2026-01-11T11:20:28.1249328Z [36;1m  export PYTHONPATH=$PYTHONPATH:.[0m
2026-01-11T11:20:28.1249598Z [36;1m  pytest tests/[0m
2026-01-11T11:20:28.1249796Z [36;1melse[0m
2026-01-11T11:20:28.1250008Z [36;1m  echo "No tests directory found, skipping"[0m
2026-01-11T11:20:28.1250289Z [36;1mfi[0m
2026-01-11T11:20:28.1284506Z shell: /usr/bin/bash -e {0}
2026-01-11T11:20:28.1284733Z env:
2026-01-11T11:20:28.1284979Z   pythonLocation: /opt/hostedtoolcache/Python/3.10.19/x64
2026-01-11T11:20:28.1285426Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.10.19/x64/lib/pkgconfig
2026-01-11T11:20:28.1285834Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.10.19/x64
2026-01-11T11:20:28.1286192Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.10.19/x64
2026-01-11T11:20:28.1286540Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.10.19/x64
2026-01-11T11:20:28.1287101Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.10.19/x64/lib
2026-01-11T11:20:28.1287407Z ##[endgroup]
2026-01-11T11:24:48.4466905Z ============================= test session starts ==============================
2026-01-11T11:24:48.4467533Z platform linux -- Python 3.10.19, pytest-9.0.2, pluggy-1.6.0
2026-01-11T11:24:48.4468458Z rootdir: /home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai
2026-01-11T11:24:48.4469118Z configfile: pytest.ini
2026-01-11T11:24:48.4469371Z plugins: asyncio-1.3.0, anyio-4.12.1
2026-01-11T11:24:48.4470026Z asyncio: mode=auto, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
2026-01-11T11:24:48.4470676Z collected 17 items
2026-01-11T11:24:48.4470823Z 
2026-01-11T11:24:49.2635780Z tests/integration/test_phd_pipeline.py FFFFFF..F...F                     [ 76%]
2026-01-11T11:24:49.9365125Z tests/test_api_basics.py FFFF                                            [100%]
2026-01-11T11:24:49.9365879Z 
2026-01-11T11:24:49.9366185Z =================================== FAILURES ===================================
2026-01-11T11:24:49.9367246Z _______________ TestPhDPipeline.test_literature_review_pipeline ________________
2026-01-11T11:24:49.9368016Z 
2026-01-11T11:24:49.9368368Z self = <urllib3.connection.HTTPConnection object at 0x7f2aeb2cdab0>
2026-01-11T11:24:49.9368721Z 
2026-01-11T11:24:49.9368860Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:49.9369303Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:49.9369715Z     
2026-01-11T11:24:49.9369928Z         :return: New socket connection.
2026-01-11T11:24:49.9370215Z         """
2026-01-11T11:24:49.9370407Z         try:
2026-01-11T11:24:49.9370645Z >           sock = connection.create_connection(
2026-01-11T11:24:49.9370986Z                 (self._dns_host, self.port),
2026-01-11T11:24:49.9371303Z                 self.timeout,
2026-01-11T11:24:49.9371702Z                 source_address=self.source_address,
2026-01-11T11:24:49.9372359Z                 socket_options=self.socket_options,
2026-01-11T11:24:49.9372720Z             )
2026-01-11T11:24:49.9372848Z 
2026-01-11T11:24:49.9373209Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:198: 
2026-01-11T11:24:49.9373872Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9374874Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:85: in create_connection
2026-01-11T11:24:49.9375724Z     raise err
2026-01-11T11:24:49.9376068Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9376437Z 
2026-01-11T11:24:49.9376659Z address = ('localhost', 3000), timeout = 10, source_address = None
2026-01-11T11:24:49.9377263Z socket_options = [(6, 1, 1)]
2026-01-11T11:24:49.9377477Z 
2026-01-11T11:24:49.9377639Z     def create_connection(
2026-01-11T11:24:49.9377977Z         address: tuple[str, int],
2026-01-11T11:24:49.9378824Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:49.9379257Z         source_address: tuple[str, int] | None = None,
2026-01-11T11:24:49.9425986Z         socket_options: _TYPE_SOCKET_OPTIONS | None = None,
2026-01-11T11:24:49.9426537Z     ) -> socket.socket:
2026-01-11T11:24:49.9426982Z         """Connect to *address* and return the socket object.
2026-01-11T11:24:49.9427461Z     
2026-01-11T11:24:49.9427904Z         Convenience function.  Connect to *address* (a 2-tuple ``(host,
2026-01-11T11:24:49.9428623Z         port)``) and return the socket object.  Passing the optional
2026-01-11T11:24:49.9429328Z         *timeout* parameter will set the timeout on the socket instance
2026-01-11T11:24:49.9430056Z         before attempting to connect.  If no *timeout* is supplied, the
2026-01-11T11:24:49.9430896Z         global default timeout setting returned by :func:`socket.getdefaulttimeout`
2026-01-11T11:24:49.9431750Z         is used.  If *source_address* is set it must be a tuple of (host, port)
2026-01-11T11:24:49.9432872Z         for the socket to bind as a source address before making the connection.
2026-01-11T11:24:49.9433605Z         An host of '' or port 0 tells the OS to use the default.
2026-01-11T11:24:49.9434274Z         """
2026-01-11T11:24:49.9434550Z     
2026-01-11T11:24:49.9434820Z         host, port = address
2026-01-11T11:24:49.9435194Z         if host.startswith("["):
2026-01-11T11:24:49.9435567Z             host = host.strip("[]")
2026-01-11T11:24:49.9435944Z         err = None
2026-01-11T11:24:49.9436209Z     
2026-01-11T11:24:49.9436688Z         # Using the value from allowed_gai_family() in the context of getaddrinfo lets
2026-01-11T11:24:49.9437535Z         # us select whether to work with IPv4 DNS records, IPv6 records, or both.
2026-01-11T11:24:49.9438339Z         # The original create_connection function always returns all records.
2026-01-11T11:24:49.9438953Z         family = allowed_gai_family()
2026-01-11T11:24:49.9439319Z     
2026-01-11T11:24:49.9439569Z         try:
2026-01-11T11:24:49.9439841Z             host.encode("idna")
2026-01-11T11:24:49.9440212Z         except UnicodeError:
2026-01-11T11:24:49.9440828Z             raise LocationParseError(f"'{host}', label empty or too long") from None
2026-01-11T11:24:49.9441447Z     
2026-01-11T11:24:49.9441889Z         for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
2026-01-11T11:24:49.9442553Z             af, socktype, proto, canonname, sa = res
2026-01-11T11:24:49.9442996Z             sock = None
2026-01-11T11:24:49.9443288Z             try:
2026-01-11T11:24:49.9443637Z                 sock = socket.socket(af, socktype, proto)
2026-01-11T11:24:49.9444230Z     
2026-01-11T11:24:49.9444614Z                 # If provided, set socket level options before connecting.
2026-01-11T11:24:49.9445224Z                 _set_socket_options(sock, socket_options)
2026-01-11T11:24:49.9445655Z     
2026-01-11T11:24:49.9445946Z                 if timeout is not _DEFAULT_TIMEOUT:
2026-01-11T11:24:49.9446420Z                     sock.settimeout(timeout)
2026-01-11T11:24:49.9446841Z                 if source_address:
2026-01-11T11:24:49.9447234Z                     sock.bind(source_address)
2026-01-11T11:24:49.9447651Z >               sock.connect(sa)
2026-01-11T11:24:49.9448151Z E               ConnectionRefusedError: [Errno 111] Connection refused
2026-01-11T11:24:49.9448575Z 
2026-01-11T11:24:49.9449223Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:73: ConnectionRefusedError
2026-01-11T11:24:49.9450051Z 
2026-01-11T11:24:49.9450344Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:49.9450804Z 
2026-01-11T11:24:49.9451157Z self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f0ab9090>
2026-01-11T11:24:49.9451837Z method = 'POST', url = '/api/v2/agent/goal'
2026-01-11T11:24:49.9452606Z body = b'{"goal": "Conduct literature review on Alzheimer\'s disease biomarkers", "stage": "early"}'
2026-01-11T11:24:49.9454822Z headers = {'User-Agent': 'python-requests/2.31.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': '*/*', 'Connection': 'keep-alive', 'Content-Length': '89', 'Content-Type': 'application/json'}
2026-01-11T11:24:49.9456333Z retries = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:49.9457003Z redirect = False, assert_same_host = False
2026-01-11T11:24:49.9457631Z timeout = Timeout(connect=10, read=10, total=None), pool_timeout = None
2026-01-11T11:24:49.9458478Z release_conn = False, chunked = False, body_pos = None, preload_content = False
2026-01-11T11:24:49.9459153Z decode_content = False, response_kw = {}
2026-01-11T11:24:49.9460013Z parsed_url = Url(scheme=None, auth=None, host=None, port=None, path='/api/v2/agent/goal', query=None, fragment=None)
2026-01-11T11:24:49.9461002Z destination_scheme = None, conn = None, release_this_conn = True
2026-01-11T11:24:49.9461697Z http_tunnel_required = False, err = None, clean_exit = False
2026-01-11T11:24:49.9462125Z 
2026-01-11T11:24:49.9462506Z     def urlopen(  # type: ignore[override]
2026-01-11T11:24:49.9462907Z         self,
2026-01-11T11:24:49.9463180Z         method: str,
2026-01-11T11:24:49.9463467Z         url: str,
2026-01-11T11:24:49.9463772Z         body: _TYPE_BODY | None = None,
2026-01-11T11:24:49.9464414Z         headers: typing.Mapping[str, str] | None = None,
2026-01-11T11:24:49.9464932Z         retries: Retry | bool | int | None = None,
2026-01-11T11:24:49.9465396Z         redirect: bool = True,
2026-01-11T11:24:49.9465781Z         assert_same_host: bool = True,
2026-01-11T11:24:49.9466227Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:49.9466686Z         pool_timeout: int | None = None,
2026-01-11T11:24:49.9467109Z         release_conn: bool | None = None,
2026-01-11T11:24:49.9467522Z         chunked: bool = False,
2026-01-11T11:24:49.9467936Z         body_pos: _TYPE_BODY_POSITION | None = None,
2026-01-11T11:24:49.9468411Z         preload_content: bool = True,
2026-01-11T11:24:49.9468797Z         decode_content: bool = True,
2026-01-11T11:24:49.9469220Z         **response_kw: typing.Any,
2026-01-11T11:24:49.9469639Z     ) -> BaseHTTPResponse:
2026-01-11T11:24:49.9469976Z         """
2026-01-11T11:24:49.9470449Z         Get a connection from the pool and perform an HTTP request. This is the
2026-01-11T11:24:49.9471246Z         lowest level call for making a request, so you'll need to specify all
2026-01-11T11:24:49.9471829Z         the raw details.
2026-01-11T11:24:49.9472139Z     
2026-01-11T11:24:49.9472473Z         .. note::
2026-01-11T11:24:49.9472743Z     
2026-01-11T11:24:49.9473099Z            More commonly, it's appropriate to use a convenience method
2026-01-11T11:24:49.9473433Z            such as :meth:`request`.
2026-01-11T11:24:49.9473650Z     
2026-01-11T11:24:49.9473877Z         .. note::
2026-01-11T11:24:49.9474479Z     
2026-01-11T11:24:49.9474808Z            `release_conn` will only behave as expected if
2026-01-11T11:24:49.9475362Z            `preload_content=False` because we want to make
2026-01-11T11:24:49.9476028Z            `preload_content=False` the default behaviour someday soon without
2026-01-11T11:24:49.9476665Z            breaking backwards compatibility.
2026-01-11T11:24:49.9477063Z     
2026-01-11T11:24:49.9477230Z         :param method:
2026-01-11T11:24:49.9477471Z             HTTP request method (such as GET, POST, PUT, etc.)
2026-01-11T11:24:49.9477744Z     
2026-01-11T11:24:49.9477898Z         :param url:
2026-01-11T11:24:49.9478089Z             The URL to perform the request on.
2026-01-11T11:24:49.9478318Z     
2026-01-11T11:24:49.9478456Z         :param body:
2026-01-11T11:24:49.9478734Z             Data to send in the request body, either :class:`str`, :class:`bytes`,
2026-01-11T11:24:49.9479154Z             an iterable of :class:`str`/:class:`bytes`, or a file-like object.
2026-01-11T11:24:49.9479466Z     
2026-01-11T11:24:49.9479608Z         :param headers:
2026-01-11T11:24:49.9479872Z             Dictionary of custom headers to send, such as User-Agent,
2026-01-11T11:24:49.9480695Z             If-None-Match, etc. If None, pool headers are used. If provided,
2026-01-11T11:24:49.9481428Z             these headers completely replace any pool-specific headers.
2026-01-11T11:24:49.9481966Z     
2026-01-11T11:24:49.9482211Z         :param retries:
2026-01-11T11:24:49.9482663Z             Configure the number of retries to allow before raising a
2026-01-11T11:24:49.9483315Z             :class:`~urllib3.exceptions.MaxRetryError` exception.
2026-01-11T11:24:49.9483711Z     
2026-01-11T11:24:49.9483969Z             If ``None`` (default) will retry 3 times, see ``Retry.DEFAULT``. Pass a
2026-01-11T11:24:49.9484621Z             :class:`~urllib3.util.retry.Retry` object for fine-grained control
2026-01-11T11:24:49.9484977Z             over different types of retries.
2026-01-11T11:24:49.9485299Z             Pass an integer number to retry connection errors that many times,
2026-01-11T11:24:49.9485691Z             but no other types of errors. Pass zero to never retry.
2026-01-11T11:24:49.9486113Z     
2026-01-11T11:24:49.9486356Z             If ``False``, then retries are disabled and any exception is raised
2026-01-11T11:24:49.9486832Z             immediately. Also, instead of raising a MaxRetryError on redirects,
2026-01-11T11:24:49.9487494Z             the redirect response will be returned.
2026-01-11T11:24:49.9487921Z     
2026-01-11T11:24:49.9488342Z         :type retries: :class:`~urllib3.util.retry.Retry`, False, or an int.
2026-01-11T11:24:49.9488905Z     
2026-01-11T11:24:49.9489153Z         :param redirect:
2026-01-11T11:24:49.9489637Z             If True, automatically handle redirects (status codes 301, 302,
2026-01-11T11:24:49.9490275Z             303, 307, 308). Each redirect counts as a retry. Disabling retries
2026-01-11T11:24:49.9490604Z             will disable redirect, too.
2026-01-11T11:24:49.9490824Z     
2026-01-11T11:24:49.9490973Z         :param assert_same_host:
2026-01-11T11:24:49.9491267Z             If ``True``, will make sure that the host of the pool requests is
2026-01-11T11:24:49.9491692Z             consistent else will raise HostChangedError. When ``False``, you can
2026-01-11T11:24:49.9492100Z             use the pool on an HTTP proxy and request foreign hosts.
2026-01-11T11:24:49.9492379Z     
2026-01-11T11:24:49.9492525Z         :param timeout:
2026-01-11T11:24:49.9492770Z             If specified, overrides the default timeout for this one
2026-01-11T11:24:49.9493130Z             request. It may be a float (in seconds) or an instance of
2026-01-11T11:24:49.9493448Z             :class:`urllib3.util.Timeout`.
2026-01-11T11:24:49.9493666Z     
2026-01-11T11:24:49.9493820Z         :param pool_timeout:
2026-01-11T11:24:49.9494358Z             If set and the pool is set to block=True, then this method will
2026-01-11T11:24:49.9495100Z             block for ``pool_timeout`` seconds and raise EmptyPoolError if no
2026-01-11T11:24:49.9495759Z             connection is available within the time period.
2026-01-11T11:24:49.9496236Z     
2026-01-11T11:24:49.9496509Z         :param bool preload_content:
2026-01-11T11:24:49.9497024Z             If True, the response's body will be preloaded into memory.
2026-01-11T11:24:49.9497504Z     
2026-01-11T11:24:49.9497661Z         :param bool decode_content:
2026-01-11T11:24:49.9497944Z             If True, will attempt to decode the body based on the
2026-01-11T11:24:49.9498238Z             'content-encoding' header.
2026-01-11T11:24:49.9498453Z     
2026-01-11T11:24:49.9498597Z         :param release_conn:
2026-01-11T11:24:49.9498886Z             If False, then the urlopen call will not release the connection
2026-01-11T11:24:49.9499296Z             back into the pool once a response is received (but will release if
2026-01-11T11:24:49.9499687Z             you read the entire contents of the response such as when
2026-01-11T11:24:49.9500204Z             `preload_content=True`). This is useful if you're not preloading
2026-01-11T11:24:49.9500907Z             the response's content immediately. You will need to call
2026-01-11T11:24:49.9501785Z             ``r.release_conn()`` on the response ``r`` to return the connection
2026-01-11T11:24:49.9502529Z             back into the pool. If None, it takes the value of ``preload_content``
2026-01-11T11:24:49.9503141Z             which defaults to ``True``.
2026-01-11T11:24:49.9503473Z     
2026-01-11T11:24:49.9503619Z         :param bool chunked:
2026-01-11T11:24:49.9503888Z             If True, urllib3 will send the body using chunked transfer
2026-01-11T11:24:49.9504462Z             encoding. Otherwise, urllib3 will send the body using the standard
2026-01-11T11:24:49.9504828Z             content-length form. Defaults to False.
2026-01-11T11:24:49.9505070Z     
2026-01-11T11:24:49.9505220Z         :param int body_pos:
2026-01-11T11:24:49.9505499Z             Position to seek to in file-like body in the event of a retry or
2026-01-11T11:24:49.9505913Z             redirect. Typically this won't need to be set because urllib3 will
2026-01-11T11:24:49.9506277Z             auto-populate the value when needed.
2026-01-11T11:24:49.9506642Z         """
2026-01-11T11:24:49.9506810Z         parsed_url = parse_url(url)
2026-01-11T11:24:49.9507051Z         destination_scheme = parsed_url.scheme
2026-01-11T11:24:49.9507281Z     
2026-01-11T11:24:49.9507424Z         if headers is None:
2026-01-11T11:24:49.9507738Z             headers = self.headers
2026-01-11T11:24:49.9508098Z     
2026-01-11T11:24:49.9508378Z         if not isinstance(retries, Retry):
2026-01-11T11:24:49.9509012Z             retries = Retry.from_int(retries, redirect=redirect, default=self.retries)
2026-01-11T11:24:49.9509629Z     
2026-01-11T11:24:49.9509892Z         if release_conn is None:
2026-01-11T11:24:49.9510274Z             release_conn = preload_content
2026-01-11T11:24:49.9510663Z     
2026-01-11T11:24:49.9510808Z         # Check host
2026-01-11T11:24:49.9511035Z         if assert_same_host and not self.is_same_host(url):
2026-01-11T11:24:49.9511344Z             raise HostChangedError(self, url, retries)
2026-01-11T11:24:49.9511604Z     
2026-01-11T11:24:49.9511835Z         # Ensure that the URL we're connecting to is properly encoded
2026-01-11T11:24:49.9512152Z         if url.startswith("/"):
2026-01-11T11:24:49.9512388Z             url = to_str(_encode_target(url))
2026-01-11T11:24:49.9512615Z         else:
2026-01-11T11:24:49.9512794Z             url = to_str(parsed_url.url)
2026-01-11T11:24:49.9513010Z     
2026-01-11T11:24:49.9513167Z         conn = None
2026-01-11T11:24:49.9513328Z     
2026-01-11T11:24:49.9513523Z         # Track whether `conn` needs to be released before
2026-01-11T11:24:49.9513897Z         # returning/raising/recursing. Update this variable if necessary, and
2026-01-11T11:24:49.9514859Z         # leave `release_conn` constant throughout the function. That way, if
2026-01-11T11:24:49.9515625Z         # the function recurses, the original value of `release_conn` will be
2026-01-11T11:24:49.9516400Z         # passed down into the recursive call, and its value will be respected.
2026-01-11T11:24:49.9517003Z         #
2026-01-11T11:24:49.9517273Z         # See issue #651 [1] for details.
2026-01-11T11:24:49.9517649Z         #
2026-01-11T11:24:49.9517873Z         # [1] <https://github.com/urllib3/urllib3/issues/651>
2026-01-11T11:24:49.9518168Z         release_this_conn = release_conn
2026-01-11T11:24:49.9518387Z     
2026-01-11T11:24:49.9518600Z         http_tunnel_required = connection_requires_http_tunnel(
2026-01-11T11:24:49.9518947Z             self.proxy, self.proxy_config, destination_scheme
2026-01-11T11:24:49.9519210Z         )
2026-01-11T11:24:49.9519350Z     
2026-01-11T11:24:49.9519587Z         # Merge the proxy headers. Only done when not using HTTP CONNECT. We
2026-01-11T11:24:49.9520019Z         # have to copy the headers dict so we can safely change it without those
2026-01-11T11:24:49.9520405Z         # changes being reflected in anyone else's copy.
2026-01-11T11:24:49.9520690Z         if not http_tunnel_required:
2026-01-11T11:24:49.9520985Z             headers = headers.copy()  # type: ignore[attr-defined]
2026-01-11T11:24:49.9521778Z             headers.update(self.proxy_headers)  # type: ignore[union-attr]
2026-01-11T11:24:49.9522339Z     
2026-01-11T11:24:49.9522779Z         # Must keep the exception bound to a separate variable or else Python 3
2026-01-11T11:24:49.9523420Z         # complains about UnboundLocalError.
2026-01-11T11:24:49.9523827Z         err = None
2026-01-11T11:24:49.9524244Z     
2026-01-11T11:24:49.9524645Z         # Keep track of whether we cleanly exited the except block. This
2026-01-11T11:24:49.9525049Z         # ensures we do proper cleanup in finally.
2026-01-11T11:24:49.9525304Z         clean_exit = False
2026-01-11T11:24:49.9525483Z     
2026-01-11T11:24:49.9525697Z         # Rewind body position, if needed. Record current position
2026-01-11T11:24:49.9526045Z         # for future rewinds in the event of a redirect/retry.
2026-01-11T11:24:49.9526366Z         body_pos = set_file_position(body, body_pos)
2026-01-11T11:24:49.9526615Z     
2026-01-11T11:24:49.9526890Z         try:
2026-01-11T11:24:49.9527098Z             # Request a connection from the queue.
2026-01-11T11:24:49.9527418Z             timeout_obj = self._get_timeout(timeout)
2026-01-11T11:24:49.9527705Z             conn = self._get_conn(timeout=pool_timeout)
2026-01-11T11:24:49.9528104Z     
2026-01-11T11:24:49.9528567Z             conn.timeout = timeout_obj.connect_timeout  # type: ignore[assignment]
2026-01-11T11:24:49.9529160Z     
2026-01-11T11:24:49.9529586Z             # Is this a closed/new connection that requires CONNECT tunnelling?
2026-01-11T11:24:49.9530348Z             if self.proxy is not None and http_tunnel_required and conn.is_closed:
2026-01-11T11:24:49.9530934Z                 try:
2026-01-11T11:24:49.9531263Z                     self._prepare_proxy(conn)
2026-01-11T11:24:49.9531639Z                 except (BaseSSLError, OSError, SocketTimeout) as e:
2026-01-11T11:24:49.9531945Z                     self._raise_timeout(
2026-01-11T11:24:49.9532235Z                         err=e, url=self.proxy.url, timeout_value=conn.timeout
2026-01-11T11:24:49.9532542Z                     )
2026-01-11T11:24:49.9532711Z                     raise
2026-01-11T11:24:49.9532904Z     
2026-01-11T11:24:49.9533123Z             # If we're going to release the connection in ``finally:``, then
2026-01-11T11:24:49.9533524Z             # the response doesn't need to know about the connection. Otherwise
2026-01-11T11:24:49.9533935Z             # it will also try to release it and we'll have a double-release
2026-01-11T11:24:49.9534441Z             # mess.
2026-01-11T11:24:49.9534670Z             response_conn = conn if not release_conn else None
2026-01-11T11:24:49.9534934Z     
2026-01-11T11:24:49.9535125Z             # Make the request on the HTTPConnection object
2026-01-11T11:24:49.9535581Z >           response = self._make_request(
2026-01-11T11:24:49.9535988Z                 conn,
2026-01-11T11:24:49.9536282Z                 method,
2026-01-11T11:24:49.9536578Z                 url,
2026-01-11T11:24:49.9536895Z                 timeout=timeout_obj,
2026-01-11T11:24:49.9537272Z                 body=body,
2026-01-11T11:24:49.9537606Z                 headers=headers,
2026-01-11T11:24:49.9537968Z                 chunked=chunked,
2026-01-11T11:24:49.9538325Z                 retries=retries,
2026-01-11T11:24:49.9538708Z                 response_conn=response_conn,
2026-01-11T11:24:49.9538975Z                 preload_content=preload_content,
2026-01-11T11:24:49.9539237Z                 decode_content=decode_content,
2026-01-11T11:24:49.9539469Z                 **response_kw,
2026-01-11T11:24:49.9539658Z             )
2026-01-11T11:24:49.9539751Z 
2026-01-11T11:24:49.9540036Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:787: 
2026-01-11T11:24:49.9540536Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9541500Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:493: in _make_request
2026-01-11T11:24:49.9542588Z     conn.request(
2026-01-11T11:24:49.9543290Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:445: in request
2026-01-11T11:24:49.9544249Z     self.endheaders()
2026-01-11T11:24:49.9544861Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1278: in endheaders
2026-01-11T11:24:49.9545705Z     self._send_output(message_body, encode_chunked=encode_chunked)
2026-01-11T11:24:49.9546558Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1038: in _send_output
2026-01-11T11:24:49.9547272Z     self.send(msg)
2026-01-11T11:24:49.9547815Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:976: in send
2026-01-11T11:24:49.9548470Z     self.connect()
2026-01-11T11:24:49.9549161Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:276: in connect
2026-01-11T11:24:49.9549991Z     self.sock = self._new_conn()
2026-01-11T11:24:49.9550455Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9551029Z 
2026-01-11T11:24:49.9551333Z self = <urllib3.connection.HTTPConnection object at 0x7f2aeb2cdab0>
2026-01-11T11:24:49.9551799Z 
2026-01-11T11:24:49.9551953Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:49.9552529Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:49.9553073Z     
2026-01-11T11:24:49.9553346Z         :return: New socket connection.
2026-01-11T11:24:49.9553728Z         """
2026-01-11T11:24:49.9553972Z         try:
2026-01-11T11:24:49.9554426Z             sock = connection.create_connection(
2026-01-11T11:24:49.9554883Z                 (self._dns_host, self.port),
2026-01-11T11:24:49.9555299Z                 self.timeout,
2026-01-11T11:24:49.9555689Z                 source_address=self.source_address,
2026-01-11T11:24:49.9556165Z                 socket_options=self.socket_options,
2026-01-11T11:24:49.9556584Z             )
2026-01-11T11:24:49.9556888Z         except socket.gaierror as e:
2026-01-11T11:24:49.9557397Z             raise NameResolutionError(self.host, self, e) from e
2026-01-11T11:24:49.9557923Z         except SocketTimeout as e:
2026-01-11T11:24:49.9558345Z             raise ConnectTimeoutError(
2026-01-11T11:24:49.9558737Z                 self,
2026-01-11T11:24:49.9559258Z                 f"Connection to {self.host} timed out. (connect timeout={self.timeout})",
2026-01-11T11:24:49.9559882Z             ) from e
2026-01-11T11:24:49.9560154Z     
2026-01-11T11:24:49.9560417Z         except OSError as e:
2026-01-11T11:24:49.9560783Z >           raise NewConnectionError(
2026-01-11T11:24:49.9561274Z                 self, f"Failed to establish a new connection: {e}"
2026-01-11T11:24:49.9561753Z             ) from e
2026-01-11T11:24:49.9562949Z E           urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f2aeb2cdab0>: Failed to establish a new connection: [Errno 111] Connection refused
2026-01-11T11:24:49.9564289Z 
2026-01-11T11:24:49.9564878Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:213: NewConnectionError
2026-01-11T11:24:49.9565640Z 
2026-01-11T11:24:49.9565932Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:49.9566402Z 
2026-01-11T11:24:49.9566669Z self = <requests.adapters.HTTPAdapter object at 0x7f29f08daaa0>
2026-01-11T11:24:49.9567288Z request = <PreparedRequest [POST]>, stream = False
2026-01-11T11:24:49.9567964Z timeout = Timeout(connect=10, read=10, total=None), verify = True, cert = None
2026-01-11T11:24:49.9568594Z proxies = OrderedDict()
2026-01-11T11:24:49.9568816Z 
2026-01-11T11:24:49.9568920Z     def send(
2026-01-11T11:24:49.9569435Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:49.9570069Z     ):
2026-01-11T11:24:49.9570454Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:49.9570956Z     
2026-01-11T11:24:49.9571615Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:49.9572403Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:49.9573123Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:49.9574684Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:49.9575030Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:49.9575335Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:49.9575743Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:49.9576230Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:49.9576588Z             must be a path to a CA bundle to use
2026-01-11T11:24:49.9576944Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:49.9577408Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:49.9577946Z         :rtype: requests.Response
2026-01-11T11:24:49.9578156Z         """
2026-01-11T11:24:49.9578297Z     
2026-01-11T11:24:49.9578435Z         try:
2026-01-11T11:24:49.9578642Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:49.9578935Z         except LocationValueError as e:
2026-01-11T11:24:49.9579191Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:49.9579428Z     
2026-01-11T11:24:49.9579621Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:49.9579920Z         url = self.request_url(request, proxies)
2026-01-11T11:24:49.9580167Z         self.add_headers(
2026-01-11T11:24:49.9580348Z             request,
2026-01-11T11:24:49.9580525Z             stream=stream,
2026-01-11T11:24:49.9580713Z             timeout=timeout,
2026-01-11T11:24:49.9580909Z             verify=verify,
2026-01-11T11:24:49.9581090Z             cert=cert,
2026-01-11T11:24:49.9581283Z             proxies=proxies,
2026-01-11T11:24:49.9581466Z         )
2026-01-11T11:24:49.9581606Z     
2026-01-11T11:24:49.9581873Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:49.9582219Z     
2026-01-11T11:24:49.9582387Z         if isinstance(timeout, tuple):
2026-01-11T11:24:49.9582602Z             try:
2026-01-11T11:24:49.9582772Z                 connect, read = timeout
2026-01-11T11:24:49.9583048Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:49.9583340Z             except ValueError:
2026-01-11T11:24:49.9583544Z                 raise ValueError(
2026-01-11T11:24:49.9583866Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:49.9584527Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:49.9584828Z                 )
2026-01-11T11:24:49.9585029Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:49.9585276Z             pass
2026-01-11T11:24:49.9585430Z         else:
2026-01-11T11:24:49.9585649Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:49.9585927Z     
2026-01-11T11:24:49.9586057Z         try:
2026-01-11T11:24:49.9586224Z >           resp = conn.urlopen(
2026-01-11T11:24:49.9586437Z                 method=request.method,
2026-01-11T11:24:49.9586661Z                 url=url,
2026-01-11T11:24:49.9586851Z                 body=request.body,
2026-01-11T11:24:49.9587071Z                 headers=request.headers,
2026-01-11T11:24:49.9587302Z                 redirect=False,
2026-01-11T11:24:49.9587509Z                 assert_same_host=False,
2026-01-11T11:24:49.9587743Z                 preload_content=False,
2026-01-11T11:24:49.9587969Z                 decode_content=False,
2026-01-11T11:24:49.9588199Z                 retries=self.max_retries,
2026-01-11T11:24:49.9588425Z                 timeout=timeout,
2026-01-11T11:24:49.9588754Z                 chunked=chunked,
2026-01-11T11:24:49.9588949Z             )
2026-01-11T11:24:49.9589042Z 
2026-01-11T11:24:49.9589300Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:486: 
2026-01-11T11:24:49.9589780Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9590291Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:841: in urlopen
2026-01-11T11:24:49.9590773Z     retries = retries.increment(
2026-01-11T11:24:49.9591027Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9591246Z 
2026-01-11T11:24:49.9591419Z self = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:49.9591822Z method = 'POST', url = '/api/v2/agent/goal', response = None
2026-01-11T11:24:49.9592532Z error = NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2aeb2cdab0>: Failed to establish a new connection: [Errno 111] Connection refused')
2026-01-11T11:24:49.9593442Z _pool = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f0ab9090>
2026-01-11T11:24:49.9593842Z _stacktrace = <traceback object at 0x7f29f0bd5dc0>
2026-01-11T11:24:49.9594149Z 
2026-01-11T11:24:49.9594216Z     def increment(
2026-01-11T11:24:49.9594379Z         self,
2026-01-11T11:24:49.9594541Z         method: str | None = None,
2026-01-11T11:24:49.9594758Z         url: str | None = None,
2026-01-11T11:24:49.9594991Z         response: BaseHTTPResponse | None = None,
2026-01-11T11:24:49.9595257Z         error: Exception | None = None,
2026-01-11T11:24:49.9595500Z         _pool: ConnectionPool | None = None,
2026-01-11T11:24:49.9595767Z         _stacktrace: TracebackType | None = None,
2026-01-11T11:24:49.9596008Z     ) -> Self:
2026-01-11T11:24:49.9596246Z         """Return a new Retry object with incremented retry counters.
2026-01-11T11:24:49.9596538Z     
2026-01-11T11:24:49.9596775Z         :param response: A response object, or None, if the server did not
2026-01-11T11:24:49.9597115Z             return a response.
2026-01-11T11:24:49.9597397Z         :type response: :class:`~urllib3.response.BaseHTTPResponse`
2026-01-11T11:24:49.9597814Z         :param Exception error: An error encountered during the request, or
2026-01-11T11:24:49.9598187Z             None if the response was received successfully.
2026-01-11T11:24:49.9598448Z     
2026-01-11T11:24:49.9598603Z         :return: A new ``Retry`` object.
2026-01-11T11:24:49.9598817Z         """
2026-01-11T11:24:49.9598986Z         if self.total is False and error:
2026-01-11T11:24:49.9599253Z             # Disabled, indicate to re-raise the error.
2026-01-11T11:24:49.9599555Z             raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:49.9599807Z     
2026-01-11T11:24:49.9599954Z         total = self.total
2026-01-11T11:24:49.9600144Z         if total is not None:
2026-01-11T11:24:49.9600346Z             total -= 1
2026-01-11T11:24:49.9600509Z     
2026-01-11T11:24:49.9600665Z         connect = self.connect
2026-01-11T11:24:49.9600867Z         read = self.read
2026-01-11T11:24:49.9601056Z         redirect = self.redirect
2026-01-11T11:24:49.9601275Z         status_count = self.status
2026-01-11T11:24:49.9601484Z         other = self.other
2026-01-11T11:24:49.9601674Z         cause = "unknown"
2026-01-11T11:24:49.9601854Z         status = None
2026-01-11T11:24:49.9602040Z         redirect_location = None
2026-01-11T11:24:49.9602230Z     
2026-01-11T11:24:49.9602414Z         if error and self._is_connection_error(error):
2026-01-11T11:24:49.9602672Z             # Connect retry?
2026-01-11T11:24:49.9602871Z             if connect is False:
2026-01-11T11:24:49.9603123Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:49.9603405Z             elif connect is not None:
2026-01-11T11:24:49.9603634Z                 connect -= 1
2026-01-11T11:24:49.9603815Z     
2026-01-11T11:24:49.9603993Z         elif error and self._is_read_error(error):
2026-01-11T11:24:49.9604582Z             # Read retry?
2026-01-11T11:24:49.9604901Z             if read is False or method is None or not self._is_method_retryable(method):
2026-01-11T11:24:49.9605310Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:49.9605590Z             elif read is not None:
2026-01-11T11:24:49.9605804Z                 read -= 1
2026-01-11T11:24:49.9605976Z     
2026-01-11T11:24:49.9606118Z         elif error:
2026-01-11T11:24:49.9606283Z             # Other retry?
2026-01-11T11:24:49.9606476Z             if other is not None:
2026-01-11T11:24:49.9606678Z                 other -= 1
2026-01-11T11:24:49.9606852Z     
2026-01-11T11:24:49.9607057Z         elif response and response.get_redirect_location():
2026-01-11T11:24:49.9607340Z             # Redirect retry?
2026-01-11T11:24:49.9607545Z             if redirect is not None:
2026-01-11T11:24:49.9607763Z                 redirect -= 1
2026-01-11T11:24:49.9607977Z             cause = "too many redirects"
2026-01-11T11:24:49.9608300Z             response_redirect_location = response.get_redirect_location()
2026-01-11T11:24:49.9608758Z             if response_redirect_location:
2026-01-11T11:24:49.9609037Z                 redirect_location = response_redirect_location
2026-01-11T11:24:49.9609320Z             status = response.status
2026-01-11T11:24:49.9609523Z     
2026-01-11T11:24:49.9609663Z         else:
2026-01-11T11:24:49.9609883Z             # Incrementing because of a server error like a 500 in
2026-01-11T11:24:49.9610264Z             # status_forcelist and the given method is in the allowed_methods
2026-01-11T11:24:49.9610623Z             cause = ResponseError.GENERIC_ERROR
2026-01-11T11:24:49.9610890Z             if response and response.status:
2026-01-11T11:24:49.9611140Z                 if status_count is not None:
2026-01-11T11:24:49.9611375Z                     status_count -= 1
2026-01-11T11:24:49.9611733Z                 cause = ResponseError.SPECIFIC_ERROR.format(status_code=response.status)
2026-01-11T11:24:49.9612113Z                 status = response.status
2026-01-11T11:24:49.9612337Z     
2026-01-11T11:24:49.9612493Z         history = self.history + (
2026-01-11T11:24:49.9612796Z             RequestHistory(method, url, error, status, redirect_location),
2026-01-11T11:24:49.9613114Z         )
2026-01-11T11:24:49.9613252Z     
2026-01-11T11:24:49.9613400Z         new_retry = self.new(
2026-01-11T11:24:49.9613596Z             total=total,
2026-01-11T11:24:49.9613790Z             connect=connect,
2026-01-11T11:24:49.9613976Z             read=read,
2026-01-11T11:24:49.9614291Z             redirect=redirect,
2026-01-11T11:24:49.9614494Z             status=status_count,
2026-01-11T11:24:49.9614699Z             other=other,
2026-01-11T11:24:49.9614884Z             history=history,
2026-01-11T11:24:49.9615062Z         )
2026-01-11T11:24:49.9615201Z     
2026-01-11T11:24:49.9615348Z         if new_retry.is_exhausted():
2026-01-11T11:24:49.9615599Z             reason = error or ResponseError(cause)
2026-01-11T11:24:49.9615988Z >           raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
2026-01-11T11:24:49.9617279Z E           urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/goal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2aeb2cdab0>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:49.9618365Z 
2026-01-11T11:24:49.9618668Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/retry.py:519: MaxRetryError
2026-01-11T11:24:49.9619073Z 
2026-01-11T11:24:49.9619237Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:49.9619500Z 
2026-01-11T11:24:49.9619659Z self = <test_phd_pipeline.TestPhDPipeline object at 0x7f2aec5b4bb0>
2026-01-11T11:24:49.9619910Z 
2026-01-11T11:24:49.9619989Z     @pytest.mark.asyncio
2026-01-11T11:24:49.9620230Z     async def test_literature_review_pipeline(self):
2026-01-11T11:24:49.9620661Z         """Test complete literature review workflow"""
2026-01-11T11:24:49.9620975Z         print("\n=== Testing Literature Review Pipeline ===")
2026-01-11T11:24:49.9621249Z     
2026-01-11T11:24:49.9621401Z         # 1. Start goal execution
2026-01-11T11:24:49.9621641Z         print("1. Starting goal execution...")
2026-01-11T11:24:49.9621897Z >       response = requests.post(
2026-01-11T11:24:49.9622132Z             f"{self.BASE_URL}/api/v2/agent/goal",
2026-01-11T11:24:49.9622373Z             json={
2026-01-11T11:24:49.9622646Z                 "goal": "Conduct literature review on Alzheimer's disease biomarkers",
2026-01-11T11:24:49.9622999Z                 "stage": "early"
2026-01-11T11:24:49.9623191Z             },
2026-01-11T11:24:49.9623349Z             timeout=10
2026-01-11T11:24:49.9623513Z         )
2026-01-11T11:24:49.9623605Z 
2026-01-11T11:24:49.9623705Z tests/integration/test_phd_pipeline.py:31: 
2026-01-11T11:24:49.9624006Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9624796Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:115: in post
2026-01-11T11:24:49.9625304Z     return request("post", url, data=data, json=json, **kwargs)
2026-01-11T11:24:49.9625787Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:59: in request
2026-01-11T11:24:49.9626286Z     return session.request(method=method, url=url, **kwargs)
2026-01-11T11:24:49.9626786Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:589: in request
2026-01-11T11:24:49.9627245Z     resp = self.send(prep, **send_kwargs)
2026-01-11T11:24:49.9627683Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:703: in send
2026-01-11T11:24:49.9628131Z     r = adapter.send(request, **kwargs)
2026-01-11T11:24:49.9628420Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9628644Z 
2026-01-11T11:24:49.9628806Z self = <requests.adapters.HTTPAdapter object at 0x7f29f08daaa0>
2026-01-11T11:24:49.9629161Z request = <PreparedRequest [POST]>, stream = False
2026-01-11T11:24:49.9629539Z timeout = Timeout(connect=10, read=10, total=None), verify = True, cert = None
2026-01-11T11:24:49.9629890Z proxies = OrderedDict()
2026-01-11T11:24:49.9630018Z 
2026-01-11T11:24:49.9630079Z     def send(
2026-01-11T11:24:49.9630371Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:49.9630730Z     ):
2026-01-11T11:24:49.9630948Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:49.9631234Z     
2026-01-11T11:24:49.9631500Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:49.9631937Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:49.9632346Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:49.9632756Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:49.9633090Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:49.9633387Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:49.9633796Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:49.9634364Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:49.9634721Z             must be a path to a CA bundle to use
2026-01-11T11:24:49.9635073Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:49.9635524Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:49.9635886Z         :rtype: requests.Response
2026-01-11T11:24:49.9636087Z         """
2026-01-11T11:24:49.9636230Z     
2026-01-11T11:24:49.9636368Z         try:
2026-01-11T11:24:49.9636573Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:49.9636993Z         except LocationValueError as e:
2026-01-11T11:24:49.9637250Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:49.9637483Z     
2026-01-11T11:24:49.9637674Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:49.9637974Z         url = self.request_url(request, proxies)
2026-01-11T11:24:49.9638218Z         self.add_headers(
2026-01-11T11:24:49.9638404Z             request,
2026-01-11T11:24:49.9638581Z             stream=stream,
2026-01-11T11:24:49.9638772Z             timeout=timeout,
2026-01-11T11:24:49.9638970Z             verify=verify,
2026-01-11T11:24:49.9639150Z             cert=cert,
2026-01-11T11:24:49.9639338Z             proxies=proxies,
2026-01-11T11:24:49.9639520Z         )
2026-01-11T11:24:49.9639661Z     
2026-01-11T11:24:49.9639929Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:49.9640282Z     
2026-01-11T11:24:49.9640440Z         if isinstance(timeout, tuple):
2026-01-11T11:24:49.9640782Z             try:
2026-01-11T11:24:49.9640955Z                 connect, read = timeout
2026-01-11T11:24:49.9641231Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:49.9641526Z             except ValueError:
2026-01-11T11:24:49.9641730Z                 raise ValueError(
2026-01-11T11:24:49.9642051Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:49.9642480Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:49.9642786Z                 )
2026-01-11T11:24:49.9642983Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:49.9643229Z             pass
2026-01-11T11:24:49.9643385Z         else:
2026-01-11T11:24:49.9643602Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:49.9643880Z     
2026-01-11T11:24:49.9644013Z         try:
2026-01-11T11:24:49.9644369Z             resp = conn.urlopen(
2026-01-11T11:24:49.9644600Z                 method=request.method,
2026-01-11T11:24:49.9644822Z                 url=url,
2026-01-11T11:24:49.9645009Z                 body=request.body,
2026-01-11T11:24:49.9645234Z                 headers=request.headers,
2026-01-11T11:24:49.9645462Z                 redirect=False,
2026-01-11T11:24:49.9645673Z                 assert_same_host=False,
2026-01-11T11:24:49.9645906Z                 preload_content=False,
2026-01-11T11:24:49.9646133Z                 decode_content=False,
2026-01-11T11:24:49.9646365Z                 retries=self.max_retries,
2026-01-11T11:24:49.9646595Z                 timeout=timeout,
2026-01-11T11:24:49.9646801Z                 chunked=chunked,
2026-01-11T11:24:49.9646987Z             )
2026-01-11T11:24:49.9647137Z     
2026-01-11T11:24:49.9647310Z         except (ProtocolError, OSError) as err:
2026-01-11T11:24:49.9647601Z             raise ConnectionError(err, request=request)
2026-01-11T11:24:49.9647855Z     
2026-01-11T11:24:49.9648013Z         except MaxRetryError as e:
2026-01-11T11:24:49.9648292Z             if isinstance(e.reason, ConnectTimeoutError):
2026-01-11T11:24:49.9648585Z                 # TODO: Remove this in 3.0.0: see #2811
2026-01-11T11:24:49.9648884Z                 if not isinstance(e.reason, NewConnectionError):
2026-01-11T11:24:49.9649201Z                     raise ConnectTimeout(e, request=request)
2026-01-11T11:24:49.9649454Z     
2026-01-11T11:24:49.9649628Z             if isinstance(e.reason, ResponseError):
2026-01-11T11:24:49.9649913Z                 raise RetryError(e, request=request)
2026-01-11T11:24:49.9650151Z     
2026-01-11T11:24:49.9650318Z             if isinstance(e.reason, _ProxyError):
2026-01-11T11:24:49.9650593Z                 raise ProxyError(e, request=request)
2026-01-11T11:24:49.9650822Z     
2026-01-11T11:24:49.9650994Z             if isinstance(e.reason, _SSLError):
2026-01-11T11:24:49.9651275Z                 # This branch is for urllib3 v1.22 and later.
2026-01-11T11:24:49.9651693Z                 raise SSLError(e, request=request)
2026-01-11T11:24:49.9651929Z     
2026-01-11T11:24:49.9652112Z >           raise ConnectionError(e, request=request)
2026-01-11T11:24:49.9653312Z E           requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/goal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2aeb2cdab0>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:49.9654506Z 
2026-01-11T11:24:49.9654820Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:519: ConnectionError
2026-01-11T11:24:49.9655390Z ----------------------------- Captured stdout call -----------------------------
2026-01-11T11:24:49.9655658Z 
2026-01-11T11:24:49.9655756Z === Testing Literature Review Pipeline ===
2026-01-11T11:24:49.9656004Z 1. Starting goal execution...
2026-01-11T11:24:49.9656320Z __________________ TestPhDPipeline.test_hypothesis_generation __________________
2026-01-11T11:24:49.9656725Z 
2026-01-11T11:24:49.9656891Z self = <urllib3.connection.HTTPConnection object at 0x7f29f078ddb0>
2026-01-11T11:24:49.9657155Z 
2026-01-11T11:24:49.9657242Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:49.9657559Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:49.9657863Z     
2026-01-11T11:24:49.9658023Z         :return: New socket connection.
2026-01-11T11:24:49.9658246Z         """
2026-01-11T11:24:49.9658392Z         try:
2026-01-11T11:24:49.9658573Z >           sock = connection.create_connection(
2026-01-11T11:24:49.9658838Z                 (self._dns_host, self.port),
2026-01-11T11:24:49.9659069Z                 self.timeout,
2026-01-11T11:24:49.9659291Z                 source_address=self.source_address,
2026-01-11T11:24:49.9659562Z                 socket_options=self.socket_options,
2026-01-11T11:24:49.9659799Z             )
2026-01-11T11:24:49.9659892Z 
2026-01-11T11:24:49.9660166Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:198: 
2026-01-11T11:24:49.9660643Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9661204Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:85: in create_connection
2026-01-11T11:24:49.9661696Z     raise err
2026-01-11T11:24:49.9661908Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9662122Z 
2026-01-11T11:24:49.9662271Z address = ('localhost', 3000), timeout = 10, source_address = None
2026-01-11T11:24:49.9662581Z socket_options = [(6, 1, 1)]
2026-01-11T11:24:49.9662717Z 
2026-01-11T11:24:49.9662797Z     def create_connection(
2026-01-11T11:24:49.9663000Z         address: tuple[str, int],
2026-01-11T11:24:49.9663243Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:49.9663532Z         source_address: tuple[str, int] | None = None,
2026-01-11T11:24:49.9663856Z         socket_options: _TYPE_SOCKET_OPTIONS | None = None,
2026-01-11T11:24:49.9664327Z     ) -> socket.socket:
2026-01-11T11:24:49.9664570Z         """Connect to *address* and return the socket object.
2026-01-11T11:24:49.9664837Z     
2026-01-11T11:24:49.9665074Z         Convenience function.  Connect to *address* (a 2-tuple ``(host,
2026-01-11T11:24:49.9665470Z         port)``) and return the socket object.  Passing the optional
2026-01-11T11:24:49.9665851Z         *timeout* parameter will set the timeout on the socket instance
2026-01-11T11:24:49.9666255Z         before attempting to connect.  If no *timeout* is supplied, the
2026-01-11T11:24:49.9666696Z         global default timeout setting returned by :func:`socket.getdefaulttimeout`
2026-01-11T11:24:49.9667160Z         is used.  If *source_address* is set it must be a tuple of (host, port)
2026-01-11T11:24:49.9667594Z         for the socket to bind as a source address before making the connection.
2026-01-11T11:24:49.9667984Z         An host of '' or port 0 tells the OS to use the default.
2026-01-11T11:24:49.9668394Z         """
2026-01-11T11:24:49.9668534Z     
2026-01-11T11:24:49.9668687Z         host, port = address
2026-01-11T11:24:49.9668895Z         if host.startswith("["):
2026-01-11T11:24:49.9669115Z             host = host.strip("[]")
2026-01-11T11:24:49.9669329Z         err = None
2026-01-11T11:24:49.9669483Z     
2026-01-11T11:24:49.9669754Z         # Using the value from allowed_gai_family() in the context of getaddrinfo lets
2026-01-11T11:24:49.9670220Z         # us select whether to work with IPv4 DNS records, IPv6 records, or both.
2026-01-11T11:24:49.9670665Z         # The original create_connection function always returns all records.
2026-01-11T11:24:49.9671010Z         family = allowed_gai_family()
2026-01-11T11:24:49.9671223Z     
2026-01-11T11:24:49.9671354Z         try:
2026-01-11T11:24:49.9671521Z             host.encode("idna")
2026-01-11T11:24:49.9671733Z         except UnicodeError:
2026-01-11T11:24:49.9672060Z             raise LocationParseError(f"'{host}', label empty or too long") from None
2026-01-11T11:24:49.9672524Z     
2026-01-11T11:24:49.9672772Z         for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
2026-01-11T11:24:49.9673145Z             af, socktype, proto, canonname, sa = res
2026-01-11T11:24:49.9673394Z             sock = None
2026-01-11T11:24:49.9673570Z             try:
2026-01-11T11:24:49.9673770Z                 sock = socket.socket(af, socktype, proto)
2026-01-11T11:24:49.9674130Z     
2026-01-11T11:24:49.9674352Z                 # If provided, set socket level options before connecting.
2026-01-11T11:24:49.9674688Z                 _set_socket_options(sock, socket_options)
2026-01-11T11:24:49.9674935Z     
2026-01-11T11:24:49.9675100Z                 if timeout is not _DEFAULT_TIMEOUT:
2026-01-11T11:24:49.9675362Z                     sock.settimeout(timeout)
2026-01-11T11:24:49.9675598Z                 if source_address:
2026-01-11T11:24:49.9675826Z                     sock.bind(source_address)
2026-01-11T11:24:49.9676071Z >               sock.connect(sa)
2026-01-11T11:24:49.9676354Z E               ConnectionRefusedError: [Errno 111] Connection refused
2026-01-11T11:24:49.9676592Z 
2026-01-11T11:24:49.9676956Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:73: ConnectionRefusedError
2026-01-11T11:24:49.9677413Z 
2026-01-11T11:24:49.9677576Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:49.9677841Z 
2026-01-11T11:24:49.9678040Z self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f078d870>
2026-01-11T11:24:49.9678420Z method = 'POST', url = '/api/v2/agent/goal'
2026-01-11T11:24:49.9678806Z body = b'{"goal": "Generate hypotheses for Alzheimer\'s drug targets", "stage": "middle"}'
2026-01-11T11:24:49.9679657Z headers = {'User-Agent': 'python-requests/2.31.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': '*/*', 'Connection': 'keep-alive', 'Content-Length': '79', 'Content-Type': 'application/json'}
2026-01-11T11:24:49.9680469Z retries = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:49.9680844Z redirect = False, assert_same_host = False
2026-01-11T11:24:49.9681177Z timeout = Timeout(connect=10, read=10, total=None), pool_timeout = None
2026-01-11T11:24:49.9681623Z release_conn = False, chunked = False, body_pos = None, preload_content = False
2026-01-11T11:24:49.9681999Z decode_content = False, response_kw = {}
2026-01-11T11:24:49.9682460Z parsed_url = Url(scheme=None, auth=None, host=None, port=None, path='/api/v2/agent/goal', query=None, fragment=None)
2026-01-11T11:24:49.9683012Z destination_scheme = None, conn = None, release_this_conn = True
2026-01-11T11:24:49.9683389Z http_tunnel_required = False, err = None, clean_exit = False
2026-01-11T11:24:49.9683623Z 
2026-01-11T11:24:49.9683710Z     def urlopen(  # type: ignore[override]
2026-01-11T11:24:49.9683936Z         self,
2026-01-11T11:24:49.9684277Z         method: str,
2026-01-11T11:24:49.9684577Z         url: str,
2026-01-11T11:24:49.9684758Z         body: _TYPE_BODY | None = None,
2026-01-11T11:24:49.9685033Z         headers: typing.Mapping[str, str] | None = None,
2026-01-11T11:24:49.9685325Z         retries: Retry | bool | int | None = None,
2026-01-11T11:24:49.9685581Z         redirect: bool = True,
2026-01-11T11:24:49.9685794Z         assert_same_host: bool = True,
2026-01-11T11:24:49.9686049Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:49.9686306Z         pool_timeout: int | None = None,
2026-01-11T11:24:49.9686546Z         release_conn: bool | None = None,
2026-01-11T11:24:49.9686781Z         chunked: bool = False,
2026-01-11T11:24:49.9687014Z         body_pos: _TYPE_BODY_POSITION | None = None,
2026-01-11T11:24:49.9687284Z         preload_content: bool = True,
2026-01-11T11:24:49.9687511Z         decode_content: bool = True,
2026-01-11T11:24:49.9687743Z         **response_kw: typing.Any,
2026-01-11T11:24:49.9687966Z     ) -> BaseHTTPResponse:
2026-01-11T11:24:49.9688162Z         """
2026-01-11T11:24:49.9688552Z         Get a connection from the pool and perform an HTTP request. This is the
2026-01-11T11:24:49.9689002Z         lowest level call for making a request, so you'll need to specify all
2026-01-11T11:24:49.9689346Z         the raw details.
2026-01-11T11:24:49.9689518Z     
2026-01-11T11:24:49.9689678Z         .. note::
2026-01-11T11:24:49.9689829Z     
2026-01-11T11:24:49.9690055Z            More commonly, it's appropriate to use a convenience method
2026-01-11T11:24:49.9690368Z            such as :meth:`request`.
2026-01-11T11:24:49.9690576Z     
2026-01-11T11:24:49.9690710Z         .. note::
2026-01-11T11:24:49.9690864Z     
2026-01-11T11:24:49.9691047Z            `release_conn` will only behave as expected if
2026-01-11T11:24:49.9691358Z            `preload_content=False` because we want to make
2026-01-11T11:24:49.9691723Z            `preload_content=False` the default behaviour someday soon without
2026-01-11T11:24:49.9692068Z            breaking backwards compatibility.
2026-01-11T11:24:49.9692307Z     
2026-01-11T11:24:49.9708175Z         :param method:
2026-01-11T11:24:49.9708527Z             HTTP request method (such as GET, POST, PUT, etc.)
2026-01-11T11:24:49.9708815Z     
2026-01-11T11:24:49.9708969Z         :param url:
2026-01-11T11:24:49.9709173Z             The URL to perform the request on.
2026-01-11T11:24:49.9709409Z     
2026-01-11T11:24:49.9709551Z         :param body:
2026-01-11T11:24:49.9709836Z             Data to send in the request body, either :class:`str`, :class:`bytes`,
2026-01-11T11:24:49.9710260Z             an iterable of :class:`str`/:class:`bytes`, or a file-like object.
2026-01-11T11:24:49.9710566Z     
2026-01-11T11:24:49.9710715Z         :param headers:
2026-01-11T11:24:49.9710981Z             Dictionary of custom headers to send, such as User-Agent,
2026-01-11T11:24:49.9711390Z             If-None-Match, etc. If None, pool headers are used. If provided,
2026-01-11T11:24:49.9711804Z             these headers completely replace any pool-specific headers.
2026-01-11T11:24:49.9712136Z     
2026-01-11T11:24:49.9712287Z         :param retries:
2026-01-11T11:24:49.9712554Z             Configure the number of retries to allow before raising a
2026-01-11T11:24:49.9712935Z             :class:`~urllib3.exceptions.MaxRetryError` exception.
2026-01-11T11:24:49.9713243Z     
2026-01-11T11:24:49.9713500Z             If ``None`` (default) will retry 3 times, see ``Retry.DEFAULT``. Pass a
2026-01-11T11:24:49.9713938Z             :class:`~urllib3.util.retry.Retry` object for fine-grained control
2026-01-11T11:24:49.9714441Z             over different types of retries.
2026-01-11T11:24:49.9714771Z             Pass an integer number to retry connection errors that many times,
2026-01-11T11:24:49.9715166Z             but no other types of errors. Pass zero to never retry.
2026-01-11T11:24:49.9715447Z     
2026-01-11T11:24:49.9715682Z             If ``False``, then retries are disabled and any exception is raised
2026-01-11T11:24:49.9716134Z             immediately. Also, instead of raising a MaxRetryError on redirects,
2026-01-11T11:24:49.9716689Z             the redirect response will be returned.
2026-01-11T11:24:49.9716935Z     
2026-01-11T11:24:49.9717180Z         :type retries: :class:`~urllib3.util.retry.Retry`, False, or an int.
2026-01-11T11:24:49.9717501Z     
2026-01-11T11:24:49.9717651Z         :param redirect:
2026-01-11T11:24:49.9717933Z             If True, automatically handle redirects (status codes 301, 302,
2026-01-11T11:24:49.9718346Z             303, 307, 308). Each redirect counts as a retry. Disabling retries
2026-01-11T11:24:49.9718671Z             will disable redirect, too.
2026-01-11T11:24:49.9718891Z     
2026-01-11T11:24:49.9719045Z         :param assert_same_host:
2026-01-11T11:24:49.9719342Z             If ``True``, will make sure that the host of the pool requests is
2026-01-11T11:24:49.9719757Z             consistent else will raise HostChangedError. When ``False``, you can
2026-01-11T11:24:49.9720168Z             use the pool on an HTTP proxy and request foreign hosts.
2026-01-11T11:24:49.9720582Z     
2026-01-11T11:24:49.9720725Z         :param timeout:
2026-01-11T11:24:49.9720989Z             If specified, overrides the default timeout for this one
2026-01-11T11:24:49.9721363Z             request. It may be a float (in seconds) or an instance of
2026-01-11T11:24:49.9721682Z             :class:`urllib3.util.Timeout`.
2026-01-11T11:24:49.9721907Z     
2026-01-11T11:24:49.9722062Z         :param pool_timeout:
2026-01-11T11:24:49.9722346Z             If set and the pool is set to block=True, then this method will
2026-01-11T11:24:49.9722757Z             block for ``pool_timeout`` seconds and raise EmptyPoolError if no
2026-01-11T11:24:49.9723136Z             connection is available within the time period.
2026-01-11T11:24:49.9723399Z     
2026-01-11T11:24:49.9723557Z         :param bool preload_content:
2026-01-11T11:24:49.9723856Z             If True, the response's body will be preloaded into memory.
2026-01-11T11:24:49.9724363Z     
2026-01-11T11:24:49.9724531Z         :param bool decode_content:
2026-01-11T11:24:49.9724807Z             If True, will attempt to decode the body based on the
2026-01-11T11:24:49.9725101Z             'content-encoding' header.
2026-01-11T11:24:49.9725310Z     
2026-01-11T11:24:49.9725458Z         :param release_conn:
2026-01-11T11:24:49.9725758Z             If False, then the urlopen call will not release the connection
2026-01-11T11:24:49.9726178Z             back into the pool once a response is received (but will release if
2026-01-11T11:24:49.9726582Z             you read the entire contents of the response such as when
2026-01-11T11:24:49.9726971Z             `preload_content=True`). This is useful if you're not preloading
2026-01-11T11:24:49.9727369Z             the response's content immediately. You will need to call
2026-01-11T11:24:49.9727755Z             ``r.release_conn()`` on the response ``r`` to return the connection
2026-01-11T11:24:49.9728187Z             back into the pool. If None, it takes the value of ``preload_content``
2026-01-11T11:24:49.9728551Z             which defaults to ``True``.
2026-01-11T11:24:49.9728771Z     
2026-01-11T11:24:49.9728922Z         :param bool chunked:
2026-01-11T11:24:49.9729197Z             If True, urllib3 will send the body using chunked transfer
2026-01-11T11:24:49.9729594Z             encoding. Otherwise, urllib3 will send the body using the standard
2026-01-11T11:24:49.9729956Z             content-length form. Defaults to False.
2026-01-11T11:24:49.9730201Z     
2026-01-11T11:24:49.9730348Z         :param int body_pos:
2026-01-11T11:24:49.9730641Z             Position to seek to in file-like body in the event of a retry or
2026-01-11T11:24:49.9731056Z             redirect. Typically this won't need to be set because urllib3 will
2026-01-11T11:24:49.9731419Z             auto-populate the value when needed.
2026-01-11T11:24:49.9731666Z         """
2026-01-11T11:24:49.9731838Z         parsed_url = parse_url(url)
2026-01-11T11:24:49.9732095Z         destination_scheme = parsed_url.scheme
2026-01-11T11:24:49.9732466Z     
2026-01-11T11:24:49.9732620Z         if headers is None:
2026-01-11T11:24:49.9732825Z             headers = self.headers
2026-01-11T11:24:49.9733032Z     
2026-01-11T11:24:49.9733193Z         if not isinstance(retries, Retry):
2026-01-11T11:24:49.9733558Z             retries = Retry.from_int(retries, redirect=redirect, default=self.retries)
2026-01-11T11:24:49.9733912Z     
2026-01-11T11:24:49.9734168Z         if release_conn is None:
2026-01-11T11:24:49.9734399Z             release_conn = preload_content
2026-01-11T11:24:49.9734615Z     
2026-01-11T11:24:49.9734755Z         # Check host
2026-01-11T11:24:49.9734977Z         if assert_same_host and not self.is_same_host(url):
2026-01-11T11:24:49.9735295Z             raise HostChangedError(self, url, retries)
2026-01-11T11:24:49.9735542Z     
2026-01-11T11:24:49.9735774Z         # Ensure that the URL we're connecting to is properly encoded
2026-01-11T11:24:49.9736095Z         if url.startswith("/"):
2026-01-11T11:24:49.9736463Z             url = to_str(_encode_target(url))
2026-01-11T11:24:49.9736701Z         else:
2026-01-11T11:24:49.9736872Z             url = to_str(parsed_url.url)
2026-01-11T11:24:49.9737097Z     
2026-01-11T11:24:49.9737236Z         conn = None
2026-01-11T11:24:49.9737402Z     
2026-01-11T11:24:49.9737591Z         # Track whether `conn` needs to be released before
2026-01-11T11:24:49.9737979Z         # returning/raising/recursing. Update this variable if necessary, and
2026-01-11T11:24:49.9738418Z         # leave `release_conn` constant throughout the function. That way, if
2026-01-11T11:24:49.9738845Z         # the function recurses, the original value of `release_conn` will be
2026-01-11T11:24:49.9739282Z         # passed down into the recursive call, and its value will be respected.
2026-01-11T11:24:49.9739610Z         #
2026-01-11T11:24:49.9739776Z         # See issue #651 [1] for details.
2026-01-11T11:24:49.9739993Z         #
2026-01-11T11:24:49.9740212Z         # [1] <https://github.com/urllib3/urllib3/issues/651>
2026-01-11T11:24:49.9740519Z         release_this_conn = release_conn
2026-01-11T11:24:49.9740744Z     
2026-01-11T11:24:49.9740959Z         http_tunnel_required = connection_requires_http_tunnel(
2026-01-11T11:24:49.9741313Z             self.proxy, self.proxy_config, destination_scheme
2026-01-11T11:24:49.9741579Z         )
2026-01-11T11:24:49.9741715Z     
2026-01-11T11:24:49.9741962Z         # Merge the proxy headers. Only done when not using HTTP CONNECT. We
2026-01-11T11:24:49.9742396Z         # have to copy the headers dict so we can safely change it without those
2026-01-11T11:24:49.9742781Z         # changes being reflected in anyone else's copy.
2026-01-11T11:24:49.9743061Z         if not http_tunnel_required:
2026-01-11T11:24:49.9743363Z             headers = headers.copy()  # type: ignore[attr-defined]
2026-01-11T11:24:49.9743753Z             headers.update(self.proxy_headers)  # type: ignore[union-attr]
2026-01-11T11:24:49.9744247Z     
2026-01-11T11:24:49.9744536Z         # Must keep the exception bound to a separate variable or else Python 3
2026-01-11T11:24:49.9744902Z         # complains about UnboundLocalError.
2026-01-11T11:24:49.9745161Z         err = None
2026-01-11T11:24:49.9745322Z     
2026-01-11T11:24:49.9745559Z         # Keep track of whether we cleanly exited the except block. This
2026-01-11T11:24:49.9745905Z         # ensures we do proper cleanup in finally.
2026-01-11T11:24:49.9746168Z         clean_exit = False
2026-01-11T11:24:49.9746354Z     
2026-01-11T11:24:49.9746576Z         # Rewind body position, if needed. Record current position
2026-01-11T11:24:49.9746941Z         # for future rewinds in the event of a redirect/retry.
2026-01-11T11:24:49.9747264Z         body_pos = set_file_position(body, body_pos)
2026-01-11T11:24:49.9747514Z     
2026-01-11T11:24:49.9747650Z         try:
2026-01-11T11:24:49.9747839Z             # Request a connection from the queue.
2026-01-11T11:24:49.9748116Z             timeout_obj = self._get_timeout(timeout)
2026-01-11T11:24:49.9748557Z             conn = self._get_conn(timeout=pool_timeout)
2026-01-11T11:24:49.9748809Z     
2026-01-11T11:24:49.9749068Z             conn.timeout = timeout_obj.connect_timeout  # type: ignore[assignment]
2026-01-11T11:24:49.9749411Z     
2026-01-11T11:24:49.9749654Z             # Is this a closed/new connection that requires CONNECT tunnelling?
2026-01-11T11:24:49.9750089Z             if self.proxy is not None and http_tunnel_required and conn.is_closed:
2026-01-11T11:24:49.9750421Z                 try:
2026-01-11T11:24:49.9750618Z                     self._prepare_proxy(conn)
2026-01-11T11:24:49.9750924Z                 except (BaseSSLError, OSError, SocketTimeout) as e:
2026-01-11T11:24:49.9751228Z                     self._raise_timeout(
2026-01-11T11:24:49.9751531Z                         err=e, url=self.proxy.url, timeout_value=conn.timeout
2026-01-11T11:24:49.9751828Z                     )
2026-01-11T11:24:49.9752004Z                     raise
2026-01-11T11:24:49.9752185Z     
2026-01-11T11:24:49.9752526Z             # If we're going to release the connection in ``finally:``, then
2026-01-11T11:24:49.9752933Z             # the response doesn't need to know about the connection. Otherwise
2026-01-11T11:24:49.9753343Z             # it will also try to release it and we'll have a double-release
2026-01-11T11:24:49.9753646Z             # mess.
2026-01-11T11:24:49.9753873Z             response_conn = conn if not release_conn else None
2026-01-11T11:24:49.9754288Z     
2026-01-11T11:24:49.9754484Z             # Make the request on the HTTPConnection object
2026-01-11T11:24:49.9754773Z >           response = self._make_request(
2026-01-11T11:24:49.9755001Z                 conn,
2026-01-11T11:24:49.9755178Z                 method,
2026-01-11T11:24:49.9755349Z                 url,
2026-01-11T11:24:49.9755530Z                 timeout=timeout_obj,
2026-01-11T11:24:49.9755750Z                 body=body,
2026-01-11T11:24:49.9755942Z                 headers=headers,
2026-01-11T11:24:49.9756159Z                 chunked=chunked,
2026-01-11T11:24:49.9756366Z                 retries=retries,
2026-01-11T11:24:49.9756589Z                 response_conn=response_conn,
2026-01-11T11:24:49.9756848Z                 preload_content=preload_content,
2026-01-11T11:24:49.9757119Z                 decode_content=decode_content,
2026-01-11T11:24:49.9757355Z                 **response_kw,
2026-01-11T11:24:49.9757555Z             )
2026-01-11T11:24:49.9757651Z 
2026-01-11T11:24:49.9757940Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:787: 
2026-01-11T11:24:49.9758440Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9758984Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:493: in _make_request
2026-01-11T11:24:49.9759474Z     conn.request(
2026-01-11T11:24:49.9759869Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:445: in request
2026-01-11T11:24:49.9760334Z     self.endheaders()
2026-01-11T11:24:49.9760680Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1278: in endheaders
2026-01-11T11:24:49.9761160Z     self._send_output(message_body, encode_chunked=encode_chunked)
2026-01-11T11:24:49.9761628Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1038: in _send_output
2026-01-11T11:24:49.9762025Z     self.send(msg)
2026-01-11T11:24:49.9762329Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:976: in send
2026-01-11T11:24:49.9762697Z     self.connect()
2026-01-11T11:24:49.9763084Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:276: in connect
2026-01-11T11:24:49.9763545Z     self.sock = self._new_conn()
2026-01-11T11:24:49.9763810Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9764173Z 
2026-01-11T11:24:49.9764434Z self = <urllib3.connection.HTTPConnection object at 0x7f29f078ddb0>
2026-01-11T11:24:49.9764839Z 
2026-01-11T11:24:49.9764930Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:49.9765257Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:49.9765567Z     
2026-01-11T11:24:49.9765729Z         :return: New socket connection.
2026-01-11T11:24:49.9765955Z         """
2026-01-11T11:24:49.9766106Z         try:
2026-01-11T11:24:49.9766291Z             sock = connection.create_connection(
2026-01-11T11:24:49.9766560Z                 (self._dns_host, self.port),
2026-01-11T11:24:49.9766797Z                 self.timeout,
2026-01-11T11:24:49.9767030Z                 source_address=self.source_address,
2026-01-11T11:24:49.9767304Z                 socket_options=self.socket_options,
2026-01-11T11:24:49.9767546Z             )
2026-01-11T11:24:49.9767720Z         except socket.gaierror as e:
2026-01-11T11:24:49.9768018Z             raise NameResolutionError(self.host, self, e) from e
2026-01-11T11:24:49.9768323Z         except SocketTimeout as e:
2026-01-11T11:24:49.9768690Z             raise ConnectTimeoutError(
2026-01-11T11:24:49.9768916Z                 self,
2026-01-11T11:24:49.9769220Z                 f"Connection to {self.host} timed out. (connect timeout={self.timeout})",
2026-01-11T11:24:49.9769575Z             ) from e
2026-01-11T11:24:49.9769735Z     
2026-01-11T11:24:49.9769893Z         except OSError as e:
2026-01-11T11:24:49.9770108Z >           raise NewConnectionError(
2026-01-11T11:24:49.9770392Z                 self, f"Failed to establish a new connection: {e}"
2026-01-11T11:24:49.9770667Z             ) from e
2026-01-11T11:24:49.9771326Z E           urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f29f078ddb0>: Failed to establish a new connection: [Errno 111] Connection refused
2026-01-11T11:24:49.9771977Z 
2026-01-11T11:24:49.9772300Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:213: NewConnectionError
2026-01-11T11:24:49.9772732Z 
2026-01-11T11:24:49.9772904Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:49.9773174Z 
2026-01-11T11:24:49.9773335Z self = <requests.adapters.HTTPAdapter object at 0x7f29f078c4c0>
2026-01-11T11:24:49.9773698Z request = <PreparedRequest [POST]>, stream = False
2026-01-11T11:24:49.9774182Z timeout = Timeout(connect=10, read=10, total=None), verify = True, cert = None
2026-01-11T11:24:49.9774544Z proxies = OrderedDict()
2026-01-11T11:24:49.9774671Z 
2026-01-11T11:24:49.9774732Z     def send(
2026-01-11T11:24:49.9775033Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:49.9775398Z     ):
2026-01-11T11:24:49.9775621Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:49.9775912Z     
2026-01-11T11:24:49.9776182Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:49.9776626Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:49.9777043Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:49.9777456Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:49.9777787Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:49.9778089Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:49.9778504Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:49.9778968Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:49.9779328Z             must be a path to a CA bundle to use
2026-01-11T11:24:49.9779680Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:49.9780140Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:49.9780508Z         :rtype: requests.Response
2026-01-11T11:24:49.9780714Z         """
2026-01-11T11:24:49.9780988Z     
2026-01-11T11:24:49.9781124Z         try:
2026-01-11T11:24:49.9781341Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:49.9781637Z         except LocationValueError as e:
2026-01-11T11:24:49.9781899Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:49.9782131Z     
2026-01-11T11:24:49.9782331Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:49.9782630Z         url = self.request_url(request, proxies)
2026-01-11T11:24:49.9782880Z         self.add_headers(
2026-01-11T11:24:49.9783068Z             request,
2026-01-11T11:24:49.9783241Z             stream=stream,
2026-01-11T11:24:49.9783439Z             timeout=timeout,
2026-01-11T11:24:49.9783632Z             verify=verify,
2026-01-11T11:24:49.9783819Z             cert=cert,
2026-01-11T11:24:49.9783999Z             proxies=proxies,
2026-01-11T11:24:49.9784416Z         )
2026-01-11T11:24:49.9784557Z     
2026-01-11T11:24:49.9784830Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:49.9785309Z     
2026-01-11T11:24:49.9785473Z         if isinstance(timeout, tuple):
2026-01-11T11:24:49.9785698Z             try:
2026-01-11T11:24:49.9785868Z                 connect, read = timeout
2026-01-11T11:24:49.9786153Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:49.9786442Z             except ValueError:
2026-01-11T11:24:49.9786653Z                 raise ValueError(
2026-01-11T11:24:49.9786973Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:49.9787404Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:49.9787709Z                 )
2026-01-11T11:24:49.9787904Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:49.9788149Z             pass
2026-01-11T11:24:49.9788306Z         else:
2026-01-11T11:24:49.9788540Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:49.9788825Z     
2026-01-11T11:24:49.9788962Z         try:
2026-01-11T11:24:49.9789128Z >           resp = conn.urlopen(
2026-01-11T11:24:49.9789213Z                 method=request.method,
2026-01-11T11:24:49.9789279Z                 url=url,
2026-01-11T11:24:49.9789352Z                 body=request.body,
2026-01-11T11:24:49.9789436Z                 headers=request.headers,
2026-01-11T11:24:49.9789507Z                 redirect=False,
2026-01-11T11:24:49.9789581Z                 assert_same_host=False,
2026-01-11T11:24:49.9789655Z                 preload_content=False,
2026-01-11T11:24:49.9789732Z                 decode_content=False,
2026-01-11T11:24:49.9789809Z                 retries=self.max_retries,
2026-01-11T11:24:49.9789879Z                 timeout=timeout,
2026-01-11T11:24:49.9789951Z                 chunked=chunked,
2026-01-11T11:24:49.9790007Z             )
2026-01-11T11:24:49.9790013Z 
2026-01-11T11:24:49.9790276Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:486: 
2026-01-11T11:24:49.9790409Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9790717Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:841: in urlopen
2026-01-11T11:24:49.9790799Z     retries = retries.increment(
2026-01-11T11:24:49.9790922Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9790927Z 
2026-01-11T11:24:49.9791105Z self = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:49.9791238Z method = 'POST', url = '/api/v2/agent/goal', response = None
2026-01-11T11:24:49.9791736Z error = NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f078ddb0>: Failed to establish a new connection: [Errno 111] Connection refused')
2026-01-11T11:24:49.9791942Z _pool = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f078d870>
2026-01-11T11:24:49.9792051Z _stacktrace = <traceback object at 0x7f29f04ca3c0>
2026-01-11T11:24:49.9792170Z 
2026-01-11T11:24:49.9792238Z     def increment(
2026-01-11T11:24:49.9792301Z         self,
2026-01-11T11:24:49.9792377Z         method: str | None = None,
2026-01-11T11:24:49.9792447Z         url: str | None = None,
2026-01-11T11:24:49.9792552Z         response: BaseHTTPResponse | None = None,
2026-01-11T11:24:49.9792634Z         error: Exception | None = None,
2026-01-11T11:24:49.9792724Z         _pool: ConnectionPool | None = None,
2026-01-11T11:24:49.9792823Z         _stacktrace: TracebackType | None = None,
2026-01-11T11:24:49.9792887Z     ) -> Self:
2026-01-11T11:24:49.9793034Z         """Return a new Retry object with incremented retry counters.
2026-01-11T11:24:49.9793092Z     
2026-01-11T11:24:49.9793263Z         :param response: A response object, or None, if the server did not
2026-01-11T11:24:49.9793337Z             return a response.
2026-01-11T11:24:49.9793492Z         :type response: :class:`~urllib3.response.BaseHTTPResponse`
2026-01-11T11:24:49.9793744Z         :param Exception error: An error encountered during the request, or
2026-01-11T11:24:49.9793862Z             None if the response was received successfully.
2026-01-11T11:24:49.9793920Z     
2026-01-11T11:24:49.9794004Z         :return: A new ``Retry`` object.
2026-01-11T11:24:49.9794166Z         """
2026-01-11T11:24:49.9794251Z         if self.total is False and error:
2026-01-11T11:24:49.9794356Z             # Disabled, indicate to re-raise the error.
2026-01-11T11:24:49.9794473Z             raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:49.9794531Z     
2026-01-11T11:24:49.9794603Z         total = self.total
2026-01-11T11:24:49.9794679Z         if total is not None:
2026-01-11T11:24:49.9794747Z             total -= 1
2026-01-11T11:24:49.9794803Z     
2026-01-11T11:24:49.9794877Z         connect = self.connect
2026-01-11T11:24:49.9794947Z         read = self.read
2026-01-11T11:24:49.9795023Z         redirect = self.redirect
2026-01-11T11:24:49.9795098Z         status_count = self.status
2026-01-11T11:24:49.9795181Z         other = self.other
2026-01-11T11:24:49.9795249Z         cause = "unknown"
2026-01-11T11:24:49.9795313Z         status = None
2026-01-11T11:24:49.9795387Z         redirect_location = None
2026-01-11T11:24:49.9795451Z     
2026-01-11T11:24:49.9795559Z         if error and self._is_connection_error(error):
2026-01-11T11:24:49.9795631Z             # Connect retry?
2026-01-11T11:24:49.9795706Z             if connect is False:
2026-01-11T11:24:49.9795822Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:49.9795902Z             elif connect is not None:
2026-01-11T11:24:49.9795972Z                 connect -= 1
2026-01-11T11:24:49.9796033Z     
2026-01-11T11:24:49.9796130Z         elif error and self._is_read_error(error):
2026-01-11T11:24:49.9796197Z             # Read retry?
2026-01-11T11:24:49.9796392Z             if read is False or method is None or not self._is_method_retryable(method):
2026-01-11T11:24:49.9796505Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:49.9796588Z             elif read is not None:
2026-01-11T11:24:49.9796659Z                 read -= 1
2026-01-11T11:24:49.9796716Z     
2026-01-11T11:24:49.9796780Z         elif error:
2026-01-11T11:24:49.9796848Z             # Other retry?
2026-01-11T11:24:49.9796927Z             if other is not None:
2026-01-11T11:24:49.9796993Z                 other -= 1
2026-01-11T11:24:49.9797050Z     
2026-01-11T11:24:49.9797177Z         elif response and response.get_redirect_location():
2026-01-11T11:24:49.9797249Z             # Redirect retry?
2026-01-11T11:24:49.9797326Z             if redirect is not None:
2026-01-11T11:24:49.9797396Z                 redirect -= 1
2026-01-11T11:24:49.9797484Z             cause = "too many redirects"
2026-01-11T11:24:49.9797644Z             response_redirect_location = response.get_redirect_location()
2026-01-11T11:24:49.9797729Z             if response_redirect_location:
2026-01-11T11:24:49.9797848Z                 redirect_location = response_redirect_location
2026-01-11T11:24:49.9798049Z             status = response.status
2026-01-11T11:24:49.9798104Z     
2026-01-11T11:24:49.9798165Z         else:
2026-01-11T11:24:49.9798297Z             # Incrementing because of a server error like a 500 in
2026-01-11T11:24:49.9798457Z             # status_forcelist and the given method is in the allowed_methods
2026-01-11T11:24:49.9798561Z             cause = ResponseError.GENERIC_ERROR
2026-01-11T11:24:49.9798653Z             if response and response.status:
2026-01-11T11:24:49.9798733Z                 if status_count is not None:
2026-01-11T11:24:49.9798809Z                     status_count -= 1
2026-01-11T11:24:49.9799018Z                 cause = ResponseError.SPECIFIC_ERROR.format(status_code=response.status)
2026-01-11T11:24:49.9799100Z                 status = response.status
2026-01-11T11:24:49.9799156Z     
2026-01-11T11:24:49.9799235Z         history = self.history + (
2026-01-11T11:24:49.9799404Z             RequestHistory(method, url, error, status, redirect_location),
2026-01-11T11:24:49.9799581Z         )
2026-01-11T11:24:49.9799638Z     
2026-01-11T11:24:49.9799714Z         new_retry = self.new(
2026-01-11T11:24:49.9799781Z             total=total,
2026-01-11T11:24:49.9799849Z             connect=connect,
2026-01-11T11:24:49.9799917Z             read=read,
2026-01-11T11:24:49.9799989Z             redirect=redirect,
2026-01-11T11:24:49.9800061Z             status=status_count,
2026-01-11T11:24:49.9800126Z             other=other,
2026-01-11T11:24:49.9800196Z             history=history,
2026-01-11T11:24:49.9800252Z         )
2026-01-11T11:24:49.9800307Z     
2026-01-11T11:24:49.9800386Z         if new_retry.is_exhausted():
2026-01-11T11:24:49.9800481Z             reason = error or ResponseError(cause)
2026-01-11T11:24:49.9800685Z >           raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
2026-01-11T11:24:49.9801671Z E           urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/goal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f078ddb0>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:49.9801692Z 
2026-01-11T11:24:49.9801997Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/retry.py:519: MaxRetryError
2026-01-11T11:24:49.9802003Z 
2026-01-11T11:24:49.9802169Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:49.9802175Z 
2026-01-11T11:24:49.9802341Z self = <test_phd_pipeline.TestPhDPipeline object at 0x7f2aec5b47f0>
2026-01-11T11:24:49.9802346Z 
2026-01-11T11:24:49.9802418Z     @pytest.mark.asyncio
2026-01-11T11:24:49.9802521Z     async def test_hypothesis_generation(self):
2026-01-11T11:24:49.9802640Z         """Test hypothesis generation from literature"""
2026-01-11T11:24:49.9802755Z         print("\n=== Testing Hypothesis Generation ===")
2026-01-11T11:24:49.9802817Z     
2026-01-11T11:24:49.9802932Z         # Start goal execution for hypothesis generation
2026-01-11T11:24:49.9803057Z         print("1. Starting hypothesis generation goal...")
2026-01-11T11:24:49.9803138Z >       response = requests.post(
2026-01-11T11:24:49.9803231Z             f"{self.BASE_URL}/api/v2/agent/goal",
2026-01-11T11:24:49.9803295Z             json={
2026-01-11T11:24:49.9803440Z                 "goal": "Generate hypotheses for Alzheimer's drug targets",
2026-01-11T11:24:49.9803512Z                 "stage": "middle"
2026-01-11T11:24:49.9803576Z             },
2026-01-11T11:24:49.9803640Z             timeout=10
2026-01-11T11:24:49.9803696Z         )
2026-01-11T11:24:49.9803701Z 
2026-01-11T11:24:49.9803796Z tests/integration/test_phd_pipeline.py:75: 
2026-01-11T11:24:49.9803921Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9804373Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:115: in post
2026-01-11T11:24:49.9804653Z     return request("post", url, data=data, json=json, **kwargs)
2026-01-11T11:24:49.9804921Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:59: in request
2026-01-11T11:24:49.9805054Z     return session.request(method=method, url=url, **kwargs)
2026-01-11T11:24:49.9805336Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:589: in request
2026-01-11T11:24:49.9805427Z     resp = self.send(prep, **send_kwargs)
2026-01-11T11:24:49.9805694Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:703: in send
2026-01-11T11:24:49.9805777Z     r = adapter.send(request, **kwargs)
2026-01-11T11:24:49.9805900Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9805906Z 
2026-01-11T11:24:49.9806059Z self = <requests.adapters.HTTPAdapter object at 0x7f29f078c4c0>
2026-01-11T11:24:49.9806169Z request = <PreparedRequest [POST]>, stream = False
2026-01-11T11:24:49.9806506Z timeout = Timeout(connect=10, read=10, total=None), verify = True, cert = None
2026-01-11T11:24:49.9806582Z proxies = OrderedDict()
2026-01-11T11:24:49.9806587Z 
2026-01-11T11:24:49.9806647Z     def send(
2026-01-11T11:24:49.9806850Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:49.9806913Z     ):
2026-01-11T11:24:49.9807053Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:49.9807111Z     
2026-01-11T11:24:49.9807310Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:49.9807466Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:49.9807625Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:49.9807779Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:49.9807867Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:49.9807999Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:49.9808196Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:49.9808367Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:49.9808458Z             must be a path to a CA bundle to use
2026-01-11T11:24:49.9808635Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:49.9808826Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:49.9808905Z         :rtype: requests.Response
2026-01-11T11:24:49.9808965Z         """
2026-01-11T11:24:49.9809027Z     
2026-01-11T11:24:49.9809085Z         try:
2026-01-11T11:24:49.9809204Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:49.9809290Z         except LocationValueError as e:
2026-01-11T11:24:49.9809383Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:49.9809446Z     
2026-01-11T11:24:49.9809564Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:49.9809659Z         url = self.request_url(request, proxies)
2026-01-11T11:24:49.9809728Z         self.add_headers(
2026-01-11T11:24:49.9809791Z             request,
2026-01-11T11:24:49.9809863Z             stream=stream,
2026-01-11T11:24:49.9809932Z             timeout=timeout,
2026-01-11T11:24:49.9809998Z             verify=verify,
2026-01-11T11:24:49.9810061Z             cert=cert,
2026-01-11T11:24:49.9810135Z             proxies=proxies,
2026-01-11T11:24:49.9810192Z         )
2026-01-11T11:24:49.9810248Z     
2026-01-11T11:24:49.9810446Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:49.9810502Z     
2026-01-11T11:24:49.9810589Z         if isinstance(timeout, tuple):
2026-01-11T11:24:49.9810649Z             try:
2026-01-11T11:24:49.9810734Z                 connect, read = timeout
2026-01-11T11:24:49.9810864Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:49.9811030Z             except ValueError:
2026-01-11T11:24:49.9811107Z                 raise ValueError(
2026-01-11T11:24:49.9811291Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:49.9811437Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:49.9811500Z                 )
2026-01-11T11:24:49.9811599Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:49.9811662Z             pass
2026-01-11T11:24:49.9811720Z         else:
2026-01-11T11:24:49.9811855Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:49.9811913Z     
2026-01-11T11:24:49.9811972Z         try:
2026-01-11T11:24:49.9812051Z             resp = conn.urlopen(
2026-01-11T11:24:49.9812129Z                 method=request.method,
2026-01-11T11:24:49.9812193Z                 url=url,
2026-01-11T11:24:49.9812266Z                 body=request.body,
2026-01-11T11:24:49.9812430Z                 headers=request.headers,
2026-01-11T11:24:49.9812502Z                 redirect=False,
2026-01-11T11:24:49.9812576Z                 assert_same_host=False,
2026-01-11T11:24:49.9812657Z                 preload_content=False,
2026-01-11T11:24:49.9812732Z                 decode_content=False,
2026-01-11T11:24:49.9812811Z                 retries=self.max_retries,
2026-01-11T11:24:49.9812881Z                 timeout=timeout,
2026-01-11T11:24:49.9812953Z                 chunked=chunked,
2026-01-11T11:24:49.9813011Z             )
2026-01-11T11:24:49.9813068Z     
2026-01-11T11:24:49.9813170Z         except (ProtocolError, OSError) as err:
2026-01-11T11:24:49.9813279Z             raise ConnectionError(err, request=request)
2026-01-11T11:24:49.9813336Z     
2026-01-11T11:24:49.9813414Z         except MaxRetryError as e:
2026-01-11T11:24:49.9813533Z             if isinstance(e.reason, ConnectTimeoutError):
2026-01-11T11:24:49.9813627Z                 # TODO: Remove this in 3.0.0: see #2811
2026-01-11T11:24:49.9813763Z                 if not isinstance(e.reason, NewConnectionError):
2026-01-11T11:24:49.9813877Z                     raise ConnectTimeout(e, request=request)
2026-01-11T11:24:49.9813933Z     
2026-01-11T11:24:49.9814131Z             if isinstance(e.reason, ResponseError):
2026-01-11T11:24:49.9814236Z                 raise RetryError(e, request=request)
2026-01-11T11:24:49.9814317Z     
2026-01-11T11:24:49.9814413Z             if isinstance(e.reason, _ProxyError):
2026-01-11T11:24:49.9814508Z                 raise ProxyError(e, request=request)
2026-01-11T11:24:49.9814567Z     
2026-01-11T11:24:49.9814655Z             if isinstance(e.reason, _SSLError):
2026-01-11T11:24:49.9814767Z                 # This branch is for urllib3 v1.22 and later.
2026-01-11T11:24:49.9814859Z                 raise SSLError(e, request=request)
2026-01-11T11:24:49.9814915Z     
2026-01-11T11:24:49.9815017Z >           raise ConnectionError(e, request=request)
2026-01-11T11:24:49.9816027Z E           requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/goal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f078ddb0>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:49.9816039Z 
2026-01-11T11:24:49.9816350Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:519: ConnectionError
2026-01-11T11:24:49.9816507Z ----------------------------- Captured stdout call -----------------------------
2026-01-11T11:24:49.9816513Z 
2026-01-11T11:24:49.9816603Z === Testing Hypothesis Generation ===
2026-01-11T11:24:49.9816694Z 1. Starting hypothesis generation goal...
2026-01-11T11:24:49.9816870Z ____________________ TestPhDPipeline.test_api_goal_endpoint ____________________
2026-01-11T11:24:49.9816875Z 
2026-01-11T11:24:49.9817047Z self = <urllib3.connection.HTTPConnection object at 0x7f29f0550d90>
2026-01-11T11:24:49.9817169Z 
2026-01-11T11:24:49.9817257Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:49.9817412Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:49.9817471Z     
2026-01-11T11:24:49.9817562Z         :return: New socket connection.
2026-01-11T11:24:49.9817622Z         """
2026-01-11T11:24:49.9817682Z         try:
2026-01-11T11:24:49.9817780Z >           sock = connection.create_connection(
2026-01-11T11:24:49.9817870Z                 (self._dns_host, self.port),
2026-01-11T11:24:49.9817940Z                 self.timeout,
2026-01-11T11:24:49.9818036Z                 source_address=self.source_address,
2026-01-11T11:24:49.9818133Z                 socket_options=self.socket_options,
2026-01-11T11:24:49.9818191Z             )
2026-01-11T11:24:49.9818197Z 
2026-01-11T11:24:49.9818456Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:198: 
2026-01-11T11:24:49.9818582Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9819034Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:85: in create_connection
2026-01-11T11:24:49.9819097Z     raise err
2026-01-11T11:24:49.9819217Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9819222Z 
2026-01-11T11:24:49.9819371Z address = ('localhost', 3000), timeout = 10, source_address = None
2026-01-11T11:24:49.9819447Z socket_options = [(6, 1, 1)]
2026-01-11T11:24:49.9819452Z 
2026-01-11T11:24:49.9819531Z     def create_connection(
2026-01-11T11:24:49.9819610Z         address: tuple[str, int],
2026-01-11T11:24:49.9819707Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:49.9819819Z         source_address: tuple[str, int] | None = None,
2026-01-11T11:24:49.9819942Z         socket_options: _TYPE_SOCKET_OPTIONS | None = None,
2026-01-11T11:24:49.9820013Z     ) -> socket.socket:
2026-01-11T11:24:49.9820132Z         """Connect to *address* and return the socket object.
2026-01-11T11:24:49.9820207Z     
2026-01-11T11:24:49.9820368Z         Convenience function.  Connect to *address* (a 2-tuple ``(host,
2026-01-11T11:24:49.9820512Z         port)``) and return the socket object.  Passing the optional
2026-01-11T11:24:49.9820672Z         *timeout* parameter will set the timeout on the socket instance
2026-01-11T11:24:49.9820826Z         before attempting to connect.  If no *timeout* is supplied, the
2026-01-11T11:24:49.9821026Z         global default timeout setting returned by :func:`socket.getdefaulttimeout`
2026-01-11T11:24:49.9821199Z         is used.  If *source_address* is set it must be a tuple of (host, port)
2026-01-11T11:24:49.9821371Z         for the socket to bind as a source address before making the connection.
2026-01-11T11:24:49.9821497Z         An host of '' or port 0 tells the OS to use the default.
2026-01-11T11:24:49.9821560Z         """
2026-01-11T11:24:49.9821623Z     
2026-01-11T11:24:49.9821697Z         host, port = address
2026-01-11T11:24:49.9821782Z         if host.startswith("["):
2026-01-11T11:24:49.9821865Z             host = host.strip("[]")
2026-01-11T11:24:49.9821931Z         err = None
2026-01-11T11:24:49.9821988Z     
2026-01-11T11:24:49.9822183Z         # Using the value from allowed_gai_family() in the context of getaddrinfo lets
2026-01-11T11:24:49.9822364Z         # us select whether to work with IPv4 DNS records, IPv6 records, or both.
2026-01-11T11:24:49.9822534Z         # The original create_connection function always returns all records.
2026-01-11T11:24:49.9822615Z         family = allowed_gai_family()
2026-01-11T11:24:49.9822679Z     
2026-01-11T11:24:49.9822738Z         try:
2026-01-11T11:24:49.9822812Z             host.encode("idna")
2026-01-11T11:24:49.9822891Z         except UnicodeError:
2026-01-11T11:24:49.9823080Z             raise LocationParseError(f"'{host}', label empty or too long") from None
2026-01-11T11:24:49.9823138Z     
2026-01-11T11:24:49.9823310Z         for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
2026-01-11T11:24:49.9823508Z             af, socktype, proto, canonname, sa = res
2026-01-11T11:24:49.9823578Z             sock = None
2026-01-11T11:24:49.9823638Z             try:
2026-01-11T11:24:49.9823752Z                 sock = socket.socket(af, socktype, proto)
2026-01-11T11:24:49.9823809Z     
2026-01-11T11:24:49.9823952Z                 # If provided, set socket level options before connecting.
2026-01-11T11:24:49.9824233Z                 _set_socket_options(sock, socket_options)
2026-01-11T11:24:49.9824327Z     
2026-01-11T11:24:49.9824425Z                 if timeout is not _DEFAULT_TIMEOUT:
2026-01-11T11:24:49.9824513Z                     sock.settimeout(timeout)
2026-01-11T11:24:49.9824592Z                 if source_address:
2026-01-11T11:24:49.9824678Z                     sock.bind(source_address)
2026-01-11T11:24:49.9824751Z >               sock.connect(sa)
2026-01-11T11:24:49.9824904Z E               ConnectionRefusedError: [Errno 111] Connection refused
2026-01-11T11:24:49.9825037Z 
2026-01-11T11:24:49.9825401Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:73: ConnectionRefusedError
2026-01-11T11:24:49.9825408Z 
2026-01-11T11:24:49.9825577Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:49.9825583Z 
2026-01-11T11:24:49.9825789Z self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f05513f0>
2026-01-11T11:24:49.9825880Z method = 'POST', url = '/api/v2/agent/goal'
2026-01-11T11:24:49.9825980Z body = b'{"goal": "Test goal", "stage": "early"}'
2026-01-11T11:24:49.9826527Z headers = {'User-Agent': 'python-requests/2.31.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': '*/*', 'Connection': 'keep-alive', 'Content-Length': '39', 'Content-Type': 'application/json'}
2026-01-11T11:24:49.9826714Z retries = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:49.9826805Z redirect = False, assert_same_host = False
2026-01-11T11:24:49.9826979Z timeout = Timeout(connect=10, read=10, total=None), pool_timeout = None
2026-01-11T11:24:49.9827173Z release_conn = False, chunked = False, body_pos = None, preload_content = False
2026-01-11T11:24:49.9827263Z decode_content = False, response_kw = {}
2026-01-11T11:24:49.9827570Z parsed_url = Url(scheme=None, auth=None, host=None, port=None, path='/api/v2/agent/goal', query=None, fragment=None)
2026-01-11T11:24:49.9827730Z destination_scheme = None, conn = None, release_this_conn = True
2026-01-11T11:24:49.9827871Z http_tunnel_required = False, err = None, clean_exit = False
2026-01-11T11:24:49.9827876Z 
2026-01-11T11:24:49.9827964Z     def urlopen(  # type: ignore[override]
2026-01-11T11:24:49.9828031Z         self,
2026-01-11T11:24:49.9828097Z         method: str,
2026-01-11T11:24:49.9828158Z         url: str,
2026-01-11T11:24:49.9828244Z         body: _TYPE_BODY | None = None,
2026-01-11T11:24:49.9828360Z         headers: typing.Mapping[str, str] | None = None,
2026-01-11T11:24:49.9828457Z         retries: Retry | bool | int | None = None,
2026-01-11T11:24:49.9828547Z         redirect: bool = True,
2026-01-11T11:24:49.9828629Z         assert_same_host: bool = True,
2026-01-11T11:24:49.9828724Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:49.9828805Z         pool_timeout: int | None = None,
2026-01-11T11:24:49.9828890Z         release_conn: bool | None = None,
2026-01-11T11:24:49.9828962Z         chunked: bool = False,
2026-01-11T11:24:49.9829066Z         body_pos: _TYPE_BODY_POSITION | None = None,
2026-01-11T11:24:49.9829155Z         preload_content: bool = True,
2026-01-11T11:24:49.9829235Z         decode_content: bool = True,
2026-01-11T11:24:49.9829314Z         **response_kw: typing.Any,
2026-01-11T11:24:49.9829393Z     ) -> BaseHTTPResponse:
2026-01-11T11:24:49.9829459Z         """
2026-01-11T11:24:49.9829643Z         Get a connection from the pool and perform an HTTP request. This is the
2026-01-11T11:24:49.9829816Z         lowest level call for making a request, so you'll need to specify all
2026-01-11T11:24:49.9830016Z         the raw details.
2026-01-11T11:24:49.9830074Z     
2026-01-11T11:24:49.9830153Z         .. note::
2026-01-11T11:24:49.9830216Z     
2026-01-11T11:24:49.9830370Z            More commonly, it's appropriate to use a convenience method
2026-01-11T11:24:49.9830448Z            such as :meth:`request`.
2026-01-11T11:24:49.9830505Z     
2026-01-11T11:24:49.9830573Z         .. note::
2026-01-11T11:24:49.9830630Z     
2026-01-11T11:24:49.9830743Z            `release_conn` will only behave as expected if
2026-01-11T11:24:49.9830861Z            `preload_content=False` because we want to make
2026-01-11T11:24:49.9831027Z            `preload_content=False` the default behaviour someday soon without
2026-01-11T11:24:49.9831118Z            breaking backwards compatibility.
2026-01-11T11:24:49.9831176Z     
2026-01-11T11:24:49.9831249Z         :param method:
2026-01-11T11:24:49.9831373Z             HTTP request method (such as GET, POST, PUT, etc.)
2026-01-11T11:24:49.9831435Z     
2026-01-11T11:24:49.9831610Z         :param url:
2026-01-11T11:24:49.9831703Z             The URL to perform the request on.
2026-01-11T11:24:49.9831760Z     
2026-01-11T11:24:49.9831825Z         :param body:
2026-01-11T11:24:49.9831995Z             Data to send in the request body, either :class:`str`, :class:`bytes`,
2026-01-11T11:24:49.9832151Z             an iterable of :class:`str`/:class:`bytes`, or a file-like object.
2026-01-11T11:24:49.9832207Z     
2026-01-11T11:24:49.9832281Z         :param headers:
2026-01-11T11:24:49.9832429Z             Dictionary of custom headers to send, such as User-Agent,
2026-01-11T11:24:49.9832592Z             If-None-Match, etc. If None, pool headers are used. If provided,
2026-01-11T11:24:49.9832750Z             these headers completely replace any pool-specific headers.
2026-01-11T11:24:49.9832808Z     
2026-01-11T11:24:49.9832876Z         :param retries:
2026-01-11T11:24:49.9833016Z             Configure the number of retries to allow before raising a
2026-01-11T11:24:49.9833173Z             :class:`~urllib3.exceptions.MaxRetryError` exception.
2026-01-11T11:24:49.9833230Z     
2026-01-11T11:24:49.9833400Z             If ``None`` (default) will retry 3 times, see ``Retry.DEFAULT``. Pass a
2026-01-11T11:24:49.9833572Z             :class:`~urllib3.util.retry.Retry` object for fine-grained control
2026-01-11T11:24:49.9833659Z             over different types of retries.
2026-01-11T11:24:49.9833822Z             Pass an integer number to retry connection errors that many times,
2026-01-11T11:24:49.9833960Z             but no other types of errors. Pass zero to never retry.
2026-01-11T11:24:49.9834120Z     
2026-01-11T11:24:49.9834288Z             If ``False``, then retries are disabled and any exception is raised
2026-01-11T11:24:49.9834460Z             immediately. Also, instead of raising a MaxRetryError on redirects,
2026-01-11T11:24:49.9834562Z             the redirect response will be returned.
2026-01-11T11:24:49.9834619Z     
2026-01-11T11:24:49.9834788Z         :type retries: :class:`~urllib3.util.retry.Retry`, False, or an int.
2026-01-11T11:24:49.9834856Z     
2026-01-11T11:24:49.9834927Z         :param redirect:
2026-01-11T11:24:49.9835083Z             If True, automatically handle redirects (status codes 301, 302,
2026-01-11T11:24:49.9835238Z             303, 307, 308). Each redirect counts as a retry. Disabling retries
2026-01-11T11:24:49.9835319Z             will disable redirect, too.
2026-01-11T11:24:49.9835376Z     
2026-01-11T11:24:49.9835452Z         :param assert_same_host:
2026-01-11T11:24:49.9835603Z             If ``True``, will make sure that the host of the pool requests is
2026-01-11T11:24:49.9835776Z             consistent else will raise HostChangedError. When ``False``, you can
2026-01-11T11:24:49.9835916Z             use the pool on an HTTP proxy and request foreign hosts.
2026-01-11T11:24:49.9835978Z     
2026-01-11T11:24:49.9836043Z         :param timeout:
2026-01-11T11:24:49.9836176Z             If specified, overrides the default timeout for this one
2026-01-11T11:24:49.9836446Z             request. It may be a float (in seconds) or an instance of
2026-01-11T11:24:49.9836534Z             :class:`urllib3.util.Timeout`.
2026-01-11T11:24:49.9836591Z     
2026-01-11T11:24:49.9836666Z         :param pool_timeout:
2026-01-11T11:24:49.9836823Z             If set and the pool is set to block=True, then this method will
2026-01-11T11:24:49.9836987Z             block for ``pool_timeout`` seconds and raise EmptyPoolError if no
2026-01-11T11:24:49.9837108Z             connection is available within the time period.
2026-01-11T11:24:49.9837170Z     
2026-01-11T11:24:49.9837252Z         :param bool preload_content:
2026-01-11T11:24:49.9837394Z             If True, the response's body will be preloaded into memory.
2026-01-11T11:24:49.9837454Z     
2026-01-11T11:24:49.9837532Z         :param bool decode_content:
2026-01-11T11:24:49.9837660Z             If True, will attempt to decode the body based on the
2026-01-11T11:24:49.9837741Z             'content-encoding' header.
2026-01-11T11:24:49.9837917Z     
2026-01-11T11:24:49.9837990Z         :param release_conn:
2026-01-11T11:24:49.9838146Z             If False, then the urlopen call will not release the connection
2026-01-11T11:24:49.9838316Z             back into the pool once a response is received (but will release if
2026-01-11T11:24:49.9838453Z             you read the entire contents of the response such as when
2026-01-11T11:24:49.9838611Z             `preload_content=True`). This is useful if you're not preloading
2026-01-11T11:24:49.9838753Z             the response's content immediately. You will need to call
2026-01-11T11:24:49.9838909Z             ``r.release_conn()`` on the response ``r`` to return the connection
2026-01-11T11:24:49.9839081Z             back into the pool. If None, it takes the value of ``preload_content``
2026-01-11T11:24:49.9839160Z             which defaults to ``True``.
2026-01-11T11:24:49.9839222Z     
2026-01-11T11:24:49.9839292Z         :param bool chunked:
2026-01-11T11:24:49.9839439Z             If True, urllib3 will send the body using chunked transfer
2026-01-11T11:24:49.9839609Z             encoding. Otherwise, urllib3 will send the body using the standard
2026-01-11T11:24:49.9839709Z             content-length form. Defaults to False.
2026-01-11T11:24:49.9839767Z     
2026-01-11T11:24:49.9839842Z         :param int body_pos:
2026-01-11T11:24:49.9839996Z             Position to seek to in file-like body in the event of a retry or
2026-01-11T11:24:49.9840160Z             redirect. Typically this won't need to be set because urllib3 will
2026-01-11T11:24:49.9840254Z             auto-populate the value when needed.
2026-01-11T11:24:49.9840320Z         """
2026-01-11T11:24:49.9840400Z         parsed_url = parse_url(url)
2026-01-11T11:24:49.9840494Z         destination_scheme = parsed_url.scheme
2026-01-11T11:24:49.9840556Z     
2026-01-11T11:24:49.9840629Z         if headers is None:
2026-01-11T11:24:49.9840707Z             headers = self.headers
2026-01-11T11:24:49.9840768Z     
2026-01-11T11:24:49.9840864Z         if not isinstance(retries, Retry):
2026-01-11T11:24:49.9841056Z             retries = Retry.from_int(retries, redirect=redirect, default=self.retries)
2026-01-11T11:24:49.9841114Z     
2026-01-11T11:24:49.9841193Z         if release_conn is None:
2026-01-11T11:24:49.9841276Z             release_conn = preload_content
2026-01-11T11:24:49.9841333Z     
2026-01-11T11:24:49.9841397Z         # Check host
2026-01-11T11:24:49.9841521Z         if assert_same_host and not self.is_same_host(url):
2026-01-11T11:24:49.9841627Z             raise HostChangedError(self, url, retries)
2026-01-11T11:24:49.9841685Z     
2026-01-11T11:24:49.9841835Z         # Ensure that the URL we're connecting to is properly encoded
2026-01-11T11:24:49.9841916Z         if url.startswith("/"):
2026-01-11T11:24:49.9842004Z             url = to_str(_encode_target(url))
2026-01-11T11:24:49.9842069Z         else:
2026-01-11T11:24:49.9842149Z             url = to_str(parsed_url.url)
2026-01-11T11:24:49.9842293Z     
2026-01-11T11:24:49.9842364Z         conn = None
2026-01-11T11:24:49.9842426Z     
2026-01-11T11:24:49.9842547Z         # Track whether `conn` needs to be released before
2026-01-11T11:24:49.9842732Z         # returning/raising/recursing. Update this variable if necessary, and
2026-01-11T11:24:49.9842907Z         # leave `release_conn` constant throughout the function. That way, if
2026-01-11T11:24:49.9843071Z         # the function recurses, the original value of `release_conn` will be
2026-01-11T11:24:49.9843244Z         # passed down into the recursive call, and its value will be respected.
2026-01-11T11:24:49.9843308Z         #
2026-01-11T11:24:49.9843387Z         # See issue #651 [1] for details.
2026-01-11T11:24:49.9843445Z         #
2026-01-11T11:24:49.9843573Z         # [1] <https://github.com/urllib3/urllib3/issues/651>
2026-01-11T11:24:49.9843662Z         release_this_conn = release_conn
2026-01-11T11:24:49.9843719Z     
2026-01-11T11:24:49.9843854Z         http_tunnel_required = connection_requires_http_tunnel(
2026-01-11T11:24:49.9844260Z             self.proxy, self.proxy_config, destination_scheme
2026-01-11T11:24:49.9844329Z         )
2026-01-11T11:24:49.9844387Z     
2026-01-11T11:24:49.9844552Z         # Merge the proxy headers. Only done when not using HTTP CONNECT. We
2026-01-11T11:24:49.9844731Z         # have to copy the headers dict so we can safely change it without those
2026-01-11T11:24:49.9844845Z         # changes being reflected in anyone else's copy.
2026-01-11T11:24:49.9844928Z         if not http_tunnel_required:
2026-01-11T11:24:49.9845071Z             headers = headers.copy()  # type: ignore[attr-defined]
2026-01-11T11:24:49.9845235Z             headers.update(self.proxy_headers)  # type: ignore[union-attr]
2026-01-11T11:24:49.9845292Z     
2026-01-11T11:24:49.9845470Z         # Must keep the exception bound to a separate variable or else Python 3
2026-01-11T11:24:49.9845562Z         # complains about UnboundLocalError.
2026-01-11T11:24:49.9845625Z         err = None
2026-01-11T11:24:49.9845694Z     
2026-01-11T11:24:49.9845849Z         # Keep track of whether we cleanly exited the except block. This
2026-01-11T11:24:49.9845950Z         # ensures we do proper cleanup in finally.
2026-01-11T11:24:49.9846023Z         clean_exit = False
2026-01-11T11:24:49.9846085Z     
2026-01-11T11:24:49.9846224Z         # Rewind body position, if needed. Record current position
2026-01-11T11:24:49.9846349Z         # for future rewinds in the event of a redirect/retry.
2026-01-11T11:24:49.9846461Z         body_pos = set_file_position(body, body_pos)
2026-01-11T11:24:49.9846518Z     
2026-01-11T11:24:49.9846579Z         try:
2026-01-11T11:24:49.9846671Z             # Request a connection from the queue.
2026-01-11T11:24:49.9846779Z             timeout_obj = self._get_timeout(timeout)
2026-01-11T11:24:49.9846885Z             conn = self._get_conn(timeout=pool_timeout)
2026-01-11T11:24:49.9846944Z     
2026-01-11T11:24:49.9847136Z             conn.timeout = timeout_obj.connect_timeout  # type: ignore[assignment]
2026-01-11T11:24:49.9847202Z     
2026-01-11T11:24:49.9847362Z             # Is this a closed/new connection that requires CONNECT tunnelling?
2026-01-11T11:24:49.9847534Z             if self.proxy is not None and http_tunnel_required and conn.is_closed:
2026-01-11T11:24:49.9847603Z                 try:
2026-01-11T11:24:49.9847692Z                     self._prepare_proxy(conn)
2026-01-11T11:24:49.9847824Z                 except (BaseSSLError, OSError, SocketTimeout) as e:
2026-01-11T11:24:49.9847906Z                     self._raise_timeout(
2026-01-11T11:24:49.9848044Z                         err=e, url=self.proxy.url, timeout_value=conn.timeout
2026-01-11T11:24:49.9848107Z                     )
2026-01-11T11:24:49.9848181Z                     raise
2026-01-11T11:24:49.9848238Z     
2026-01-11T11:24:49.9848382Z             # If we're going to release the connection in ``finally:``, then
2026-01-11T11:24:49.9848547Z             # the response doesn't need to know about the connection. Otherwise
2026-01-11T11:24:49.9848831Z             # it will also try to release it and we'll have a double-release
2026-01-11T11:24:49.9848893Z             # mess.
2026-01-11T11:24:49.9849016Z             response_conn = conn if not release_conn else None
2026-01-11T11:24:49.9849082Z     
2026-01-11T11:24:49.9849197Z             # Make the request on the HTTPConnection object
2026-01-11T11:24:49.9849281Z >           response = self._make_request(
2026-01-11T11:24:49.9849352Z                 conn,
2026-01-11T11:24:49.9849415Z                 method,
2026-01-11T11:24:49.9849477Z                 url,
2026-01-11T11:24:49.9849553Z                 timeout=timeout_obj,
2026-01-11T11:24:49.9849624Z                 body=body,
2026-01-11T11:24:49.9849695Z                 headers=headers,
2026-01-11T11:24:49.9849768Z                 chunked=chunked,
2026-01-11T11:24:49.9849842Z                 retries=retries,
2026-01-11T11:24:49.9849930Z                 response_conn=response_conn,
2026-01-11T11:24:49.9850023Z                 preload_content=preload_content,
2026-01-11T11:24:49.9850223Z                 decode_content=decode_content,
2026-01-11T11:24:49.9850300Z                 **response_kw,
2026-01-11T11:24:49.9850359Z             )
2026-01-11T11:24:49.9850364Z 
2026-01-11T11:24:49.9850649Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:787: 
2026-01-11T11:24:49.9850775Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9851103Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:493: in _make_request
2026-01-11T11:24:49.9851168Z     conn.request(
2026-01-11T11:24:49.9851459Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:445: in request
2026-01-11T11:24:49.9851531Z     self.endheaders()
2026-01-11T11:24:49.9851758Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1278: in endheaders
2026-01-11T11:24:49.9851914Z     self._send_output(message_body, encode_chunked=encode_chunked)
2026-01-11T11:24:49.9852158Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1038: in _send_output
2026-01-11T11:24:49.9852223Z     self.send(msg)
2026-01-11T11:24:49.9852424Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:976: in send
2026-01-11T11:24:49.9852494Z     self.connect()
2026-01-11T11:24:49.9852775Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:276: in connect
2026-01-11T11:24:49.9852851Z     self.sock = self._new_conn()
2026-01-11T11:24:49.9852973Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9852979Z 
2026-01-11T11:24:49.9853147Z self = <urllib3.connection.HTTPConnection object at 0x7f29f0550d90>
2026-01-11T11:24:49.9853153Z 
2026-01-11T11:24:49.9853241Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:49.9853401Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:49.9853466Z     
2026-01-11T11:24:49.9853550Z         :return: New socket connection.
2026-01-11T11:24:49.9853614Z         """
2026-01-11T11:24:49.9853677Z         try:
2026-01-11T11:24:49.9853772Z             sock = connection.create_connection(
2026-01-11T11:24:49.9853861Z                 (self._dns_host, self.port),
2026-01-11T11:24:49.9853937Z                 self.timeout,
2026-01-11T11:24:49.9854136Z                 source_address=self.source_address,
2026-01-11T11:24:49.9854235Z                 socket_options=self.socket_options,
2026-01-11T11:24:49.9854298Z             )
2026-01-11T11:24:49.9854384Z         except socket.gaierror as e:
2026-01-11T11:24:49.9854519Z             raise NameResolutionError(self.host, self, e) from e
2026-01-11T11:24:49.9854606Z         except SocketTimeout as e:
2026-01-11T11:24:49.9854695Z             raise ConnectTimeoutError(
2026-01-11T11:24:49.9854757Z                 self,
2026-01-11T11:24:49.9854948Z                 f"Connection to {self.host} timed out. (connect timeout={self.timeout})",
2026-01-11T11:24:49.9855172Z             ) from e
2026-01-11T11:24:49.9855229Z     
2026-01-11T11:24:49.9855304Z         except OSError as e:
2026-01-11T11:24:49.9855395Z >           raise NewConnectionError(
2026-01-11T11:24:49.9855521Z                 self, f"Failed to establish a new connection: {e}"
2026-01-11T11:24:49.9855583Z             ) from e
2026-01-11T11:24:49.9856144Z E           urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f29f0550d90>: Failed to establish a new connection: [Errno 111] Connection refused
2026-01-11T11:24:49.9856155Z 
2026-01-11T11:24:49.9856480Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:213: NewConnectionError
2026-01-11T11:24:49.9856486Z 
2026-01-11T11:24:49.9856654Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:49.9856660Z 
2026-01-11T11:24:49.9856820Z self = <requests.adapters.HTTPAdapter object at 0x7f29f0551120>
2026-01-11T11:24:49.9857045Z request = <PreparedRequest [POST]>, stream = False
2026-01-11T11:24:49.9857232Z timeout = Timeout(connect=10, read=10, total=None), verify = True, cert = None
2026-01-11T11:24:49.9857312Z proxies = OrderedDict()
2026-01-11T11:24:49.9857318Z 
2026-01-11T11:24:49.9857377Z     def send(
2026-01-11T11:24:49.9857582Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:49.9857642Z     ):
2026-01-11T11:24:49.9857787Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:49.9857845Z     
2026-01-11T11:24:49.9858034Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:49.9858195Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:49.9858353Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:49.9858507Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:49.9858609Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:49.9858744Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:49.9858935Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:49.9859105Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:49.9859201Z             must be a path to a CA bundle to use
2026-01-11T11:24:49.9859379Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:49.9859562Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:49.9859648Z         :rtype: requests.Response
2026-01-11T11:24:49.9859706Z         """
2026-01-11T11:24:49.9859762Z     
2026-01-11T11:24:49.9859826Z         try:
2026-01-11T11:24:49.9859947Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:49.9860033Z         except LocationValueError as e:
2026-01-11T11:24:49.9860132Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:49.9860194Z     
2026-01-11T11:24:49.9860312Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:49.9860405Z         url = self.request_url(request, proxies)
2026-01-11T11:24:49.9860479Z         self.add_headers(
2026-01-11T11:24:49.9860542Z             request,
2026-01-11T11:24:49.9860611Z             stream=stream,
2026-01-11T11:24:49.9860687Z             timeout=timeout,
2026-01-11T11:24:49.9860754Z             verify=verify,
2026-01-11T11:24:49.9860818Z             cert=cert,
2026-01-11T11:24:49.9860889Z             proxies=proxies,
2026-01-11T11:24:49.9860952Z         )
2026-01-11T11:24:49.9861009Z     
2026-01-11T11:24:49.9861201Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:49.9861263Z     
2026-01-11T11:24:49.9861346Z         if isinstance(timeout, tuple):
2026-01-11T11:24:49.9861405Z             try:
2026-01-11T11:24:49.9861567Z                 connect, read = timeout
2026-01-11T11:24:49.9861701Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:49.9861778Z             except ValueError:
2026-01-11T11:24:49.9861851Z                 raise ValueError(
2026-01-11T11:24:49.9862037Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:49.9862184Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:49.9862243Z                 )
2026-01-11T11:24:49.9862340Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:49.9862407Z             pass
2026-01-11T11:24:49.9862467Z         else:
2026-01-11T11:24:49.9862597Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:49.9862659Z     
2026-01-11T11:24:49.9862718Z         try:
2026-01-11T11:24:49.9862795Z >           resp = conn.urlopen(
2026-01-11T11:24:49.9862878Z                 method=request.method,
2026-01-11T11:24:49.9863056Z                 url=url,
2026-01-11T11:24:49.9863131Z                 body=request.body,
2026-01-11T11:24:49.9863212Z                 headers=request.headers,
2026-01-11T11:24:49.9863288Z                 redirect=False,
2026-01-11T11:24:49.9863367Z                 assert_same_host=False,
2026-01-11T11:24:49.9863445Z                 preload_content=False,
2026-01-11T11:24:49.9863527Z                 decode_content=False,
2026-01-11T11:24:49.9863607Z                 retries=self.max_retries,
2026-01-11T11:24:49.9863679Z                 timeout=timeout,
2026-01-11T11:24:49.9863749Z                 chunked=chunked,
2026-01-11T11:24:49.9863815Z             )
2026-01-11T11:24:49.9863820Z 
2026-01-11T11:24:49.9864259Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:486: 
2026-01-11T11:24:49.9864393Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9864710Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:841: in urlopen
2026-01-11T11:24:49.9864801Z     retries = retries.increment(
2026-01-11T11:24:49.9864919Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9864925Z 
2026-01-11T11:24:49.9865107Z self = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:49.9865241Z method = 'POST', url = '/api/v2/agent/goal', response = None
2026-01-11T11:24:49.9865733Z error = NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f0550d90>: Failed to establish a new connection: [Errno 111] Connection refused')
2026-01-11T11:24:49.9865939Z _pool = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f05513f0>
2026-01-11T11:24:49.9866048Z _stacktrace = <traceback object at 0x7f29f02db800>
2026-01-11T11:24:49.9866053Z 
2026-01-11T11:24:49.9866118Z     def increment(
2026-01-11T11:24:49.9866181Z         self,
2026-01-11T11:24:49.9866257Z         method: str | None = None,
2026-01-11T11:24:49.9866336Z         url: str | None = None,
2026-01-11T11:24:49.9866439Z         response: BaseHTTPResponse | None = None,
2026-01-11T11:24:49.9866525Z         error: Exception | None = None,
2026-01-11T11:24:49.9866613Z         _pool: ConnectionPool | None = None,
2026-01-11T11:24:49.9866710Z         _stacktrace: TracebackType | None = None,
2026-01-11T11:24:49.9866783Z     ) -> Self:
2026-01-11T11:24:49.9866938Z         """Return a new Retry object with incremented retry counters.
2026-01-11T11:24:49.9866996Z     
2026-01-11T11:24:49.9867169Z         :param response: A response object, or None, if the server did not
2026-01-11T11:24:49.9867245Z             return a response.
2026-01-11T11:24:49.9867403Z         :type response: :class:`~urllib3.response.BaseHTTPResponse`
2026-01-11T11:24:49.9867574Z         :param Exception error: An error encountered during the request, or
2026-01-11T11:24:49.9867696Z             None if the response was received successfully.
2026-01-11T11:24:49.9867754Z     
2026-01-11T11:24:49.9867963Z         :return: A new ``Retry`` object.
2026-01-11T11:24:49.9868032Z         """
2026-01-11T11:24:49.9868118Z         if self.total is False and error:
2026-01-11T11:24:49.9868225Z             # Disabled, indicate to re-raise the error.
2026-01-11T11:24:49.9868339Z             raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:49.9868402Z     
2026-01-11T11:24:49.9868472Z         total = self.total
2026-01-11T11:24:49.9868547Z         if total is not None:
2026-01-11T11:24:49.9868623Z             total -= 1
2026-01-11T11:24:49.9868687Z     
2026-01-11T11:24:49.9868759Z         connect = self.connect
2026-01-11T11:24:49.9868832Z         read = self.read
2026-01-11T11:24:49.9868907Z         redirect = self.redirect
2026-01-11T11:24:49.9868988Z         status_count = self.status
2026-01-11T11:24:49.9869056Z         other = self.other
2026-01-11T11:24:49.9869131Z         cause = "unknown"
2026-01-11T11:24:49.9869197Z         status = None
2026-01-11T11:24:49.9869277Z         redirect_location = None
2026-01-11T11:24:49.9869450Z     
2026-01-11T11:24:49.9869560Z         if error and self._is_connection_error(error):
2026-01-11T11:24:49.9869629Z             # Connect retry?
2026-01-11T11:24:49.9869700Z             if connect is False:
2026-01-11T11:24:49.9869821Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:49.9869899Z             elif connect is not None:
2026-01-11T11:24:49.9869969Z                 connect -= 1
2026-01-11T11:24:49.9870030Z     
2026-01-11T11:24:49.9870127Z         elif error and self._is_read_error(error):
2026-01-11T11:24:49.9870195Z             # Read retry?
2026-01-11T11:24:49.9870385Z             if read is False or method is None or not self._is_method_retryable(method):
2026-01-11T11:24:49.9870503Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:49.9870576Z             elif read is not None:
2026-01-11T11:24:49.9870643Z                 read -= 1
2026-01-11T11:24:49.9870706Z     
2026-01-11T11:24:49.9870779Z         elif error:
2026-01-11T11:24:49.9870846Z             # Other retry?
2026-01-11T11:24:49.9870924Z             if other is not None:
2026-01-11T11:24:49.9870991Z                 other -= 1
2026-01-11T11:24:49.9871048Z     
2026-01-11T11:24:49.9871171Z         elif response and response.get_redirect_location():
2026-01-11T11:24:49.9871247Z             # Redirect retry?
2026-01-11T11:24:49.9871327Z             if redirect is not None:
2026-01-11T11:24:49.9871398Z                 redirect -= 1
2026-01-11T11:24:49.9871483Z             cause = "too many redirects"
2026-01-11T11:24:49.9871647Z             response_redirect_location = response.get_redirect_location()
2026-01-11T11:24:49.9871733Z             if response_redirect_location:
2026-01-11T11:24:49.9871848Z                 redirect_location = response_redirect_location
2026-01-11T11:24:49.9871933Z             status = response.status
2026-01-11T11:24:49.9871989Z     
2026-01-11T11:24:49.9872049Z         else:
2026-01-11T11:24:49.9872189Z             # Incrementing because of a server error like a 500 in
2026-01-11T11:24:49.9872357Z             # status_forcelist and the given method is in the allowed_methods
2026-01-11T11:24:49.9872454Z             cause = ResponseError.GENERIC_ERROR
2026-01-11T11:24:49.9872549Z             if response and response.status:
2026-01-11T11:24:49.9872631Z                 if status_count is not None:
2026-01-11T11:24:49.9872707Z                     status_count -= 1
2026-01-11T11:24:49.9872909Z                 cause = ResponseError.SPECIFIC_ERROR.format(status_code=response.status)
2026-01-11T11:24:49.9872992Z                 status = response.status
2026-01-11T11:24:49.9873049Z     
2026-01-11T11:24:49.9873124Z         history = self.history + (
2026-01-11T11:24:49.9873293Z             RequestHistory(method, url, error, status, redirect_location),
2026-01-11T11:24:49.9873356Z         )
2026-01-11T11:24:49.9873412Z     
2026-01-11T11:24:49.9873483Z         new_retry = self.new(
2026-01-11T11:24:49.9873643Z             total=total,
2026-01-11T11:24:49.9873717Z             connect=connect,
2026-01-11T11:24:49.9873784Z             read=read,
2026-01-11T11:24:49.9873861Z             redirect=redirect,
2026-01-11T11:24:49.9873934Z             status=status_count,
2026-01-11T11:24:49.9874000Z             other=other,
2026-01-11T11:24:49.9874171Z             history=history,
2026-01-11T11:24:49.9874235Z         )
2026-01-11T11:24:49.9874293Z     
2026-01-11T11:24:49.9874371Z         if new_retry.is_exhausted():
2026-01-11T11:24:49.9874473Z             reason = error or ResponseError(cause)
2026-01-11T11:24:49.9874679Z >           raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
2026-01-11T11:24:49.9875675Z E           urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/goal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f0550d90>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:49.9875801Z 
2026-01-11T11:24:49.9876115Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/retry.py:519: MaxRetryError
2026-01-11T11:24:49.9876122Z 
2026-01-11T11:24:49.9876287Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:49.9876292Z 
2026-01-11T11:24:49.9876452Z self = <test_phd_pipeline.TestPhDPipeline object at 0x7f2aec5b4460>
2026-01-11T11:24:49.9876461Z 
2026-01-11T11:24:49.9876546Z     def test_api_goal_endpoint(self):
2026-01-11T11:24:49.9876641Z         """Test Agent Zero goal API endpoint"""
2026-01-11T11:24:49.9876750Z         print("\n=== Testing Goal API Endpoint ===")
2026-01-11T11:24:49.9876814Z     
2026-01-11T11:24:49.9876881Z         # Valid request
2026-01-11T11:24:49.9876960Z >       response = requests.post(
2026-01-11T11:24:49.9877056Z             f"{self.BASE_URL}/api/v2/agent/goal",
2026-01-11T11:24:49.9877117Z             json={
2026-01-11T11:24:49.9877189Z                 "goal": "Test goal",
2026-01-11T11:24:49.9877269Z                 "stage": "early"
2026-01-11T11:24:49.9877332Z             },
2026-01-11T11:24:49.9877398Z             timeout=10
2026-01-11T11:24:49.9877455Z         )
2026-01-11T11:24:49.9877460Z 
2026-01-11T11:24:49.9877562Z tests/integration/test_phd_pipeline.py:97: 
2026-01-11T11:24:49.9877684Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9877948Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:115: in post
2026-01-11T11:24:49.9878094Z     return request("post", url, data=data, json=json, **kwargs)
2026-01-11T11:24:49.9878361Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:59: in request
2026-01-11T11:24:49.9878496Z     return session.request(method=method, url=url, **kwargs)
2026-01-11T11:24:49.9878779Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:589: in request
2026-01-11T11:24:49.9878871Z     resp = self.send(prep, **send_kwargs)
2026-01-11T11:24:49.9879143Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:703: in send
2026-01-11T11:24:49.9879226Z     r = adapter.send(request, **kwargs)
2026-01-11T11:24:49.9879349Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9879354Z 
2026-01-11T11:24:49.9879507Z self = <requests.adapters.HTTPAdapter object at 0x7f29f0551120>
2026-01-11T11:24:49.9879617Z request = <PreparedRequest [POST]>, stream = False
2026-01-11T11:24:49.9879806Z timeout = Timeout(connect=10, read=10, total=None), verify = True, cert = None
2026-01-11T11:24:49.9879882Z proxies = OrderedDict()
2026-01-11T11:24:49.9879887Z 
2026-01-11T11:24:49.9879948Z     def send(
2026-01-11T11:24:49.9880156Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:49.9880216Z     ):
2026-01-11T11:24:49.9880357Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:49.9880540Z     
2026-01-11T11:24:49.9880732Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:49.9880897Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:49.9881058Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:49.9881218Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:49.9881307Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:49.9881436Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:49.9881633Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:49.9881804Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:49.9881896Z             must be a path to a CA bundle to use
2026-01-11T11:24:49.9882080Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:49.9882348Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:49.9882429Z         :rtype: requests.Response
2026-01-11T11:24:49.9882493Z         """
2026-01-11T11:24:49.9882550Z     
2026-01-11T11:24:49.9882609Z         try:
2026-01-11T11:24:49.9882728Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:49.9882826Z         except LocationValueError as e:
2026-01-11T11:24:49.9882917Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:49.9882974Z     
2026-01-11T11:24:49.9883096Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:49.9883189Z         url = self.request_url(request, proxies)
2026-01-11T11:24:49.9883260Z         self.add_headers(
2026-01-11T11:24:49.9883324Z             request,
2026-01-11T11:24:49.9883399Z             stream=stream,
2026-01-11T11:24:49.9883469Z             timeout=timeout,
2026-01-11T11:24:49.9883535Z             verify=verify,
2026-01-11T11:24:49.9883613Z             cert=cert,
2026-01-11T11:24:49.9883684Z             proxies=proxies,
2026-01-11T11:24:49.9883741Z         )
2026-01-11T11:24:49.9883798Z     
2026-01-11T11:24:49.9883995Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:49.9884214Z     
2026-01-11T11:24:49.9884337Z         if isinstance(timeout, tuple):
2026-01-11T11:24:49.9884404Z             try:
2026-01-11T11:24:49.9884482Z                 connect, read = timeout
2026-01-11T11:24:49.9884609Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:49.9884684Z             except ValueError:
2026-01-11T11:24:49.9884764Z                 raise ValueError(
2026-01-11T11:24:49.9884946Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:49.9885096Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:49.9885161Z                 )
2026-01-11T11:24:49.9885266Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:49.9885329Z             pass
2026-01-11T11:24:49.9885394Z         else:
2026-01-11T11:24:49.9885525Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:49.9885582Z     
2026-01-11T11:24:49.9885641Z         try:
2026-01-11T11:24:49.9885720Z             resp = conn.urlopen(
2026-01-11T11:24:49.9885800Z                 method=request.method,
2026-01-11T11:24:49.9885866Z                 url=url,
2026-01-11T11:24:49.9885948Z                 body=request.body,
2026-01-11T11:24:49.9886029Z                 headers=request.headers,
2026-01-11T11:24:49.9886100Z                 redirect=False,
2026-01-11T11:24:49.9886175Z                 assert_same_host=False,
2026-01-11T11:24:49.9886256Z                 preload_content=False,
2026-01-11T11:24:49.9886334Z                 decode_content=False,
2026-01-11T11:24:49.9886413Z                 retries=self.max_retries,
2026-01-11T11:24:49.9886619Z                 timeout=timeout,
2026-01-11T11:24:49.9886692Z                 chunked=chunked,
2026-01-11T11:24:49.9886753Z             )
2026-01-11T11:24:49.9886815Z     
2026-01-11T11:24:49.9886911Z         except (ProtocolError, OSError) as err:
2026-01-11T11:24:49.9887022Z             raise ConnectionError(err, request=request)
2026-01-11T11:24:49.9887079Z     
2026-01-11T11:24:49.9887164Z         except MaxRetryError as e:
2026-01-11T11:24:49.9887279Z             if isinstance(e.reason, ConnectTimeoutError):
2026-01-11T11:24:49.9887372Z                 # TODO: Remove this in 3.0.0: see #2811
2026-01-11T11:24:49.9887502Z                 if not isinstance(e.reason, NewConnectionError):
2026-01-11T11:24:49.9887612Z                     raise ConnectTimeout(e, request=request)
2026-01-11T11:24:49.9887669Z     
2026-01-11T11:24:49.9887769Z             if isinstance(e.reason, ResponseError):
2026-01-11T11:24:49.9887870Z                 raise RetryError(e, request=request)
2026-01-11T11:24:49.9887927Z     
2026-01-11T11:24:49.9888134Z             if isinstance(e.reason, _ProxyError):
2026-01-11T11:24:49.9888235Z                 raise ProxyError(e, request=request)
2026-01-11T11:24:49.9888292Z     
2026-01-11T11:24:49.9888380Z             if isinstance(e.reason, _SSLError):
2026-01-11T11:24:49.9888496Z                 # This branch is for urllib3 v1.22 and later.
2026-01-11T11:24:49.9888586Z                 raise SSLError(e, request=request)
2026-01-11T11:24:49.9888643Z     
2026-01-11T11:24:49.9888747Z >           raise ConnectionError(e, request=request)
2026-01-11T11:24:49.9889751Z E           requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/goal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f0550d90>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:49.9889758Z 
2026-01-11T11:24:49.9890065Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:519: ConnectionError
2026-01-11T11:24:49.9890244Z ----------------------------- Captured stdout call -----------------------------
2026-01-11T11:24:49.9890249Z 
2026-01-11T11:24:49.9890330Z === Testing Goal API Endpoint ===
2026-01-11T11:24:49.9890510Z __________________ TestPhDPipeline.test_api_thinking_endpoint __________________
2026-01-11T11:24:49.9890516Z 
2026-01-11T11:24:49.9890685Z self = <urllib3.connection.HTTPConnection object at 0x7f29f0677250>
2026-01-11T11:24:49.9890690Z 
2026-01-11T11:24:49.9890776Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:49.9890936Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:49.9890993Z     
2026-01-11T11:24:49.9891079Z         :return: New socket connection.
2026-01-11T11:24:49.9891138Z         """
2026-01-11T11:24:49.9891198Z         try:
2026-01-11T11:24:49.9891298Z >           sock = connection.create_connection(
2026-01-11T11:24:49.9891383Z                 (self._dns_host, self.port),
2026-01-11T11:24:49.9891460Z                 self.timeout,
2026-01-11T11:24:49.9891556Z                 source_address=self.source_address,
2026-01-11T11:24:49.9891654Z                 socket_options=self.socket_options,
2026-01-11T11:24:49.9891713Z             )
2026-01-11T11:24:49.9891718Z 
2026-01-11T11:24:49.9891981Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:198: 
2026-01-11T11:24:49.9892104Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9892450Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:85: in create_connection
2026-01-11T11:24:49.9892511Z     raise err
2026-01-11T11:24:49.9892631Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9892636Z 
2026-01-11T11:24:49.9892781Z address = ('localhost', 3000), timeout = 5, source_address = None
2026-01-11T11:24:49.9892857Z socket_options = [(6, 1, 1)]
2026-01-11T11:24:49.9892948Z 
2026-01-11T11:24:49.9893028Z     def create_connection(
2026-01-11T11:24:49.9893106Z         address: tuple[str, int],
2026-01-11T11:24:49.9893204Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:49.9893317Z         source_address: tuple[str, int] | None = None,
2026-01-11T11:24:49.9893439Z         socket_options: _TYPE_SOCKET_OPTIONS | None = None,
2026-01-11T11:24:49.9893510Z     ) -> socket.socket:
2026-01-11T11:24:49.9893631Z         """Connect to *address* and return the socket object.
2026-01-11T11:24:49.9893694Z     
2026-01-11T11:24:49.9893859Z         Convenience function.  Connect to *address* (a 2-tuple ``(host,
2026-01-11T11:24:49.9894002Z         port)``) and return the socket object.  Passing the optional
2026-01-11T11:24:49.9894265Z         *timeout* parameter will set the timeout on the socket instance
2026-01-11T11:24:49.9894421Z         before attempting to connect.  If no *timeout* is supplied, the
2026-01-11T11:24:49.9894622Z         global default timeout setting returned by :func:`socket.getdefaulttimeout`
2026-01-11T11:24:49.9894915Z         is used.  If *source_address* is set it must be a tuple of (host, port)
2026-01-11T11:24:49.9895087Z         for the socket to bind as a source address before making the connection.
2026-01-11T11:24:49.9895212Z         An host of '' or port 0 tells the OS to use the default.
2026-01-11T11:24:49.9895273Z         """
2026-01-11T11:24:49.9895332Z     
2026-01-11T11:24:49.9895405Z         host, port = address
2026-01-11T11:24:49.9895482Z         if host.startswith("["):
2026-01-11T11:24:49.9895566Z             host = host.strip("[]")
2026-01-11T11:24:49.9895629Z         err = None
2026-01-11T11:24:49.9895686Z     
2026-01-11T11:24:49.9895886Z         # Using the value from allowed_gai_family() in the context of getaddrinfo lets
2026-01-11T11:24:49.9896063Z         # us select whether to work with IPv4 DNS records, IPv6 records, or both.
2026-01-11T11:24:49.9896234Z         # The original create_connection function always returns all records.
2026-01-11T11:24:49.9896325Z         family = allowed_gai_family()
2026-01-11T11:24:49.9896388Z     
2026-01-11T11:24:49.9896447Z         try:
2026-01-11T11:24:49.9896523Z             host.encode("idna")
2026-01-11T11:24:49.9896601Z         except UnicodeError:
2026-01-11T11:24:49.9896794Z             raise LocationParseError(f"'{host}', label empty or too long") from None
2026-01-11T11:24:49.9896851Z     
2026-01-11T11:24:49.9897025Z         for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
2026-01-11T11:24:49.9897133Z             af, socktype, proto, canonname, sa = res
2026-01-11T11:24:49.9897199Z             sock = None
2026-01-11T11:24:49.9897259Z             try:
2026-01-11T11:24:49.9897374Z                 sock = socket.socket(af, socktype, proto)
2026-01-11T11:24:49.9897431Z     
2026-01-11T11:24:49.9897576Z                 # If provided, set socket level options before connecting.
2026-01-11T11:24:49.9897685Z                 _set_socket_options(sock, socket_options)
2026-01-11T11:24:49.9897751Z     
2026-01-11T11:24:49.9897843Z                 if timeout is not _DEFAULT_TIMEOUT:
2026-01-11T11:24:49.9897928Z                     sock.settimeout(timeout)
2026-01-11T11:24:49.9898007Z                 if source_address:
2026-01-11T11:24:49.9898091Z                     sock.bind(source_address)
2026-01-11T11:24:49.9898163Z >               sock.connect(sa)
2026-01-11T11:24:49.9898314Z E               ConnectionRefusedError: [Errno 111] Connection refused
2026-01-11T11:24:49.9898320Z 
2026-01-11T11:24:49.9898678Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:73: ConnectionRefusedError
2026-01-11T11:24:49.9898684Z 
2026-01-11T11:24:49.9898850Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:49.9898855Z 
2026-01-11T11:24:49.9899063Z self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f06776d0>
2026-01-11T11:24:49.9899190Z method = 'GET', url = '/api/v2/agent/thinking', body = None
2026-01-11T11:24:49.9899670Z headers = {'User-Agent': 'python-requests/2.31.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': '*/*', 'Connection': 'keep-alive'}
2026-01-11T11:24:49.9899865Z retries = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:49.9899956Z redirect = False, assert_same_host = False
2026-01-11T11:24:49.9900118Z timeout = Timeout(connect=5, read=5, total=None), pool_timeout = None
2026-01-11T11:24:49.9900312Z release_conn = False, chunked = False, body_pos = None, preload_content = False
2026-01-11T11:24:49.9900401Z decode_content = False, response_kw = {}
2026-01-11T11:24:49.9900715Z parsed_url = Url(scheme=None, auth=None, host=None, port=None, path='/api/v2/agent/thinking', query=None, fragment=None)
2026-01-11T11:24:49.9900873Z destination_scheme = None, conn = None, release_this_conn = True
2026-01-11T11:24:49.9901013Z http_tunnel_required = False, err = None, clean_exit = False
2026-01-11T11:24:49.9901019Z 
2026-01-11T11:24:49.9901113Z     def urlopen(  # type: ignore[override]
2026-01-11T11:24:49.9901248Z         self,
2026-01-11T11:24:49.9901319Z         method: str,
2026-01-11T11:24:49.9901380Z         url: str,
2026-01-11T11:24:49.9901461Z         body: _TYPE_BODY | None = None,
2026-01-11T11:24:49.9901582Z         headers: typing.Mapping[str, str] | None = None,
2026-01-11T11:24:49.9901677Z         retries: Retry | bool | int | None = None,
2026-01-11T11:24:49.9901752Z         redirect: bool = True,
2026-01-11T11:24:49.9901836Z         assert_same_host: bool = True,
2026-01-11T11:24:49.9901933Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:49.9902013Z         pool_timeout: int | None = None,
2026-01-11T11:24:49.9902093Z         release_conn: bool | None = None,
2026-01-11T11:24:49.9902169Z         chunked: bool = False,
2026-01-11T11:24:49.9902272Z         body_pos: _TYPE_BODY_POSITION | None = None,
2026-01-11T11:24:49.9902353Z         preload_content: bool = True,
2026-01-11T11:24:49.9902435Z         decode_content: bool = True,
2026-01-11T11:24:49.9902523Z         **response_kw: typing.Any,
2026-01-11T11:24:49.9902600Z     ) -> BaseHTTPResponse:
2026-01-11T11:24:49.9902659Z         """
2026-01-11T11:24:49.9902843Z         Get a connection from the pool and perform an HTTP request. This is the
2026-01-11T11:24:49.9903014Z         lowest level call for making a request, so you'll need to specify all
2026-01-11T11:24:49.9903083Z         the raw details.
2026-01-11T11:24:49.9903145Z     
2026-01-11T11:24:49.9903215Z         .. note::
2026-01-11T11:24:49.9903272Z     
2026-01-11T11:24:49.9903430Z            More commonly, it's appropriate to use a convenience method
2026-01-11T11:24:49.9903506Z            such as :meth:`request`.
2026-01-11T11:24:49.9903563Z     
2026-01-11T11:24:49.9903625Z         .. note::
2026-01-11T11:24:49.9903686Z     
2026-01-11T11:24:49.9903798Z            `release_conn` will only behave as expected if
2026-01-11T11:24:49.9903912Z            `preload_content=False` because we want to make
2026-01-11T11:24:49.9904275Z            `preload_content=False` the default behaviour someday soon without
2026-01-11T11:24:49.9904373Z            breaking backwards compatibility.
2026-01-11T11:24:49.9904431Z     
2026-01-11T11:24:49.9904500Z         :param method:
2026-01-11T11:24:49.9904628Z             HTTP request method (such as GET, POST, PUT, etc.)
2026-01-11T11:24:49.9904685Z     
2026-01-11T11:24:49.9904749Z         :param url:
2026-01-11T11:24:49.9904842Z             The URL to perform the request on.
2026-01-11T11:24:49.9904899Z     
2026-01-11T11:24:49.9904965Z         :param body:
2026-01-11T11:24:49.9905132Z             Data to send in the request body, either :class:`str`, :class:`bytes`,
2026-01-11T11:24:49.9905292Z             an iterable of :class:`str`/:class:`bytes`, or a file-like object.
2026-01-11T11:24:49.9905350Z     
2026-01-11T11:24:49.9905418Z         :param headers:
2026-01-11T11:24:49.9905567Z             Dictionary of custom headers to send, such as User-Agent,
2026-01-11T11:24:49.9905888Z             If-None-Match, etc. If None, pool headers are used. If provided,
2026-01-11T11:24:49.9906046Z             these headers completely replace any pool-specific headers.
2026-01-11T11:24:49.9906107Z     
2026-01-11T11:24:49.9906177Z         :param retries:
2026-01-11T11:24:49.9906320Z             Configure the number of retries to allow before raising a
2026-01-11T11:24:49.9906459Z             :class:`~urllib3.exceptions.MaxRetryError` exception.
2026-01-11T11:24:49.9906519Z     
2026-01-11T11:24:49.9906689Z             If ``None`` (default) will retry 3 times, see ``Retry.DEFAULT``. Pass a
2026-01-11T11:24:49.9906860Z             :class:`~urllib3.util.retry.Retry` object for fine-grained control
2026-01-11T11:24:49.9906955Z             over different types of retries.
2026-01-11T11:24:49.9907124Z             Pass an integer number to retry connection errors that many times,
2026-01-11T11:24:49.9907258Z             but no other types of errors. Pass zero to never retry.
2026-01-11T11:24:49.9907325Z     
2026-01-11T11:24:49.9907592Z             If ``False``, then retries are disabled and any exception is raised
2026-01-11T11:24:49.9907764Z             immediately. Also, instead of raising a MaxRetryError on redirects,
2026-01-11T11:24:49.9907867Z             the redirect response will be returned.
2026-01-11T11:24:49.9907923Z     
2026-01-11T11:24:49.9908086Z         :type retries: :class:`~urllib3.util.retry.Retry`, False, or an int.
2026-01-11T11:24:49.9908143Z     
2026-01-11T11:24:49.9908217Z         :param redirect:
2026-01-11T11:24:49.9908373Z             If True, automatically handle redirects (status codes 301, 302,
2026-01-11T11:24:49.9908521Z             303, 307, 308). Each redirect counts as a retry. Disabling retries
2026-01-11T11:24:49.9908606Z             will disable redirect, too.
2026-01-11T11:24:49.9908663Z     
2026-01-11T11:24:49.9908739Z         :param assert_same_host:
2026-01-11T11:24:49.9908884Z             If ``True``, will make sure that the host of the pool requests is
2026-01-11T11:24:49.9909070Z             consistent else will raise HostChangedError. When ``False``, you can
2026-01-11T11:24:49.9909208Z             use the pool on an HTTP proxy and request foreign hosts.
2026-01-11T11:24:49.9909265Z     
2026-01-11T11:24:49.9909338Z         :param timeout:
2026-01-11T11:24:49.9909471Z             If specified, overrides the default timeout for this one
2026-01-11T11:24:49.9909609Z             request. It may be a float (in seconds) or an instance of
2026-01-11T11:24:49.9909707Z             :class:`urllib3.util.Timeout`.
2026-01-11T11:24:49.9914769Z     
2026-01-11T11:24:49.9914895Z         :param pool_timeout:
2026-01-11T11:24:49.9915076Z             If set and the pool is set to block=True, then this method will
2026-01-11T11:24:49.9915260Z             block for ``pool_timeout`` seconds and raise EmptyPoolError if no
2026-01-11T11:24:49.9915387Z             connection is available within the time period.
2026-01-11T11:24:49.9915446Z     
2026-01-11T11:24:49.9915535Z         :param bool preload_content:
2026-01-11T11:24:49.9915696Z             If True, the response's body will be preloaded into memory.
2026-01-11T11:24:49.9915754Z     
2026-01-11T11:24:49.9915835Z         :param bool decode_content:
2026-01-11T11:24:49.9915967Z             If True, will attempt to decode the body based on the
2026-01-11T11:24:49.9916054Z             'content-encoding' header.
2026-01-11T11:24:49.9916110Z     
2026-01-11T11:24:49.9916188Z         :param release_conn:
2026-01-11T11:24:49.9916346Z             If False, then the urlopen call will not release the connection
2026-01-11T11:24:49.9916512Z             back into the pool once a response is received (but will release if
2026-01-11T11:24:49.9916653Z             you read the entire contents of the response such as when
2026-01-11T11:24:49.9916812Z             `preload_content=True`). This is useful if you're not preloading
2026-01-11T11:24:49.9916954Z             the response's content immediately. You will need to call
2026-01-11T11:24:49.9917277Z             ``r.release_conn()`` on the response ``r`` to return the connection
2026-01-11T11:24:49.9917457Z             back into the pool. If None, it takes the value of ``preload_content``
2026-01-11T11:24:49.9917539Z             which defaults to ``True``.
2026-01-11T11:24:49.9917597Z     
2026-01-11T11:24:49.9917674Z         :param bool chunked:
2026-01-11T11:24:49.9917812Z             If True, urllib3 will send the body using chunked transfer
2026-01-11T11:24:49.9917980Z             encoding. Otherwise, urllib3 will send the body using the standard
2026-01-11T11:24:49.9918085Z             content-length form. Defaults to False.
2026-01-11T11:24:49.9918141Z     
2026-01-11T11:24:49.9918212Z         :param int body_pos:
2026-01-11T11:24:49.9918366Z             Position to seek to in file-like body in the event of a retry or
2026-01-11T11:24:49.9918537Z             redirect. Typically this won't need to be set because urllib3 will
2026-01-11T11:24:49.9918636Z             auto-populate the value when needed.
2026-01-11T11:24:49.9918808Z         """
2026-01-11T11:24:49.9918892Z         parsed_url = parse_url(url)
2026-01-11T11:24:49.9918986Z         destination_scheme = parsed_url.scheme
2026-01-11T11:24:49.9919042Z     
2026-01-11T11:24:49.9919114Z         if headers is None:
2026-01-11T11:24:49.9919189Z             headers = self.headers
2026-01-11T11:24:49.9919246Z     
2026-01-11T11:24:49.9919330Z         if not isinstance(retries, Retry):
2026-01-11T11:24:49.9919530Z             retries = Retry.from_int(retries, redirect=redirect, default=self.retries)
2026-01-11T11:24:49.9919588Z     
2026-01-11T11:24:49.9919662Z         if release_conn is None:
2026-01-11T11:24:49.9919752Z             release_conn = preload_content
2026-01-11T11:24:49.9919808Z     
2026-01-11T11:24:49.9919872Z         # Check host
2026-01-11T11:24:49.9919991Z         if assert_same_host and not self.is_same_host(url):
2026-01-11T11:24:49.9920101Z             raise HostChangedError(self, url, retries)
2026-01-11T11:24:49.9920163Z     
2026-01-11T11:24:49.9920317Z         # Ensure that the URL we're connecting to is properly encoded
2026-01-11T11:24:49.9920400Z         if url.startswith("/"):
2026-01-11T11:24:49.9920486Z             url = to_str(_encode_target(url))
2026-01-11T11:24:49.9920547Z         else:
2026-01-11T11:24:49.9920630Z             url = to_str(parsed_url.url)
2026-01-11T11:24:49.9920687Z     
2026-01-11T11:24:49.9920749Z         conn = None
2026-01-11T11:24:49.9920805Z     
2026-01-11T11:24:49.9920923Z         # Track whether `conn` needs to be released before
2026-01-11T11:24:49.9921103Z         # returning/raising/recursing. Update this variable if necessary, and
2026-01-11T11:24:49.9921271Z         # leave `release_conn` constant throughout the function. That way, if
2026-01-11T11:24:49.9921436Z         # the function recurses, the original value of `release_conn` will be
2026-01-11T11:24:49.9921609Z         # passed down into the recursive call, and its value will be respected.
2026-01-11T11:24:49.9921667Z         #
2026-01-11T11:24:49.9921757Z         # See issue #651 [1] for details.
2026-01-11T11:24:49.9921817Z         #
2026-01-11T11:24:49.9921947Z         # [1] <https://github.com/urllib3/urllib3/issues/651>
2026-01-11T11:24:49.9922028Z         release_this_conn = release_conn
2026-01-11T11:24:49.9922089Z     
2026-01-11T11:24:49.9922225Z         http_tunnel_required = connection_requires_http_tunnel(
2026-01-11T11:24:49.9922348Z             self.proxy, self.proxy_config, destination_scheme
2026-01-11T11:24:49.9922409Z         )
2026-01-11T11:24:49.9922467Z     
2026-01-11T11:24:49.9922628Z         # Merge the proxy headers. Only done when not using HTTP CONNECT. We
2026-01-11T11:24:49.9922796Z         # have to copy the headers dict so we can safely change it without those
2026-01-11T11:24:49.9922914Z         # changes being reflected in anyone else's copy.
2026-01-11T11:24:49.9922994Z         if not http_tunnel_required:
2026-01-11T11:24:49.9923130Z             headers = headers.copy()  # type: ignore[attr-defined]
2026-01-11T11:24:49.9923388Z             headers.update(self.proxy_headers)  # type: ignore[union-attr]
2026-01-11T11:24:49.9923446Z     
2026-01-11T11:24:49.9923621Z         # Must keep the exception bound to a separate variable or else Python 3
2026-01-11T11:24:49.9923718Z         # complains about UnboundLocalError.
2026-01-11T11:24:49.9923781Z         err = None
2026-01-11T11:24:49.9923838Z     
2026-01-11T11:24:49.9923996Z         # Keep track of whether we cleanly exited the except block. This
2026-01-11T11:24:49.9924297Z         # ensures we do proper cleanup in finally.
2026-01-11T11:24:49.9924385Z         clean_exit = False
2026-01-11T11:24:49.9924444Z     
2026-01-11T11:24:49.9924592Z         # Rewind body position, if needed. Record current position
2026-01-11T11:24:49.9924724Z         # for future rewinds in the event of a redirect/retry.
2026-01-11T11:24:49.9924834Z         body_pos = set_file_position(body, body_pos)
2026-01-11T11:24:49.9924894Z     
2026-01-11T11:24:49.9924954Z         try:
2026-01-11T11:24:49.9925179Z             # Request a connection from the queue.
2026-01-11T11:24:49.9925275Z             timeout_obj = self._get_timeout(timeout)
2026-01-11T11:24:49.9925385Z             conn = self._get_conn(timeout=pool_timeout)
2026-01-11T11:24:49.9925442Z     
2026-01-11T11:24:49.9925625Z             conn.timeout = timeout_obj.connect_timeout  # type: ignore[assignment]
2026-01-11T11:24:49.9925685Z     
2026-01-11T11:24:49.9925851Z             # Is this a closed/new connection that requires CONNECT tunnelling?
2026-01-11T11:24:49.9926020Z             if self.proxy is not None and http_tunnel_required and conn.is_closed:
2026-01-11T11:24:49.9926083Z                 try:
2026-01-11T11:24:49.9926182Z                     self._prepare_proxy(conn)
2026-01-11T11:24:49.9926315Z                 except (BaseSSLError, OSError, SocketTimeout) as e:
2026-01-11T11:24:49.9926392Z                     self._raise_timeout(
2026-01-11T11:24:49.9926533Z                         err=e, url=self.proxy.url, timeout_value=conn.timeout
2026-01-11T11:24:49.9926606Z                     )
2026-01-11T11:24:49.9926671Z                     raise
2026-01-11T11:24:49.9926731Z     
2026-01-11T11:24:49.9926874Z             # If we're going to release the connection in ``finally:``, then
2026-01-11T11:24:49.9927038Z             # the response doesn't need to know about the connection. Otherwise
2026-01-11T11:24:49.9927183Z             # it will also try to release it and we'll have a double-release
2026-01-11T11:24:49.9927247Z             # mess.
2026-01-11T11:24:49.9927366Z             response_conn = conn if not release_conn else None
2026-01-11T11:24:49.9927421Z     
2026-01-11T11:24:49.9927538Z             # Make the request on the HTTPConnection object
2026-01-11T11:24:49.9927620Z >           response = self._make_request(
2026-01-11T11:24:49.9927681Z                 conn,
2026-01-11T11:24:49.9927747Z                 method,
2026-01-11T11:24:49.9927808Z                 url,
2026-01-11T11:24:49.9927882Z                 timeout=timeout_obj,
2026-01-11T11:24:49.9927956Z                 body=body,
2026-01-11T11:24:49.9928030Z                 headers=headers,
2026-01-11T11:24:49.9928100Z                 chunked=chunked,
2026-01-11T11:24:49.9928172Z                 retries=retries,
2026-01-11T11:24:49.9928267Z                 response_conn=response_conn,
2026-01-11T11:24:49.9928360Z                 preload_content=preload_content,
2026-01-11T11:24:49.9928446Z                 decode_content=decode_content,
2026-01-11T11:24:49.9928523Z                 **response_kw,
2026-01-11T11:24:49.9928583Z             )
2026-01-11T11:24:49.9928589Z 
2026-01-11T11:24:49.9928876Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:787: 
2026-01-11T11:24:49.9929008Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9929339Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:493: in _make_request
2026-01-11T11:24:49.9929522Z     conn.request(
2026-01-11T11:24:49.9929817Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:445: in request
2026-01-11T11:24:49.9929890Z     self.endheaders()
2026-01-11T11:24:49.9930118Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1278: in endheaders
2026-01-11T11:24:49.9930271Z     self._send_output(message_body, encode_chunked=encode_chunked)
2026-01-11T11:24:49.9930507Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1038: in _send_output
2026-01-11T11:24:49.9930573Z     self.send(msg)
2026-01-11T11:24:49.9930773Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:976: in send
2026-01-11T11:24:49.9930843Z     self.connect()
2026-01-11T11:24:49.9931124Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:276: in connect
2026-01-11T11:24:49.9931202Z     self.sock = self._new_conn()
2026-01-11T11:24:49.9931327Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9931412Z 
2026-01-11T11:24:49.9931583Z self = <urllib3.connection.HTTPConnection object at 0x7f29f0677250>
2026-01-11T11:24:49.9931590Z 
2026-01-11T11:24:49.9931679Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:49.9931841Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:49.9931900Z     
2026-01-11T11:24:49.9931983Z         :return: New socket connection.
2026-01-11T11:24:49.9932044Z         """
2026-01-11T11:24:49.9932111Z         try:
2026-01-11T11:24:49.9932209Z             sock = connection.create_connection(
2026-01-11T11:24:49.9932294Z                 (self._dns_host, self.port),
2026-01-11T11:24:49.9932372Z                 self.timeout,
2026-01-11T11:24:49.9932468Z                 source_address=self.source_address,
2026-01-11T11:24:49.9932561Z                 socket_options=self.socket_options,
2026-01-11T11:24:49.9932624Z             )
2026-01-11T11:24:49.9932706Z         except socket.gaierror as e:
2026-01-11T11:24:49.9932849Z             raise NameResolutionError(self.host, self, e) from e
2026-01-11T11:24:49.9932930Z         except SocketTimeout as e:
2026-01-11T11:24:49.9933020Z             raise ConnectTimeoutError(
2026-01-11T11:24:49.9933085Z                 self,
2026-01-11T11:24:49.9933277Z                 f"Connection to {self.host} timed out. (connect timeout={self.timeout})",
2026-01-11T11:24:49.9933347Z             ) from e
2026-01-11T11:24:49.9933405Z     
2026-01-11T11:24:49.9933479Z         except OSError as e:
2026-01-11T11:24:49.9933562Z >           raise NewConnectionError(
2026-01-11T11:24:49.9933691Z                 self, f"Failed to establish a new connection: {e}"
2026-01-11T11:24:49.9933753Z             ) from e
2026-01-11T11:24:49.9934417Z E           urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f29f0677250>: Failed to establish a new connection: [Errno 111] Connection refused
2026-01-11T11:24:49.9934426Z 
2026-01-11T11:24:49.9934760Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:213: NewConnectionError
2026-01-11T11:24:49.9934766Z 
2026-01-11T11:24:49.9934935Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:49.9934940Z 
2026-01-11T11:24:49.9935095Z self = <requests.adapters.HTTPAdapter object at 0x7f29f0677880>
2026-01-11T11:24:49.9935207Z request = <PreparedRequest [GET]>, stream = True
2026-01-11T11:24:49.9935389Z timeout = Timeout(connect=5, read=5, total=None), verify = True, cert = None
2026-01-11T11:24:49.9935468Z proxies = OrderedDict()
2026-01-11T11:24:49.9935473Z 
2026-01-11T11:24:49.9935536Z     def send(
2026-01-11T11:24:49.9935741Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:49.9935800Z     ):
2026-01-11T11:24:49.9935948Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:49.9936006Z     
2026-01-11T11:24:49.9936196Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:49.9936486Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:49.9936647Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:49.9936805Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:49.9936893Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:49.9937028Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:49.9937221Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:49.9937393Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:49.9937489Z             must be a path to a CA bundle to use
2026-01-11T11:24:49.9937669Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:49.9937856Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:49.9938050Z         :rtype: requests.Response
2026-01-11T11:24:49.9938111Z         """
2026-01-11T11:24:49.9938170Z     
2026-01-11T11:24:49.9938230Z         try:
2026-01-11T11:24:49.9938354Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:49.9938442Z         except LocationValueError as e:
2026-01-11T11:24:49.9938534Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:49.9938596Z     
2026-01-11T11:24:49.9938721Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:49.9938819Z         url = self.request_url(request, proxies)
2026-01-11T11:24:49.9938896Z         self.add_headers(
2026-01-11T11:24:49.9938959Z             request,
2026-01-11T11:24:49.9939031Z             stream=stream,
2026-01-11T11:24:49.9939101Z             timeout=timeout,
2026-01-11T11:24:49.9939173Z             verify=verify,
2026-01-11T11:24:49.9939237Z             cert=cert,
2026-01-11T11:24:49.9939309Z             proxies=proxies,
2026-01-11T11:24:49.9939387Z         )
2026-01-11T11:24:49.9939445Z     
2026-01-11T11:24:49.9939637Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:49.9939695Z     
2026-01-11T11:24:49.9939786Z         if isinstance(timeout, tuple):
2026-01-11T11:24:49.9939846Z             try:
2026-01-11T11:24:49.9939922Z                 connect, read = timeout
2026-01-11T11:24:49.9940052Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:49.9940130Z             except ValueError:
2026-01-11T11:24:49.9940204Z                 raise ValueError(
2026-01-11T11:24:49.9940387Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:49.9940544Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:49.9940605Z                 )
2026-01-11T11:24:49.9940702Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:49.9940774Z             pass
2026-01-11T11:24:49.9940838Z         else:
2026-01-11T11:24:49.9940969Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:49.9941030Z     
2026-01-11T11:24:49.9941088Z         try:
2026-01-11T11:24:49.9941165Z >           resp = conn.urlopen(
2026-01-11T11:24:49.9941242Z                 method=request.method,
2026-01-11T11:24:49.9941312Z                 url=url,
2026-01-11T11:24:49.9941388Z                 body=request.body,
2026-01-11T11:24:49.9941468Z                 headers=request.headers,
2026-01-11T11:24:49.9941544Z                 redirect=False,
2026-01-11T11:24:49.9941619Z                 assert_same_host=False,
2026-01-11T11:24:49.9941696Z                 preload_content=False,
2026-01-11T11:24:49.9941773Z                 decode_content=False,
2026-01-11T11:24:49.9941858Z                 retries=self.max_retries,
2026-01-11T11:24:49.9941930Z                 timeout=timeout,
2026-01-11T11:24:49.9941999Z                 chunked=chunked,
2026-01-11T11:24:49.9942145Z             )
2026-01-11T11:24:49.9942155Z 
2026-01-11T11:24:49.9942414Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:486: 
2026-01-11T11:24:49.9942539Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9942852Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:841: in urlopen
2026-01-11T11:24:49.9942932Z     retries = retries.increment(
2026-01-11T11:24:49.9943048Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9943053Z 
2026-01-11T11:24:49.9943233Z self = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:49.9943375Z method = 'GET', url = '/api/v2/agent/thinking', response = None
2026-01-11T11:24:49.9943866Z error = NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f0677250>: Failed to establish a new connection: [Errno 111] Connection refused')
2026-01-11T11:24:49.9944360Z _pool = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f06776d0>
2026-01-11T11:24:49.9944477Z _stacktrace = <traceback object at 0x7f29f02f17c0>
2026-01-11T11:24:49.9944482Z 
2026-01-11T11:24:49.9944548Z     def increment(
2026-01-11T11:24:49.9944609Z         self,
2026-01-11T11:24:49.9944691Z         method: str | None = None,
2026-01-11T11:24:49.9944763Z         url: str | None = None,
2026-01-11T11:24:49.9944866Z         response: BaseHTTPResponse | None = None,
2026-01-11T11:24:49.9944953Z         error: Exception | None = None,
2026-01-11T11:24:49.9945043Z         _pool: ConnectionPool | None = None,
2026-01-11T11:24:49.9945140Z         _stacktrace: TracebackType | None = None,
2026-01-11T11:24:49.9945208Z     ) -> Self:
2026-01-11T11:24:49.9945356Z         """Return a new Retry object with incremented retry counters.
2026-01-11T11:24:49.9945416Z     
2026-01-11T11:24:49.9945582Z         :param response: A response object, or None, if the server did not
2026-01-11T11:24:49.9945671Z             return a response.
2026-01-11T11:24:49.9945824Z         :type response: :class:`~urllib3.response.BaseHTTPResponse`
2026-01-11T11:24:49.9945991Z         :param Exception error: An error encountered during the request, or
2026-01-11T11:24:49.9946115Z             None if the response was received successfully.
2026-01-11T11:24:49.9946172Z     
2026-01-11T11:24:49.9946251Z         :return: A new ``Retry`` object.
2026-01-11T11:24:49.9946315Z         """
2026-01-11T11:24:49.9946398Z         if self.total is False and error:
2026-01-11T11:24:49.9946505Z             # Disabled, indicate to re-raise the error.
2026-01-11T11:24:49.9946618Z             raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:49.9946681Z     
2026-01-11T11:24:49.9946752Z         total = self.total
2026-01-11T11:24:49.9946825Z         if total is not None:
2026-01-11T11:24:49.9946897Z             total -= 1
2026-01-11T11:24:49.9946954Z     
2026-01-11T11:24:49.9947027Z         connect = self.connect
2026-01-11T11:24:49.9947101Z         read = self.read
2026-01-11T11:24:49.9947180Z         redirect = self.redirect
2026-01-11T11:24:49.9947257Z         status_count = self.status
2026-01-11T11:24:49.9947325Z         other = self.other
2026-01-11T11:24:49.9947397Z         cause = "unknown"
2026-01-11T11:24:49.9947462Z         status = None
2026-01-11T11:24:49.9947536Z         redirect_location = None
2026-01-11T11:24:49.9947594Z     
2026-01-11T11:24:49.9947705Z         if error and self._is_connection_error(error):
2026-01-11T11:24:49.9947775Z             # Connect retry?
2026-01-11T11:24:49.9947848Z             if connect is False:
2026-01-11T11:24:49.9947968Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:49.9948048Z             elif connect is not None:
2026-01-11T11:24:49.9948118Z                 connect -= 1
2026-01-11T11:24:49.9948176Z     
2026-01-11T11:24:49.9948277Z         elif error and self._is_read_error(error):
2026-01-11T11:24:49.9948344Z             # Read retry?
2026-01-11T11:24:49.9948666Z             if read is False or method is None or not self._is_method_retryable(method):
2026-01-11T11:24:49.9948783Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:49.9948855Z             elif read is not None:
2026-01-11T11:24:49.9948920Z                 read -= 1
2026-01-11T11:24:49.9948977Z     
2026-01-11T11:24:49.9949039Z         elif error:
2026-01-11T11:24:49.9949107Z             # Other retry?
2026-01-11T11:24:49.9949181Z             if other is not None:
2026-01-11T11:24:49.9949251Z                 other -= 1
2026-01-11T11:24:49.9949308Z     
2026-01-11T11:24:49.9949429Z         elif response and response.get_redirect_location():
2026-01-11T11:24:49.9949506Z             # Redirect retry?
2026-01-11T11:24:49.9949581Z             if redirect is not None:
2026-01-11T11:24:49.9949650Z                 redirect -= 1
2026-01-11T11:24:49.9949733Z             cause = "too many redirects"
2026-01-11T11:24:49.9949897Z             response_redirect_location = response.get_redirect_location()
2026-01-11T11:24:49.9950097Z             if response_redirect_location:
2026-01-11T11:24:49.9950212Z                 redirect_location = response_redirect_location
2026-01-11T11:24:49.9950297Z             status = response.status
2026-01-11T11:24:49.9950353Z     
2026-01-11T11:24:49.9950412Z         else:
2026-01-11T11:24:49.9950547Z             # Incrementing because of a server error like a 500 in
2026-01-11T11:24:49.9950707Z             # status_forcelist and the given method is in the allowed_methods
2026-01-11T11:24:49.9950803Z             cause = ResponseError.GENERIC_ERROR
2026-01-11T11:24:49.9950893Z             if response and response.status:
2026-01-11T11:24:49.9950980Z                 if status_count is not None:
2026-01-11T11:24:49.9951058Z                     status_count -= 1
2026-01-11T11:24:49.9951258Z                 cause = ResponseError.SPECIFIC_ERROR.format(status_code=response.status)
2026-01-11T11:24:49.9951343Z                 status = response.status
2026-01-11T11:24:49.9951410Z     
2026-01-11T11:24:49.9951486Z         history = self.history + (
2026-01-11T11:24:49.9951653Z             RequestHistory(method, url, error, status, redirect_location),
2026-01-11T11:24:49.9951712Z         )
2026-01-11T11:24:49.9951769Z     
2026-01-11T11:24:49.9951840Z         new_retry = self.new(
2026-01-11T11:24:49.9951912Z             total=total,
2026-01-11T11:24:49.9951983Z             connect=connect,
2026-01-11T11:24:49.9952048Z             read=read,
2026-01-11T11:24:49.9952124Z             redirect=redirect,
2026-01-11T11:24:49.9952198Z             status=status_count,
2026-01-11T11:24:49.9952264Z             other=other,
2026-01-11T11:24:49.9952332Z             history=history,
2026-01-11T11:24:49.9952397Z         )
2026-01-11T11:24:49.9952454Z     
2026-01-11T11:24:49.9952530Z         if new_retry.is_exhausted():
2026-01-11T11:24:49.9952631Z             reason = error or ResponseError(cause)
2026-01-11T11:24:49.9952835Z >           raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
2026-01-11T11:24:49.9953843Z E           urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/thinking (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f0677250>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:49.9953850Z 
2026-01-11T11:24:49.9954260Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/retry.py:519: MaxRetryError
2026-01-11T11:24:49.9954267Z 
2026-01-11T11:24:49.9954431Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:49.9954437Z 
2026-01-11T11:24:49.9954597Z self = <test_phd_pipeline.TestPhDPipeline object at 0x7f2aec5b4160>
2026-01-11T11:24:49.9954602Z 
2026-01-11T11:24:49.9954697Z     def test_api_thinking_endpoint(self):
2026-01-11T11:24:49.9954819Z         """Test Agent Zero thinking stream API endpoint"""
2026-01-11T11:24:49.9955070Z         print("\n=== Testing Thinking Stream API Endpoint ===")
2026-01-11T11:24:49.9955132Z     
2026-01-11T11:24:49.9955211Z >       response = requests.get(
2026-01-11T11:24:49.9955314Z             f"{self.BASE_URL}/api/v2/agent/thinking",
2026-01-11T11:24:49.9955381Z             timeout=5,
2026-01-11T11:24:49.9955452Z             stream=True
2026-01-11T11:24:49.9955510Z         )
2026-01-11T11:24:49.9955515Z 
2026-01-11T11:24:49.9955618Z tests/integration/test_phd_pipeline.py:141: 
2026-01-11T11:24:49.9955745Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9955998Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:73: in get
2026-01-11T11:24:49.9956117Z     return request("get", url, params=params, **kwargs)
2026-01-11T11:24:49.9956385Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:59: in request
2026-01-11T11:24:49.9956520Z     return session.request(method=method, url=url, **kwargs)
2026-01-11T11:24:49.9956948Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:589: in request
2026-01-11T11:24:49.9957040Z     resp = self.send(prep, **send_kwargs)
2026-01-11T11:24:49.9957306Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:703: in send
2026-01-11T11:24:49.9957391Z     r = adapter.send(request, **kwargs)
2026-01-11T11:24:49.9957516Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9957522Z 
2026-01-11T11:24:49.9957674Z self = <requests.adapters.HTTPAdapter object at 0x7f29f0677880>
2026-01-11T11:24:49.9957782Z request = <PreparedRequest [GET]>, stream = True
2026-01-11T11:24:49.9957964Z timeout = Timeout(connect=5, read=5, total=None), verify = True, cert = None
2026-01-11T11:24:49.9958045Z proxies = OrderedDict()
2026-01-11T11:24:49.9958050Z 
2026-01-11T11:24:49.9958111Z     def send(
2026-01-11T11:24:49.9958314Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:49.9958387Z     ):
2026-01-11T11:24:49.9958528Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:49.9958584Z     
2026-01-11T11:24:49.9958784Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:49.9958940Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:49.9959099Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:49.9959257Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:49.9959345Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:49.9959473Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:49.9959665Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:49.9959838Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:49.9959937Z             must be a path to a CA bundle to use
2026-01-11T11:24:49.9960113Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:49.9960302Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:49.9960384Z         :rtype: requests.Response
2026-01-11T11:24:49.9960447Z         """
2026-01-11T11:24:49.9960509Z     
2026-01-11T11:24:49.9960570Z         try:
2026-01-11T11:24:49.9960689Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:49.9960778Z         except LocationValueError as e:
2026-01-11T11:24:49.9960872Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:49.9960930Z     
2026-01-11T11:24:49.9961047Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:49.9961145Z         url = self.request_url(request, proxies)
2026-01-11T11:24:49.9961219Z         self.add_headers(
2026-01-11T11:24:49.9961368Z             request,
2026-01-11T11:24:49.9961442Z             stream=stream,
2026-01-11T11:24:49.9961517Z             timeout=timeout,
2026-01-11T11:24:49.9961585Z             verify=verify,
2026-01-11T11:24:49.9961649Z             cert=cert,
2026-01-11T11:24:49.9961724Z             proxies=proxies,
2026-01-11T11:24:49.9961783Z         )
2026-01-11T11:24:49.9961840Z     
2026-01-11T11:24:49.9962032Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:49.9962094Z     
2026-01-11T11:24:49.9962178Z         if isinstance(timeout, tuple):
2026-01-11T11:24:49.9962238Z             try:
2026-01-11T11:24:49.9962320Z                 connect, read = timeout
2026-01-11T11:24:49.9962446Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:49.9962521Z             except ValueError:
2026-01-11T11:24:49.9962600Z                 raise ValueError(
2026-01-11T11:24:49.9962780Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:49.9963009Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:49.9963067Z                 )
2026-01-11T11:24:49.9963167Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:49.9963229Z             pass
2026-01-11T11:24:49.9963287Z         else:
2026-01-11T11:24:49.9963420Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:49.9963479Z     
2026-01-11T11:24:49.9963538Z         try:
2026-01-11T11:24:49.9963615Z             resp = conn.urlopen(
2026-01-11T11:24:49.9963697Z                 method=request.method,
2026-01-11T11:24:49.9963763Z                 url=url,
2026-01-11T11:24:49.9963836Z                 body=request.body,
2026-01-11T11:24:49.9963926Z                 headers=request.headers,
2026-01-11T11:24:49.9963997Z                 redirect=False,
2026-01-11T11:24:49.9964259Z                 assert_same_host=False,
2026-01-11T11:24:49.9964352Z                 preload_content=False,
2026-01-11T11:24:49.9964440Z                 decode_content=False,
2026-01-11T11:24:49.9964518Z                 retries=self.max_retries,
2026-01-11T11:24:49.9964590Z                 timeout=timeout,
2026-01-11T11:24:49.9964663Z                 chunked=chunked,
2026-01-11T11:24:49.9964722Z             )
2026-01-11T11:24:49.9964779Z     
2026-01-11T11:24:49.9964879Z         except (ProtocolError, OSError) as err:
2026-01-11T11:24:49.9964989Z             raise ConnectionError(err, request=request)
2026-01-11T11:24:49.9965046Z     
2026-01-11T11:24:49.9965128Z         except MaxRetryError as e:
2026-01-11T11:24:49.9965247Z             if isinstance(e.reason, ConnectTimeoutError):
2026-01-11T11:24:49.9965341Z                 # TODO: Remove this in 3.0.0: see #2811
2026-01-11T11:24:49.9965466Z                 if not isinstance(e.reason, NewConnectionError):
2026-01-11T11:24:49.9965577Z                     raise ConnectTimeout(e, request=request)
2026-01-11T11:24:49.9965633Z     
2026-01-11T11:24:49.9965737Z             if isinstance(e.reason, ResponseError):
2026-01-11T11:24:49.9965844Z                 raise RetryError(e, request=request)
2026-01-11T11:24:49.9965903Z     
2026-01-11T11:24:49.9965998Z             if isinstance(e.reason, _ProxyError):
2026-01-11T11:24:49.9966093Z                 raise ProxyError(e, request=request)
2026-01-11T11:24:49.9966156Z     
2026-01-11T11:24:49.9966245Z             if isinstance(e.reason, _SSLError):
2026-01-11T11:24:49.9966356Z                 # This branch is for urllib3 v1.22 and later.
2026-01-11T11:24:49.9966454Z                 raise SSLError(e, request=request)
2026-01-11T11:24:49.9966511Z     
2026-01-11T11:24:49.9966614Z >           raise ConnectionError(e, request=request)
2026-01-11T11:24:49.9967623Z E           requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/thinking (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f0677250>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:49.9967760Z 
2026-01-11T11:24:49.9968068Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:519: ConnectionError
2026-01-11T11:24:49.9968228Z ----------------------------- Captured stdout call -----------------------------
2026-01-11T11:24:49.9968234Z 
2026-01-11T11:24:49.9968332Z === Testing Thinking Stream API Endpoint ===
2026-01-11T11:24:49.9968502Z _____________________ TestPhDPipeline.test_docker_services _____________________
2026-01-11T11:24:49.9968506Z 
2026-01-11T11:24:49.9968670Z self = <urllib3.connection.HTTPConnection object at 0x7f29f0415e10>
2026-01-11T11:24:49.9968675Z 
2026-01-11T11:24:49.9968763Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:49.9968916Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:49.9968972Z     
2026-01-11T11:24:49.9969058Z         :return: New socket connection.
2026-01-11T11:24:49.9969117Z         """
2026-01-11T11:24:49.9969325Z         try:
2026-01-11T11:24:49.9969419Z >           sock = connection.create_connection(
2026-01-11T11:24:49.9969509Z                 (self._dns_host, self.port),
2026-01-11T11:24:49.9969579Z                 self.timeout,
2026-01-11T11:24:49.9969672Z                 source_address=self.source_address,
2026-01-11T11:24:49.9969768Z                 socket_options=self.socket_options,
2026-01-11T11:24:49.9969826Z             )
2026-01-11T11:24:49.9969831Z 
2026-01-11T11:24:49.9970088Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:198: 
2026-01-11T11:24:49.9970209Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9970551Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:85: in create_connection
2026-01-11T11:24:49.9970613Z     raise err
2026-01-11T11:24:49.9970726Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:49.9970749Z 
2026-01-11T11:24:49.9970893Z address = ('localhost', 8070), timeout = 10, source_address = None
2026-01-11T11:24:49.9970973Z socket_options = [(6, 1, 1)]
2026-01-11T11:24:49.9970978Z 
2026-01-11T11:24:49.9971051Z     def create_connection(
2026-01-11T11:24:49.9971134Z         address: tuple[str, int],
2026-01-11T11:24:49.9971232Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:49.9971338Z         source_address: tuple[str, int] | None = None,
2026-01-11T11:24:49.9971461Z         socket_options: _TYPE_SOCKET_OPTIONS | None = None,
2026-01-11T11:24:49.9971534Z     ) -> socket.socket:
2026-01-11T11:24:49.9971651Z         """Connect to *address* and return the socket object.
2026-01-11T11:24:49.9971712Z     
2026-01-11T11:24:49.9971873Z         Convenience function.  Connect to *address* (a 2-tuple ``(host,
2026-01-11T11:24:49.9972014Z         port)``) and return the socket object.  Passing the optional
2026-01-11T11:24:49.9972168Z         *timeout* parameter will set the timeout on the socket instance
2026-01-11T11:24:49.9972335Z         before attempting to connect.  If no *timeout* is supplied, the
2026-01-11T11:24:49.9972536Z         global default timeout setting returned by :func:`socket.getdefaulttimeout`
2026-01-11T11:24:49.9972701Z         is used.  If *source_address* is set it must be a tuple of (host, port)
2026-01-11T11:24:49.9972873Z         for the socket to bind as a source address before making the connection.
2026-01-11T11:24:49.9972997Z         An host of '' or port 0 tells the OS to use the default.
2026-01-11T11:24:49.9973056Z         """
2026-01-11T11:24:49.9973116Z     
2026-01-11T11:24:49.9973187Z         host, port = address
2026-01-11T11:24:49.9973263Z         if host.startswith("["):
2026-01-11T11:24:49.9973338Z             host = host.strip("[]")
2026-01-11T11:24:49.9973403Z         err = None
2026-01-11T11:24:49.9973460Z     
2026-01-11T11:24:49.9973652Z         # Using the value from allowed_gai_family() in the context of getaddrinfo lets
2026-01-11T11:24:49.9973926Z         # us select whether to work with IPv4 DNS records, IPv6 records, or both.
2026-01-11T11:24:49.9974198Z         # The original create_connection function always returns all records.
2026-01-11T11:24:49.9974281Z         family = allowed_gai_family()
2026-01-11T11:24:49.9974343Z     
2026-01-11T11:24:49.9974402Z         try:
2026-01-11T11:24:49.9974476Z             host.encode("idna")
2026-01-11T11:24:49.9974553Z         except UnicodeError:
2026-01-11T11:24:49.9974748Z             raise LocationParseError(f"'{host}', label empty or too long") from None
2026-01-11T11:24:49.9974805Z     
2026-01-11T11:24:49.9974977Z         for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
2026-01-11T11:24:49.9975084Z             af, socktype, proto, canonname, sa = res
2026-01-11T11:24:49.9975150Z             sock = None
2026-01-11T11:24:49.9975210Z             try:
2026-01-11T11:24:49.9975319Z                 sock = socket.socket(af, socktype, proto)
2026-01-11T11:24:49.9975385Z     
2026-01-11T11:24:49.9975644Z                 # If provided, set socket level options before connecting.
2026-01-11T11:24:49.9975751Z                 _set_socket_options(sock, socket_options)
2026-01-11T11:24:49.9975813Z     
2026-01-11T11:24:49.9975905Z                 if timeout is not _DEFAULT_TIMEOUT:
2026-01-11T11:24:49.9975989Z                     sock.settimeout(timeout)
2026-01-11T11:24:49.9976062Z                 if source_address:
2026-01-11T11:24:49.9976150Z                     sock.bind(source_address)
2026-01-11T11:24:49.9976223Z >               sock.connect(sa)
2026-01-11T11:24:49.9976369Z E               ConnectionRefusedError: [Errno 111] Connection refused
2026-01-11T11:24:49.9976375Z 
2026-01-11T11:24:49.9976748Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:73: ConnectionRefusedError
2026-01-11T11:24:49.9976754Z 
2026-01-11T11:24:49.9976922Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:49.9976932Z 
2026-01-11T11:24:49.9977135Z self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f0416170>
2026-01-11T11:24:49.9977242Z method = 'GET', url = '/api/version', body = None
2026-01-11T11:24:49.9977602Z headers = {'User-Agent': 'python-requests/2.31.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': '*/*', 'Connection': 'keep-alive'}
2026-01-11T11:24:49.9977791Z retries = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:49.9977887Z redirect = False, assert_same_host = False
2026-01-11T11:24:49.9978056Z timeout = Timeout(connect=10, read=10, total=None), pool_timeout = None
2026-01-11T11:24:49.9978244Z release_conn = False, chunked = False, body_pos = None, preload_content = False
2026-01-11T11:24:49.9978335Z decode_content = False, response_kw = {}
2026-01-11T11:24:49.9978620Z parsed_url = Url(scheme=None, auth=None, host=None, port=None, path='/api/version', query=None, fragment=None)
2026-01-11T11:24:49.9978775Z destination_scheme = None, conn = None, release_this_conn = True
2026-01-11T11:24:49.9978924Z http_tunnel_required = False, err = None, clean_exit = False
2026-01-11T11:24:49.9978929Z 
2026-01-11T11:24:49.9979014Z     def urlopen(  # type: ignore[override]
2026-01-11T11:24:49.9979073Z         self,
2026-01-11T11:24:49.9979140Z         method: str,
2026-01-11T11:24:49.9979201Z         url: str,
2026-01-11T11:24:49.9979279Z         body: _TYPE_BODY | None = None,
2026-01-11T11:24:49.9979394Z         headers: typing.Mapping[str, str] | None = None,
2026-01-11T11:24:49.9979494Z         retries: Retry | bool | int | None = None,
2026-01-11T11:24:49.9979570Z         redirect: bool = True,
2026-01-11T11:24:49.9979648Z         assert_same_host: bool = True,
2026-01-11T11:24:49.9979750Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:49.9979831Z         pool_timeout: int | None = None,
2026-01-11T11:24:49.9979911Z         release_conn: bool | None = None,
2026-01-11T11:24:49.9979982Z         chunked: bool = False,
2026-01-11T11:24:49.9980206Z         body_pos: _TYPE_BODY_POSITION | None = None,
2026-01-11T11:24:49.9980293Z         preload_content: bool = True,
2026-01-11T11:24:49.9980370Z         decode_content: bool = True,
2026-01-11T11:24:49.9980452Z         **response_kw: typing.Any,
2026-01-11T11:24:49.9980529Z     ) -> BaseHTTPResponse:
2026-01-11T11:24:49.9980588Z         """
2026-01-11T11:24:49.9980766Z         Get a connection from the pool and perform an HTTP request. This is the
2026-01-11T11:24:49.9980939Z         lowest level call for making a request, so you'll need to specify all
2026-01-11T11:24:49.9981007Z         the raw details.
2026-01-11T11:24:49.9981063Z     
2026-01-11T11:24:49.9981142Z         .. note::
2026-01-11T11:24:49.9981199Z     
2026-01-11T11:24:49.9981349Z            More commonly, it's appropriate to use a convenience method
2026-01-11T11:24:49.9981430Z            such as :meth:`request`.
2026-01-11T11:24:49.9981487Z     
2026-01-11T11:24:49.9981548Z         .. note::
2026-01-11T11:24:49.9981604Z     
2026-01-11T11:24:49.9981804Z            `release_conn` will only behave as expected if
2026-01-11T11:24:49.9981917Z            `preload_content=False` because we want to make
2026-01-11T11:24:49.9982083Z            `preload_content=False` the default behaviour someday soon without
2026-01-11T11:24:49.9982180Z            breaking backwards compatibility.
2026-01-11T11:24:49.9982236Z     
2026-01-11T11:24:49.9982308Z         :param method:
2026-01-11T11:24:49.9982430Z             HTTP request method (such as GET, POST, PUT, etc.)
2026-01-11T11:24:49.9982491Z     
2026-01-11T11:24:49.9982555Z         :param url:
2026-01-11T11:24:49.9982646Z             The URL to perform the request on.
2026-01-11T11:24:49.9982706Z     
2026-01-11T11:24:49.9982770Z         :param body:
2026-01-11T11:24:49.9982938Z             Data to send in the request body, either :class:`str`, :class:`bytes`,
2026-01-11T11:24:49.9983097Z             an iterable of :class:`str`/:class:`bytes`, or a file-like object.
2026-01-11T11:24:49.9983154Z     
2026-01-11T11:24:49.9983232Z         :param headers:
2026-01-11T11:24:49.9983377Z             Dictionary of custom headers to send, such as User-Agent,
2026-01-11T11:24:49.9983544Z             If-None-Match, etc. If None, pool headers are used. If provided,
2026-01-11T11:24:49.9983696Z             these headers completely replace any pool-specific headers.
2026-01-11T11:24:49.9983753Z     
2026-01-11T11:24:49.9983825Z         :param retries:
2026-01-11T11:24:49.9983965Z             Configure the number of retries to allow before raising a
2026-01-11T11:24:49.9984298Z             :class:`~urllib3.exceptions.MaxRetryError` exception.
2026-01-11T11:24:49.9984364Z     
2026-01-11T11:24:49.9984538Z             If ``None`` (default) will retry 3 times, see ``Retry.DEFAULT``. Pass a
2026-01-11T11:24:49.9984706Z             :class:`~urllib3.util.retry.Retry` object for fine-grained control
2026-01-11T11:24:49.9984793Z             over different types of retries.
2026-01-11T11:24:49.9984961Z             Pass an integer number to retry connection errors that many times,
2026-01-11T11:24:49.9985101Z             but no other types of errors. Pass zero to never retry.
2026-01-11T11:24:49.9985159Z     
2026-01-11T11:24:49.9985321Z             If ``False``, then retries are disabled and any exception is raised
2026-01-11T11:24:49.9985491Z             immediately. Also, instead of raising a MaxRetryError on redirects,
2026-01-11T11:24:49.9985588Z             the redirect response will be returned.
2026-01-11T11:24:49.9985649Z     
2026-01-11T11:24:49.9985811Z         :type retries: :class:`~urllib3.util.retry.Retry`, False, or an int.
2026-01-11T11:24:49.9985868Z     
2026-01-11T11:24:49.9985938Z         :param redirect:
2026-01-11T11:24:49.9986100Z             If True, automatically handle redirects (status codes 301, 302,
2026-01-11T11:24:49.9986248Z             303, 307, 308). Each redirect counts as a retry. Disabling retries
2026-01-11T11:24:49.9986327Z             will disable redirect, too.
2026-01-11T11:24:49.9986388Z     
2026-01-11T11:24:49.9986593Z         :param assert_same_host:
2026-01-11T11:24:49.9986738Z             If ``True``, will make sure that the host of the pool requests is
2026-01-11T11:24:49.9986916Z             consistent else will raise HostChangedError. When ``False``, you can
2026-01-11T11:24:49.9987052Z             use the pool on an HTTP proxy and request foreign hosts.
2026-01-11T11:24:49.9987107Z     
2026-01-11T11:24:49.9987175Z         :param timeout:
2026-01-11T11:24:49.9987313Z             If specified, overrides the default timeout for this one
2026-01-11T11:24:49.9987449Z             request. It may be a float (in seconds) or an instance of
2026-01-11T11:24:49.9987536Z             :class:`urllib3.util.Timeout`.
2026-01-11T11:24:49.9987596Z     
2026-01-11T11:24:49.9987669Z         :param pool_timeout:
2026-01-11T11:24:49.9987817Z             If set and the pool is set to block=True, then this method will
2026-01-11T11:24:49.9987977Z             block for ``pool_timeout`` seconds and raise EmptyPoolError if no
2026-01-11T11:24:49.9988211Z             connection is available within the time period.
2026-01-11T11:24:49.9988268Z     
2026-01-11T11:24:49.9988348Z         :param bool preload_content:
2026-01-11T11:24:49.9988491Z             If True, the response's body will be preloaded into memory.
2026-01-11T11:24:49.9988548Z     
2026-01-11T11:24:49.9988626Z         :param bool decode_content:
2026-01-11T11:24:49.9988755Z             If True, will attempt to decode the body based on the
2026-01-11T11:24:49.9988836Z             'content-encoding' header.
2026-01-11T11:24:49.9988891Z     
2026-01-11T11:24:49.9988964Z         :param release_conn:
2026-01-11T11:24:49.9989119Z             If False, then the urlopen call will not release the connection
2026-01-11T11:24:49.9989281Z             back into the pool once a response is received (but will release if
2026-01-11T11:24:49.9989416Z             you read the entire contents of the response such as when
2026-01-11T11:24:49.9989578Z             `preload_content=True`). This is useful if you're not preloading
2026-01-11T11:24:49.9989721Z             the response's content immediately. You will need to call
2026-01-11T11:24:49.9989877Z             ``r.release_conn()`` on the response ``r`` to return the connection
2026-01-11T11:24:49.9990052Z             back into the pool. If None, it takes the value of ``preload_content``
2026-01-11T11:24:49.9990128Z             which defaults to ``True``.
2026-01-11T11:24:49.9990185Z     
2026-01-11T11:24:49.9990255Z         :param bool chunked:
2026-01-11T11:24:49.9990394Z             If True, urllib3 will send the body using chunked transfer
2026-01-11T11:24:49.9990558Z             encoding. Otherwise, urllib3 will send the body using the standard
2026-01-11T11:24:49.9990654Z             content-length form. Defaults to False.
2026-01-11T11:24:49.9990713Z     
2026-01-11T11:24:49.9990786Z         :param int body_pos:
2026-01-11T11:24:49.9990940Z             Position to seek to in file-like body in the event of a retry or
2026-01-11T11:24:49.9991116Z             redirect. Typically this won't need to be set because urllib3 will
2026-01-11T11:24:49.9991211Z             auto-populate the value when needed.
2026-01-11T11:24:49.9991272Z         """
2026-01-11T11:24:49.9991352Z         parsed_url = parse_url(url)
2026-01-11T11:24:49.9991449Z         destination_scheme = parsed_url.scheme
2026-01-11T11:24:49.9991505Z     
2026-01-11T11:24:49.9991577Z         if headers is None:
2026-01-11T11:24:49.9991657Z             headers = self.headers
2026-01-11T11:24:49.9991714Z     
2026-01-11T11:24:49.9991798Z         if not isinstance(retries, Retry):
2026-01-11T11:24:49.9991988Z             retries = Retry.from_int(retries, redirect=redirect, default=self.retries)
2026-01-11T11:24:49.9992050Z     
2026-01-11T11:24:49.9992124Z         if release_conn is None:
2026-01-11T11:24:49.9992203Z             release_conn = preload_content
2026-01-11T11:24:49.9992264Z     
2026-01-11T11:24:49.9992357Z         # Check host
2026-01-11T11:24:49.9992688Z         if assert_same_host and not self.is_same_host(url):
2026-01-11T11:24:49.9992873Z             raise HostChangedError(self, url, retries)
2026-01-11T11:24:49.9993328Z     
2026-01-11T11:24:49.9993724Z         # Ensure that the URL we're connecting to is properly encoded
2026-01-11T11:24:49.9994381Z         if url.startswith("/"):
2026-01-11T11:24:49.9994759Z             url = to_str(_encode_target(url))
2026-01-11T11:24:49.9995125Z         else:
2026-01-11T11:24:49.9995397Z             url = to_str(parsed_url.url)
2026-01-11T11:24:49.9995775Z     
2026-01-11T11:24:49.9996041Z         conn = None
2026-01-11T11:24:49.9996334Z     
2026-01-11T11:24:49.9996677Z         # Track whether `conn` needs to be released before
2026-01-11T11:24:49.9997386Z         # returning/raising/recursing. Update this variable if necessary, and
2026-01-11T11:24:49.9998211Z         # leave `release_conn` constant throughout the function. That way, if
2026-01-11T11:24:49.9999032Z         # the function recurses, the original value of `release_conn` will be
2026-01-11T11:24:50.0000191Z         # passed down into the recursive call, and its value will be respected.
2026-01-11T11:24:50.0000788Z         #
2026-01-11T11:24:50.0001072Z         # See issue #651 [1] for details.
2026-01-11T11:24:50.0001453Z         #
2026-01-11T11:24:50.0001756Z         # [1] <https://github.com/urllib3/urllib3/issues/651>
2026-01-11T11:24:50.0002062Z         release_this_conn = release_conn
2026-01-11T11:24:50.0002287Z     
2026-01-11T11:24:50.0002506Z         http_tunnel_required = connection_requires_http_tunnel(
2026-01-11T11:24:50.0002858Z             self.proxy, self.proxy_config, destination_scheme
2026-01-11T11:24:50.0003130Z         )
2026-01-11T11:24:50.0003265Z     
2026-01-11T11:24:50.0003514Z         # Merge the proxy headers. Only done when not using HTTP CONNECT. We
2026-01-11T11:24:50.0003952Z         # have to copy the headers dict so we can safely change it without those
2026-01-11T11:24:50.0004661Z         # changes being reflected in anyone else's copy.
2026-01-11T11:24:50.0004962Z         if not http_tunnel_required:
2026-01-11T11:24:50.0005261Z             headers = headers.copy()  # type: ignore[attr-defined]
2026-01-11T11:24:50.0005651Z             headers.update(self.proxy_headers)  # type: ignore[union-attr]
2026-01-11T11:24:50.0005965Z     
2026-01-11T11:24:50.0006226Z         # Must keep the exception bound to a separate variable or else Python 3
2026-01-11T11:24:50.0006667Z         # complains about UnboundLocalError.
2026-01-11T11:24:50.0006916Z         err = None
2026-01-11T11:24:50.0007079Z     
2026-01-11T11:24:50.0007309Z         # Keep track of whether we cleanly exited the except block. This
2026-01-11T11:24:50.0007655Z         # ensures we do proper cleanup in finally.
2026-01-11T11:24:50.0007909Z         clean_exit = False
2026-01-11T11:24:50.0008096Z     
2026-01-11T11:24:50.0008314Z         # Rewind body position, if needed. Record current position
2026-01-11T11:24:50.0008674Z         # for future rewinds in the event of a redirect/retry.
2026-01-11T11:24:50.0009011Z         body_pos = set_file_position(body, body_pos)
2026-01-11T11:24:50.0009273Z     
2026-01-11T11:24:50.0009410Z         try:
2026-01-11T11:24:50.0009599Z             # Request a connection from the queue.
2026-01-11T11:24:50.0009877Z             timeout_obj = self._get_timeout(timeout)
2026-01-11T11:24:50.0010175Z             conn = self._get_conn(timeout=pool_timeout)
2026-01-11T11:24:50.0010425Z     
2026-01-11T11:24:50.0010683Z             conn.timeout = timeout_obj.connect_timeout  # type: ignore[assignment]
2026-01-11T11:24:50.0011024Z     
2026-01-11T11:24:50.0011266Z             # Is this a closed/new connection that requires CONNECT tunnelling?
2026-01-11T11:24:50.0011706Z             if self.proxy is not None and http_tunnel_required and conn.is_closed:
2026-01-11T11:24:50.0012042Z                 try:
2026-01-11T11:24:50.0012241Z                     self._prepare_proxy(conn)
2026-01-11T11:24:50.0012552Z                 except (BaseSSLError, OSError, SocketTimeout) as e:
2026-01-11T11:24:50.0013015Z                     self._raise_timeout(
2026-01-11T11:24:50.0013319Z                         err=e, url=self.proxy.url, timeout_value=conn.timeout
2026-01-11T11:24:50.0013624Z                     )
2026-01-11T11:24:50.0013800Z                     raise
2026-01-11T11:24:50.0013974Z     
2026-01-11T11:24:50.0014349Z             # If we're going to release the connection in ``finally:``, then
2026-01-11T11:24:50.0014772Z             # the response doesn't need to know about the connection. Otherwise
2026-01-11T11:24:50.0015198Z             # it will also try to release it and we'll have a double-release
2026-01-11T11:24:50.0015511Z             # mess.
2026-01-11T11:24:50.0015740Z             response_conn = conn if not release_conn else None
2026-01-11T11:24:50.0016018Z     
2026-01-11T11:24:50.0016218Z             # Make the request on the HTTPConnection object
2026-01-11T11:24:50.0016509Z >           response = self._make_request(
2026-01-11T11:24:50.0016745Z                 conn,
2026-01-11T11:24:50.0017045Z                 method,
2026-01-11T11:24:50.0017216Z                 url,
2026-01-11T11:24:50.0017398Z                 timeout=timeout_obj,
2026-01-11T11:24:50.0017625Z                 body=body,
2026-01-11T11:24:50.0017817Z                 headers=headers,
2026-01-11T11:24:50.0018029Z                 chunked=chunked,
2026-01-11T11:24:50.0018231Z                 retries=retries,
2026-01-11T11:24:50.0018457Z                 response_conn=response_conn,
2026-01-11T11:24:50.0018720Z                 preload_content=preload_content,
2026-01-11T11:24:50.0018990Z                 decode_content=decode_content,
2026-01-11T11:24:50.0019230Z                 **response_kw,
2026-01-11T11:24:50.0019430Z             )
2026-01-11T11:24:50.0019526Z 
2026-01-11T11:24:50.0019822Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:787: 
2026-01-11T11:24:50.0020330Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0020894Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:493: in _make_request
2026-01-11T11:24:50.0021390Z     conn.request(
2026-01-11T11:24:50.0021786Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:445: in request
2026-01-11T11:24:50.0022250Z     self.endheaders()
2026-01-11T11:24:50.0022595Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1278: in endheaders
2026-01-11T11:24:50.0023084Z     self._send_output(message_body, encode_chunked=encode_chunked)
2026-01-11T11:24:50.0023562Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1038: in _send_output
2026-01-11T11:24:50.0023964Z     self.send(msg)
2026-01-11T11:24:50.0024476Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:976: in send
2026-01-11T11:24:50.0024856Z     self.connect()
2026-01-11T11:24:50.0025243Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:276: in connect
2026-01-11T11:24:50.0025717Z     self.sock = self._new_conn()
2026-01-11T11:24:50.0025987Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0026209Z 
2026-01-11T11:24:50.0026382Z self = <urllib3.connection.HTTPConnection object at 0x7f29f0415e10>
2026-01-11T11:24:50.0026648Z 
2026-01-11T11:24:50.0026738Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:50.0027064Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:50.0027372Z     
2026-01-11T11:24:50.0027538Z         :return: New socket connection.
2026-01-11T11:24:50.0027761Z         """
2026-01-11T11:24:50.0027914Z         try:
2026-01-11T11:24:50.0028101Z             sock = connection.create_connection(
2026-01-11T11:24:50.0028370Z                 (self._dns_host, self.port),
2026-01-11T11:24:50.0028606Z                 self.timeout,
2026-01-11T11:24:50.0028837Z                 source_address=self.source_address,
2026-01-11T11:24:50.0029255Z                 socket_options=self.socket_options,
2026-01-11T11:24:50.0029499Z             )
2026-01-11T11:24:50.0029678Z         except socket.gaierror as e:
2026-01-11T11:24:50.0029975Z             raise NameResolutionError(self.host, self, e) from e
2026-01-11T11:24:50.0030281Z         except SocketTimeout as e:
2026-01-11T11:24:50.0030518Z             raise ConnectTimeoutError(
2026-01-11T11:24:50.0030748Z                 self,
2026-01-11T11:24:50.0031054Z                 f"Connection to {self.host} timed out. (connect timeout={self.timeout})",
2026-01-11T11:24:50.0031418Z             ) from e
2026-01-11T11:24:50.0031582Z     
2026-01-11T11:24:50.0031740Z         except OSError as e:
2026-01-11T11:24:50.0031954Z >           raise NewConnectionError(
2026-01-11T11:24:50.0032240Z                 self, f"Failed to establish a new connection: {e}"
2026-01-11T11:24:50.0032527Z             ) from e
2026-01-11T11:24:50.0033193Z E           urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f29f0415e10>: Failed to establish a new connection: [Errno 111] Connection refused
2026-01-11T11:24:50.0034001Z 
2026-01-11T11:24:50.0034433Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:213: NewConnectionError
2026-01-11T11:24:50.0034863Z 
2026-01-11T11:24:50.0035039Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:50.0035303Z 
2026-01-11T11:24:50.0035464Z self = <requests.adapters.HTTPAdapter object at 0x7f29f04158a0>
2026-01-11T11:24:50.0035823Z request = <PreparedRequest [GET]>, stream = False
2026-01-11T11:24:50.0036207Z timeout = Timeout(connect=10, read=10, total=None), verify = True, cert = None
2026-01-11T11:24:50.0036575Z proxies = OrderedDict()
2026-01-11T11:24:50.0036704Z 
2026-01-11T11:24:50.0036767Z     def send(
2026-01-11T11:24:50.0037071Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:50.0037435Z     ):
2026-01-11T11:24:50.0037674Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:50.0037966Z     
2026-01-11T11:24:50.0038240Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:50.0038687Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:50.0039102Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:50.0039515Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:50.0039857Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:50.0040160Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:50.0040577Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:50.0041040Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:50.0041405Z             must be a path to a CA bundle to use
2026-01-11T11:24:50.0041772Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:50.0042239Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:50.0042607Z         :rtype: requests.Response
2026-01-11T11:24:50.0042817Z         """
2026-01-11T11:24:50.0042971Z     
2026-01-11T11:24:50.0043112Z         try:
2026-01-11T11:24:50.0043327Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:50.0043623Z         except LocationValueError as e:
2026-01-11T11:24:50.0043888Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:50.0044319Z     
2026-01-11T11:24:50.0044525Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:50.0044833Z         url = self.request_url(request, proxies)
2026-01-11T11:24:50.0045084Z         self.add_headers(
2026-01-11T11:24:50.0045274Z             request,
2026-01-11T11:24:50.0045449Z             stream=stream,
2026-01-11T11:24:50.0045775Z             timeout=timeout,
2026-01-11T11:24:50.0045978Z             verify=verify,
2026-01-11T11:24:50.0046167Z             cert=cert,
2026-01-11T11:24:50.0046351Z             proxies=proxies,
2026-01-11T11:24:50.0046540Z         )
2026-01-11T11:24:50.0046683Z     
2026-01-11T11:24:50.0046959Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:50.0047310Z     
2026-01-11T11:24:50.0047470Z         if isinstance(timeout, tuple):
2026-01-11T11:24:50.0047696Z             try:
2026-01-11T11:24:50.0047868Z                 connect, read = timeout
2026-01-11T11:24:50.0048152Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:50.0048445Z             except ValueError:
2026-01-11T11:24:50.0048657Z                 raise ValueError(
2026-01-11T11:24:50.0048990Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:50.0049423Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:50.0049856Z                 )
2026-01-11T11:24:50.0050053Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:50.0050302Z             pass
2026-01-11T11:24:50.0050461Z         else:
2026-01-11T11:24:50.0050691Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:50.0050971Z     
2026-01-11T11:24:50.0051115Z         try:
2026-01-11T11:24:50.0051283Z >           resp = conn.urlopen(
2026-01-11T11:24:50.0051511Z                 method=request.method,
2026-01-11T11:24:50.0051734Z                 url=url,
2026-01-11T11:24:50.0051932Z                 body=request.body,
2026-01-11T11:24:50.0052160Z                 headers=request.headers,
2026-01-11T11:24:50.0052391Z                 redirect=False,
2026-01-11T11:24:50.0052606Z                 assert_same_host=False,
2026-01-11T11:24:50.0052840Z                 preload_content=False,
2026-01-11T11:24:50.0053075Z                 decode_content=False,
2026-01-11T11:24:50.0053307Z                 retries=self.max_retries,
2026-01-11T11:24:50.0053555Z                 timeout=timeout,
2026-01-11T11:24:50.0053760Z                 chunked=chunked,
2026-01-11T11:24:50.0053957Z             )
2026-01-11T11:24:50.0054154Z 
2026-01-11T11:24:50.0054424Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:486: 
2026-01-11T11:24:50.0054902Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0055430Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:841: in urlopen
2026-01-11T11:24:50.0055914Z     retries = retries.increment(
2026-01-11T11:24:50.0056182Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0056405Z 
2026-01-11T11:24:50.0056588Z self = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:50.0056977Z method = 'GET', url = '/api/version', response = None
2026-01-11T11:24:50.0057687Z error = NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f0415e10>: Failed to establish a new connection: [Errno 111] Connection refused')
2026-01-11T11:24:50.0058477Z _pool = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f0416170>
2026-01-11T11:24:50.0058886Z _stacktrace = <traceback object at 0x7f29f032a700>
2026-01-11T11:24:50.0059086Z 
2026-01-11T11:24:50.0059157Z     def increment(
2026-01-11T11:24:50.0059320Z         self,
2026-01-11T11:24:50.0059493Z         method: str | None = None,
2026-01-11T11:24:50.0059716Z         url: str | None = None,
2026-01-11T11:24:50.0059960Z         response: BaseHTTPResponse | None = None,
2026-01-11T11:24:50.0060227Z         error: Exception | None = None,
2026-01-11T11:24:50.0060480Z         _pool: ConnectionPool | None = None,
2026-01-11T11:24:50.0060750Z         _stacktrace: TracebackType | None = None,
2026-01-11T11:24:50.0060999Z     ) -> Self:
2026-01-11T11:24:50.0061242Z         """Return a new Retry object with incremented retry counters.
2026-01-11T11:24:50.0061665Z     
2026-01-11T11:24:50.0061916Z         :param response: A response object, or None, if the server did not
2026-01-11T11:24:50.0062248Z             return a response.
2026-01-11T11:24:50.0062547Z         :type response: :class:`~urllib3.response.BaseHTTPResponse`
2026-01-11T11:24:50.0062964Z         :param Exception error: An error encountered during the request, or
2026-01-11T11:24:50.0063349Z             None if the response was received successfully.
2026-01-11T11:24:50.0063614Z     
2026-01-11T11:24:50.0063776Z         :return: A new ``Retry`` object.
2026-01-11T11:24:50.0063998Z         """
2026-01-11T11:24:50.0064365Z         if self.total is False and error:
2026-01-11T11:24:50.0064644Z             # Disabled, indicate to re-raise the error.
2026-01-11T11:24:50.0064947Z             raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:50.0065207Z     
2026-01-11T11:24:50.0065356Z         total = self.total
2026-01-11T11:24:50.0065561Z         if total is not None:
2026-01-11T11:24:50.0065894Z             total -= 1
2026-01-11T11:24:50.0066068Z     
2026-01-11T11:24:50.0066219Z         connect = self.connect
2026-01-11T11:24:50.0066425Z         read = self.read
2026-01-11T11:24:50.0066621Z         redirect = self.redirect
2026-01-11T11:24:50.0066838Z         status_count = self.status
2026-01-11T11:24:50.0067059Z         other = self.other
2026-01-11T11:24:50.0067249Z         cause = "unknown"
2026-01-11T11:24:50.0067437Z         status = None
2026-01-11T11:24:50.0067622Z         redirect_location = None
2026-01-11T11:24:50.0067823Z     
2026-01-11T11:24:50.0068005Z         if error and self._is_connection_error(error):
2026-01-11T11:24:50.0068273Z             # Connect retry?
2026-01-11T11:24:50.0068476Z             if connect is False:
2026-01-11T11:24:50.0068736Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:50.0069026Z             elif connect is not None:
2026-01-11T11:24:50.0069253Z                 connect -= 1
2026-01-11T11:24:50.0069454Z     
2026-01-11T11:24:50.0069628Z         elif error and self._is_read_error(error):
2026-01-11T11:24:50.0069885Z             # Read retry?
2026-01-11T11:24:50.0070193Z             if read is False or method is None or not self._is_method_retryable(method):
2026-01-11T11:24:50.0070604Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:50.0070891Z             elif read is not None:
2026-01-11T11:24:50.0071103Z                 read -= 1
2026-01-11T11:24:50.0071284Z     
2026-01-11T11:24:50.0071423Z         elif error:
2026-01-11T11:24:50.0071601Z             # Other retry?
2026-01-11T11:24:50.0071798Z             if other is not None:
2026-01-11T11:24:50.0072014Z                 other -= 1
2026-01-11T11:24:50.0072191Z     
2026-01-11T11:24:50.0072400Z         elif response and response.get_redirect_location():
2026-01-11T11:24:50.0072685Z             # Redirect retry?
2026-01-11T11:24:50.0072898Z             if redirect is not None:
2026-01-11T11:24:50.0073129Z                 redirect -= 1
2026-01-11T11:24:50.0073346Z             cause = "too many redirects"
2026-01-11T11:24:50.0073673Z             response_redirect_location = response.get_redirect_location()
2026-01-11T11:24:50.0074012Z             if response_redirect_location:
2026-01-11T11:24:50.0074400Z                 redirect_location = response_redirect_location
2026-01-11T11:24:50.0074683Z             status = response.status
2026-01-11T11:24:50.0074899Z     
2026-01-11T11:24:50.0075033Z         else:
2026-01-11T11:24:50.0075265Z             # Incrementing because of a server error like a 500 in
2026-01-11T11:24:50.0075653Z             # status_forcelist and the given method is in the allowed_methods
2026-01-11T11:24:50.0076008Z             cause = ResponseError.GENERIC_ERROR
2026-01-11T11:24:50.0076288Z             if response and response.status:
2026-01-11T11:24:50.0076543Z                 if status_count is not None:
2026-01-11T11:24:50.0076785Z                     status_count -= 1
2026-01-11T11:24:50.0077260Z                 cause = ResponseError.SPECIFIC_ERROR.format(status_code=response.status)
2026-01-11T11:24:50.0077652Z                 status = response.status
2026-01-11T11:24:50.0077869Z     
2026-01-11T11:24:50.0078029Z         history = self.history + (
2026-01-11T11:24:50.0078345Z             RequestHistory(method, url, error, status, redirect_location),
2026-01-11T11:24:50.0078659Z         )
2026-01-11T11:24:50.0078808Z     
2026-01-11T11:24:50.0078959Z         new_retry = self.new(
2026-01-11T11:24:50.0079165Z             total=total,
2026-01-11T11:24:50.0079355Z             connect=connect,
2026-01-11T11:24:50.0079555Z             read=read,
2026-01-11T11:24:50.0079740Z             redirect=redirect,
2026-01-11T11:24:50.0079955Z             status=status_count,
2026-01-11T11:24:50.0080168Z             other=other,
2026-01-11T11:24:50.0080360Z             history=history,
2026-01-11T11:24:50.0080551Z         )
2026-01-11T11:24:50.0080691Z     
2026-01-11T11:24:50.0080853Z         if new_retry.is_exhausted():
2026-01-11T11:24:50.0081235Z             reason = error or ResponseError(cause)
2026-01-11T11:24:50.0081636Z >           raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
2026-01-11T11:24:50.0082923Z E           urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8070): Max retries exceeded with url: /api/version (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f0415e10>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:50.0084004Z 
2026-01-11T11:24:50.0084507Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/retry.py:519: MaxRetryError
2026-01-11T11:24:50.0084923Z 
2026-01-11T11:24:50.0085094Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0085355Z 
2026-01-11T11:24:50.0085520Z self = <test_phd_pipeline.TestPhDPipeline object at 0x7f2aec5b4370>
2026-01-11T11:24:50.0085780Z 
2026-01-11T11:24:50.0085869Z     def test_docker_services(self):
2026-01-11T11:24:50.0086132Z         """Test all Docker services are running"""
2026-01-11T11:24:50.0086415Z         print("\n=== Testing Docker Services ===")
2026-01-11T11:24:50.0086662Z     
2026-01-11T11:24:50.0086802Z         # GROBID
2026-01-11T11:24:50.0086997Z         print("1. Testing GROBID service...")
2026-01-11T11:24:50.0087395Z >       response = requests.get('http://localhost:8070/api/version', timeout=10)
2026-01-11T11:24:50.0087692Z 
2026-01-11T11:24:50.0087798Z tests/integration/test_phd_pipeline.py:168: 
2026-01-11T11:24:50.0088103Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0088576Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:73: in get
2026-01-11T11:24:50.0089055Z     return request("get", url, params=params, **kwargs)
2026-01-11T11:24:50.0089525Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:59: in request
2026-01-11T11:24:50.0090043Z     return session.request(method=method, url=url, **kwargs)
2026-01-11T11:24:50.0090555Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:589: in request
2026-01-11T11:24:50.0091037Z     resp = self.send(prep, **send_kwargs)
2026-01-11T11:24:50.0091484Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:703: in send
2026-01-11T11:24:50.0091940Z     r = adapter.send(request, **kwargs)
2026-01-11T11:24:50.0092229Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0092449Z 
2026-01-11T11:24:50.0092609Z self = <requests.adapters.HTTPAdapter object at 0x7f29f04158a0>
2026-01-11T11:24:50.0092971Z request = <PreparedRequest [GET]>, stream = False
2026-01-11T11:24:50.0093358Z timeout = Timeout(connect=10, read=10, total=None), verify = True, cert = None
2026-01-11T11:24:50.0093719Z proxies = OrderedDict()
2026-01-11T11:24:50.0093846Z 
2026-01-11T11:24:50.0094139Z     def send(
2026-01-11T11:24:50.0094446Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:50.0094813Z     ):
2026-01-11T11:24:50.0095039Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:50.0095332Z     
2026-01-11T11:24:50.0095604Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:50.0096056Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:50.0096470Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:50.0096880Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:50.0097219Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:50.0097517Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:50.0097938Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:50.0098419Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:50.0098898Z             must be a path to a CA bundle to use
2026-01-11T11:24:50.0099259Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:50.0099724Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:50.0100095Z         :rtype: requests.Response
2026-01-11T11:24:50.0100304Z         """
2026-01-11T11:24:50.0100456Z     
2026-01-11T11:24:50.0100594Z         try:
2026-01-11T11:24:50.0100815Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:50.0101116Z         except LocationValueError as e:
2026-01-11T11:24:50.0101377Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:50.0101614Z     
2026-01-11T11:24:50.0101813Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:50.0102119Z         url = self.request_url(request, proxies)
2026-01-11T11:24:50.0102374Z         self.add_headers(
2026-01-11T11:24:50.0102574Z             request,
2026-01-11T11:24:50.0102752Z             stream=stream,
2026-01-11T11:24:50.0102956Z             timeout=timeout,
2026-01-11T11:24:50.0103156Z             verify=verify,
2026-01-11T11:24:50.0103342Z             cert=cert,
2026-01-11T11:24:50.0103534Z             proxies=proxies,
2026-01-11T11:24:50.0103721Z         )
2026-01-11T11:24:50.0103868Z     
2026-01-11T11:24:50.0104328Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:50.0104692Z     
2026-01-11T11:24:50.0104854Z         if isinstance(timeout, tuple):
2026-01-11T11:24:50.0105080Z             try:
2026-01-11T11:24:50.0105255Z                 connect, read = timeout
2026-01-11T11:24:50.0105544Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:50.0105843Z             except ValueError:
2026-01-11T11:24:50.0106054Z                 raise ValueError(
2026-01-11T11:24:50.0106391Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:50.0106825Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:50.0107135Z                 )
2026-01-11T11:24:50.0107332Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:50.0107579Z             pass
2026-01-11T11:24:50.0107736Z         else:
2026-01-11T11:24:50.0107967Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:50.0108251Z     
2026-01-11T11:24:50.0108389Z         try:
2026-01-11T11:24:50.0108562Z             resp = conn.urlopen(
2026-01-11T11:24:50.0108785Z                 method=request.method,
2026-01-11T11:24:50.0109020Z                 url=url,
2026-01-11T11:24:50.0109215Z                 body=request.body,
2026-01-11T11:24:50.0109445Z                 headers=request.headers,
2026-01-11T11:24:50.0109676Z                 redirect=False,
2026-01-11T11:24:50.0109894Z                 assert_same_host=False,
2026-01-11T11:24:50.0110264Z                 preload_content=False,
2026-01-11T11:24:50.0110495Z                 decode_content=False,
2026-01-11T11:24:50.0110731Z                 retries=self.max_retries,
2026-01-11T11:24:50.0110963Z                 timeout=timeout,
2026-01-11T11:24:50.0111173Z                 chunked=chunked,
2026-01-11T11:24:50.0111366Z             )
2026-01-11T11:24:50.0111518Z     
2026-01-11T11:24:50.0111697Z         except (ProtocolError, OSError) as err:
2026-01-11T11:24:50.0111995Z             raise ConnectionError(err, request=request)
2026-01-11T11:24:50.0112247Z     
2026-01-11T11:24:50.0112411Z         except MaxRetryError as e:
2026-01-11T11:24:50.0112682Z             if isinstance(e.reason, ConnectTimeoutError):
2026-01-11T11:24:50.0112982Z                 # TODO: Remove this in 3.0.0: see #2811
2026-01-11T11:24:50.0113287Z                 if not isinstance(e.reason, NewConnectionError):
2026-01-11T11:24:50.0113610Z                     raise ConnectTimeout(e, request=request)
2026-01-11T11:24:50.0113999Z     
2026-01-11T11:24:50.0114284Z             if isinstance(e.reason, ResponseError):
2026-01-11T11:24:50.0114604Z                 raise RetryError(e, request=request)
2026-01-11T11:24:50.0114843Z     
2026-01-11T11:24:50.0115019Z             if isinstance(e.reason, _ProxyError):
2026-01-11T11:24:50.0115299Z                 raise ProxyError(e, request=request)
2026-01-11T11:24:50.0115535Z     
2026-01-11T11:24:50.0115710Z             if isinstance(e.reason, _SSLError):
2026-01-11T11:24:50.0115997Z                 # This branch is for urllib3 v1.22 and later.
2026-01-11T11:24:50.0116291Z                 raise SSLError(e, request=request)
2026-01-11T11:24:50.0116527Z     
2026-01-11T11:24:50.0116712Z >           raise ConnectionError(e, request=request)
2026-01-11T11:24:50.0117890Z E           requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8070): Max retries exceeded with url: /api/version (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f0415e10>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:50.0118982Z 
2026-01-11T11:24:50.0119303Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:519: ConnectionError
2026-01-11T11:24:50.0119877Z ----------------------------- Captured stdout call -----------------------------
2026-01-11T11:24:50.0120140Z 
2026-01-11T11:24:50.0120221Z === Testing Docker Services ===
2026-01-11T11:24:50.0120445Z 1. Testing GROBID service...
2026-01-11T11:24:50.0120764Z _____________________ TestPhDPipeline.test_frontend_loads ______________________
2026-01-11T11:24:50.0121037Z 
2026-01-11T11:24:50.0121210Z self = <urllib3.connection.HTTPConnection object at 0x7f29f054c520>
2026-01-11T11:24:50.0121478Z 
2026-01-11T11:24:50.0121569Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:50.0121900Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:50.0122212Z     
2026-01-11T11:24:50.0122381Z         :return: New socket connection.
2026-01-11T11:24:50.0122606Z         """
2026-01-11T11:24:50.0122759Z         try:
2026-01-11T11:24:50.0122943Z >           sock = connection.create_connection(
2026-01-11T11:24:50.0123219Z                 (self._dns_host, self.port),
2026-01-11T11:24:50.0123459Z                 self.timeout,
2026-01-11T11:24:50.0123693Z                 source_address=self.source_address,
2026-01-11T11:24:50.0123965Z                 socket_options=self.socket_options,
2026-01-11T11:24:50.0124400Z             )
2026-01-11T11:24:50.0124500Z 
2026-01-11T11:24:50.0124776Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:198: 
2026-01-11T11:24:50.0125258Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0125821Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:85: in create_connection
2026-01-11T11:24:50.0126330Z     raise err
2026-01-11T11:24:50.0126678Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0126895Z 
2026-01-11T11:24:50.0127044Z address = ('localhost', 3000), timeout = 10, source_address = None
2026-01-11T11:24:50.0127363Z socket_options = [(6, 1, 1)]
2026-01-11T11:24:50.0127501Z 
2026-01-11T11:24:50.0127581Z     def create_connection(
2026-01-11T11:24:50.0127787Z         address: tuple[str, int],
2026-01-11T11:24:50.0128036Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:50.0128329Z         source_address: tuple[str, int] | None = None,
2026-01-11T11:24:50.0128649Z         socket_options: _TYPE_SOCKET_OPTIONS | None = None,
2026-01-11T11:24:50.0128930Z     ) -> socket.socket:
2026-01-11T11:24:50.0129174Z         """Connect to *address* and return the socket object.
2026-01-11T11:24:50.0129512Z     
2026-01-11T11:24:50.0129818Z         Convenience function.  Connect to *address* (a 2-tuple ``(host,
2026-01-11T11:24:50.0134897Z         port)``) and return the socket object.  Passing the optional
2026-01-11T11:24:50.0135540Z         *timeout* parameter will set the timeout on the socket instance
2026-01-11T11:24:50.0135973Z         before attempting to connect.  If no *timeout* is supplied, the
2026-01-11T11:24:50.0136429Z         global default timeout setting returned by :func:`socket.getdefaulttimeout`
2026-01-11T11:24:50.0136918Z         is used.  If *source_address* is set it must be a tuple of (host, port)
2026-01-11T11:24:50.0137365Z         for the socket to bind as a source address before making the connection.
2026-01-11T11:24:50.0137768Z         An host of '' or port 0 tells the OS to use the default.
2026-01-11T11:24:50.0138048Z         """
2026-01-11T11:24:50.0138192Z     
2026-01-11T11:24:50.0138348Z         host, port = address
2026-01-11T11:24:50.0138565Z         if host.startswith("["):
2026-01-11T11:24:50.0138789Z             host = host.strip("[]")
2026-01-11T11:24:50.0139003Z         err = None
2026-01-11T11:24:50.0139174Z     
2026-01-11T11:24:50.0139454Z         # Using the value from allowed_gai_family() in the context of getaddrinfo lets
2026-01-11T11:24:50.0139942Z         # us select whether to work with IPv4 DNS records, IPv6 records, or both.
2026-01-11T11:24:50.0140391Z         # The original create_connection function always returns all records.
2026-01-11T11:24:50.0140736Z         family = allowed_gai_family()
2026-01-11T11:24:50.0140952Z     
2026-01-11T11:24:50.0141087Z         try:
2026-01-11T11:24:50.0141255Z             host.encode("idna")
2026-01-11T11:24:50.0141469Z         except UnicodeError:
2026-01-11T11:24:50.0141799Z             raise LocationParseError(f"'{host}', label empty or too long") from None
2026-01-11T11:24:50.0142148Z     
2026-01-11T11:24:50.0142398Z         for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
2026-01-11T11:24:50.0142776Z             af, socktype, proto, canonname, sa = res
2026-01-11T11:24:50.0143028Z             sock = None
2026-01-11T11:24:50.0143207Z             try:
2026-01-11T11:24:50.0143421Z                 sock = socket.socket(af, socktype, proto)
2026-01-11T11:24:50.0143677Z     
2026-01-11T11:24:50.0143901Z                 # If provided, set socket level options before connecting.
2026-01-11T11:24:50.0144463Z                 _set_socket_options(sock, socket_options)
2026-01-11T11:24:50.0144722Z     
2026-01-11T11:24:50.0144893Z                 if timeout is not _DEFAULT_TIMEOUT:
2026-01-11T11:24:50.0145164Z                     sock.settimeout(timeout)
2026-01-11T11:24:50.0145407Z                 if source_address:
2026-01-11T11:24:50.0145638Z                     sock.bind(source_address)
2026-01-11T11:24:50.0145874Z >               sock.connect(sa)
2026-01-11T11:24:50.0146165Z E               ConnectionRefusedError: [Errno 111] Connection refused
2026-01-11T11:24:50.0146408Z 
2026-01-11T11:24:50.0146781Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:73: ConnectionRefusedError
2026-01-11T11:24:50.0147252Z 
2026-01-11T11:24:50.0147561Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:50.0147838Z 
2026-01-11T11:24:50.0148046Z self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f054c2e0>
2026-01-11T11:24:50.0148423Z method = 'GET', url = '/', body = None
2026-01-11T11:24:50.0148950Z headers = {'User-Agent': 'python-requests/2.31.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': '*/*', 'Connection': 'keep-alive'}
2026-01-11T11:24:50.0149601Z retries = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:50.0149977Z redirect = False, assert_same_host = False
2026-01-11T11:24:50.0150321Z timeout = Timeout(connect=10, read=10, total=None), pool_timeout = None
2026-01-11T11:24:50.0150774Z release_conn = False, chunked = False, body_pos = None, preload_content = False
2026-01-11T11:24:50.0151149Z decode_content = False, response_kw = {}
2026-01-11T11:24:50.0151566Z parsed_url = Url(scheme=None, auth=None, host=None, port=None, path='/', query=None, fragment=None)
2026-01-11T11:24:50.0152208Z destination_scheme = None, conn = None, release_this_conn = True
2026-01-11T11:24:50.0152603Z http_tunnel_required = False, err = None, clean_exit = False
2026-01-11T11:24:50.0152838Z 
2026-01-11T11:24:50.0152930Z     def urlopen(  # type: ignore[override]
2026-01-11T11:24:50.0153164Z         self,
2026-01-11T11:24:50.0153322Z         method: str,
2026-01-11T11:24:50.0153495Z         url: str,
2026-01-11T11:24:50.0153671Z         body: _TYPE_BODY | None = None,
2026-01-11T11:24:50.0153948Z         headers: typing.Mapping[str, str] | None = None,
2026-01-11T11:24:50.0154349Z         retries: Retry | bool | int | None = None,
2026-01-11T11:24:50.0154428Z         redirect: bool = True,
2026-01-11T11:24:50.0154510Z         assert_same_host: bool = True,
2026-01-11T11:24:50.0154606Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:50.0154693Z         pool_timeout: int | None = None,
2026-01-11T11:24:50.0154774Z         release_conn: bool | None = None,
2026-01-11T11:24:50.0154857Z         chunked: bool = False,
2026-01-11T11:24:50.0154970Z         body_pos: _TYPE_BODY_POSITION | None = None,
2026-01-11T11:24:50.0155054Z         preload_content: bool = True,
2026-01-11T11:24:50.0155134Z         decode_content: bool = True,
2026-01-11T11:24:50.0155220Z         **response_kw: typing.Any,
2026-01-11T11:24:50.0155300Z     ) -> BaseHTTPResponse:
2026-01-11T11:24:50.0155359Z         """
2026-01-11T11:24:50.0155548Z         Get a connection from the pool and perform an HTTP request. This is the
2026-01-11T11:24:50.0155721Z         lowest level call for making a request, so you'll need to specify all
2026-01-11T11:24:50.0155791Z         the raw details.
2026-01-11T11:24:50.0155848Z     
2026-01-11T11:24:50.0155932Z         .. note::
2026-01-11T11:24:50.0155990Z     
2026-01-11T11:24:50.0156146Z            More commonly, it's appropriate to use a convenience method
2026-01-11T11:24:50.0156228Z            such as :meth:`request`.
2026-01-11T11:24:50.0156284Z     
2026-01-11T11:24:50.0156354Z         .. note::
2026-01-11T11:24:50.0156410Z     
2026-01-11T11:24:50.0156535Z            `release_conn` will only behave as expected if
2026-01-11T11:24:50.0156648Z            `preload_content=False` because we want to make
2026-01-11T11:24:50.0156815Z            `preload_content=False` the default behaviour someday soon without
2026-01-11T11:24:50.0156914Z            breaking backwards compatibility.
2026-01-11T11:24:50.0156972Z     
2026-01-11T11:24:50.0157040Z         :param method:
2026-01-11T11:24:50.0157163Z             HTTP request method (such as GET, POST, PUT, etc.)
2026-01-11T11:24:50.0157225Z     
2026-01-11T11:24:50.0157289Z         :param url:
2026-01-11T11:24:50.0157380Z             The URL to perform the request on.
2026-01-11T11:24:50.0157443Z     
2026-01-11T11:24:50.0157508Z         :param body:
2026-01-11T11:24:50.0157678Z             Data to send in the request body, either :class:`str`, :class:`bytes`,
2026-01-11T11:24:50.0157842Z             an iterable of :class:`str`/:class:`bytes`, or a file-like object.
2026-01-11T11:24:50.0158022Z     
2026-01-11T11:24:50.0158092Z         :param headers:
2026-01-11T11:24:50.0158240Z             Dictionary of custom headers to send, such as User-Agent,
2026-01-11T11:24:50.0158411Z             If-None-Match, etc. If None, pool headers are used. If provided,
2026-01-11T11:24:50.0158566Z             these headers completely replace any pool-specific headers.
2026-01-11T11:24:50.0158623Z     
2026-01-11T11:24:50.0158697Z         :param retries:
2026-01-11T11:24:50.0158838Z             Configure the number of retries to allow before raising a
2026-01-11T11:24:50.0158982Z             :class:`~urllib3.exceptions.MaxRetryError` exception.
2026-01-11T11:24:50.0159051Z     
2026-01-11T11:24:50.0159226Z             If ``None`` (default) will retry 3 times, see ``Retry.DEFAULT``. Pass a
2026-01-11T11:24:50.0159397Z             :class:`~urllib3.util.retry.Retry` object for fine-grained control
2026-01-11T11:24:50.0159484Z             over different types of retries.
2026-01-11T11:24:50.0159777Z             Pass an integer number to retry connection errors that many times,
2026-01-11T11:24:50.0159913Z             but no other types of errors. Pass zero to never retry.
2026-01-11T11:24:50.0159971Z     
2026-01-11T11:24:50.0160138Z             If ``False``, then retries are disabled and any exception is raised
2026-01-11T11:24:50.0160312Z             immediately. Also, instead of raising a MaxRetryError on redirects,
2026-01-11T11:24:50.0160410Z             the redirect response will be returned.
2026-01-11T11:24:50.0160470Z     
2026-01-11T11:24:50.0160639Z         :type retries: :class:`~urllib3.util.retry.Retry`, False, or an int.
2026-01-11T11:24:50.0160695Z     
2026-01-11T11:24:50.0160766Z         :param redirect:
2026-01-11T11:24:50.0160926Z             If True, automatically handle redirects (status codes 301, 302,
2026-01-11T11:24:50.0161077Z             303, 307, 308). Each redirect counts as a retry. Disabling retries
2026-01-11T11:24:50.0161162Z             will disable redirect, too.
2026-01-11T11:24:50.0161231Z     
2026-01-11T11:24:50.0161309Z         :param assert_same_host:
2026-01-11T11:24:50.0161458Z             If ``True``, will make sure that the host of the pool requests is
2026-01-11T11:24:50.0161637Z             consistent else will raise HostChangedError. When ``False``, you can
2026-01-11T11:24:50.0161777Z             use the pool on an HTTP proxy and request foreign hosts.
2026-01-11T11:24:50.0161837Z     
2026-01-11T11:24:50.0161906Z         :param timeout:
2026-01-11T11:24:50.0162046Z             If specified, overrides the default timeout for this one
2026-01-11T11:24:50.0162185Z             request. It may be a float (in seconds) or an instance of
2026-01-11T11:24:50.0162274Z             :class:`urllib3.util.Timeout`.
2026-01-11T11:24:50.0162337Z     
2026-01-11T11:24:50.0162411Z         :param pool_timeout:
2026-01-11T11:24:50.0162563Z             If set and the pool is set to block=True, then this method will
2026-01-11T11:24:50.0162737Z             block for ``pool_timeout`` seconds and raise EmptyPoolError if no
2026-01-11T11:24:50.0162858Z             connection is available within the time period.
2026-01-11T11:24:50.0162917Z     
2026-01-11T11:24:50.0162997Z         :param bool preload_content:
2026-01-11T11:24:50.0163146Z             If True, the response's body will be preloaded into memory.
2026-01-11T11:24:50.0163203Z     
2026-01-11T11:24:50.0163284Z         :param bool decode_content:
2026-01-11T11:24:50.0163416Z             If True, will attempt to decode the body based on the
2026-01-11T11:24:50.0163499Z             'content-encoding' header.
2026-01-11T11:24:50.0163559Z     
2026-01-11T11:24:50.0163632Z         :param release_conn:
2026-01-11T11:24:50.0163789Z             If False, then the urlopen call will not release the connection
2026-01-11T11:24:50.0163954Z             back into the pool once a response is received (but will release if
2026-01-11T11:24:50.0164293Z             you read the entire contents of the response such as when
2026-01-11T11:24:50.0164601Z             `preload_content=True`). This is useful if you're not preloading
2026-01-11T11:24:50.0164738Z             the response's content immediately. You will need to call
2026-01-11T11:24:50.0164900Z             ``r.release_conn()`` on the response ``r`` to return the connection
2026-01-11T11:24:50.0165077Z             back into the pool. If None, it takes the value of ``preload_content``
2026-01-11T11:24:50.0165157Z             which defaults to ``True``.
2026-01-11T11:24:50.0165214Z     
2026-01-11T11:24:50.0165292Z         :param bool chunked:
2026-01-11T11:24:50.0165431Z             If True, urllib3 will send the body using chunked transfer
2026-01-11T11:24:50.0165599Z             encoding. Otherwise, urllib3 will send the body using the standard
2026-01-11T11:24:50.0165700Z             content-length form. Defaults to False.
2026-01-11T11:24:50.0165763Z     
2026-01-11T11:24:50.0165836Z         :param int body_pos:
2026-01-11T11:24:50.0165998Z             Position to seek to in file-like body in the event of a retry or
2026-01-11T11:24:50.0166274Z             redirect. Typically this won't need to be set because urllib3 will
2026-01-11T11:24:50.0166370Z             auto-populate the value when needed.
2026-01-11T11:24:50.0166433Z         """
2026-01-11T11:24:50.0166511Z         parsed_url = parse_url(url)
2026-01-11T11:24:50.0166608Z         destination_scheme = parsed_url.scheme
2026-01-11T11:24:50.0166667Z     
2026-01-11T11:24:50.0166737Z         if headers is None:
2026-01-11T11:24:50.0166818Z             headers = self.headers
2026-01-11T11:24:50.0166875Z     
2026-01-11T11:24:50.0166960Z         if not isinstance(retries, Retry):
2026-01-11T11:24:50.0167159Z             retries = Retry.from_int(retries, redirect=redirect, default=self.retries)
2026-01-11T11:24:50.0167217Z     
2026-01-11T11:24:50.0167293Z         if release_conn is None:
2026-01-11T11:24:50.0167374Z             release_conn = preload_content
2026-01-11T11:24:50.0167441Z     
2026-01-11T11:24:50.0167510Z         # Check host
2026-01-11T11:24:50.0167631Z         if assert_same_host and not self.is_same_host(url):
2026-01-11T11:24:50.0167742Z             raise HostChangedError(self, url, retries)
2026-01-11T11:24:50.0167800Z     
2026-01-11T11:24:50.0167944Z         # Ensure that the URL we're connecting to is properly encoded
2026-01-11T11:24:50.0168024Z         if url.startswith("/"):
2026-01-11T11:24:50.0168117Z             url = to_str(_encode_target(url))
2026-01-11T11:24:50.0168178Z         else:
2026-01-11T11:24:50.0168258Z             url = to_str(parsed_url.url)
2026-01-11T11:24:50.0168319Z     
2026-01-11T11:24:50.0168383Z         conn = None
2026-01-11T11:24:50.0168439Z     
2026-01-11T11:24:50.0168554Z         # Track whether `conn` needs to be released before
2026-01-11T11:24:50.0168738Z         # returning/raising/recursing. Update this variable if necessary, and
2026-01-11T11:24:50.0168907Z         # leave `release_conn` constant throughout the function. That way, if
2026-01-11T11:24:50.0169080Z         # the function recurses, the original value of `release_conn` will be
2026-01-11T11:24:50.0169266Z         # passed down into the recursive call, and its value will be respected.
2026-01-11T11:24:50.0169325Z         #
2026-01-11T11:24:50.0169405Z         # See issue #651 [1] for details.
2026-01-11T11:24:50.0169469Z         #
2026-01-11T11:24:50.0169599Z         # [1] <https://github.com/urllib3/urllib3/issues/651>
2026-01-11T11:24:50.0169682Z         release_this_conn = release_conn
2026-01-11T11:24:50.0169739Z     
2026-01-11T11:24:50.0169878Z         http_tunnel_required = connection_requires_http_tunnel(
2026-01-11T11:24:50.0170002Z             self.proxy, self.proxy_config, destination_scheme
2026-01-11T11:24:50.0170060Z         )
2026-01-11T11:24:50.0170120Z     
2026-01-11T11:24:50.0170282Z         # Merge the proxy headers. Only done when not using HTTP CONNECT. We
2026-01-11T11:24:50.0170452Z         # have to copy the headers dict so we can safely change it without those
2026-01-11T11:24:50.0170662Z         # changes being reflected in anyone else's copy.
2026-01-11T11:24:50.0170743Z         if not http_tunnel_required:
2026-01-11T11:24:50.0170879Z             headers = headers.copy()  # type: ignore[attr-defined]
2026-01-11T11:24:50.0171042Z             headers.update(self.proxy_headers)  # type: ignore[union-attr]
2026-01-11T11:24:50.0171106Z     
2026-01-11T11:24:50.0171280Z         # Must keep the exception bound to a separate variable or else Python 3
2026-01-11T11:24:50.0171372Z         # complains about UnboundLocalError.
2026-01-11T11:24:50.0171439Z         err = None
2026-01-11T11:24:50.0171496Z     
2026-01-11T11:24:50.0171648Z         # Keep track of whether we cleanly exited the except block. This
2026-01-11T11:24:50.0171753Z         # ensures we do proper cleanup in finally.
2026-01-11T11:24:50.0171825Z         clean_exit = False
2026-01-11T11:24:50.0171881Z     
2026-01-11T11:24:50.0172023Z         # Rewind body position, if needed. Record current position
2026-01-11T11:24:50.0172235Z         # for future rewinds in the event of a redirect/retry.
2026-01-11T11:24:50.0172342Z         body_pos = set_file_position(body, body_pos)
2026-01-11T11:24:50.0172399Z     
2026-01-11T11:24:50.0172467Z         try:
2026-01-11T11:24:50.0172563Z             # Request a connection from the queue.
2026-01-11T11:24:50.0172661Z             timeout_obj = self._get_timeout(timeout)
2026-01-11T11:24:50.0172765Z             conn = self._get_conn(timeout=pool_timeout)
2026-01-11T11:24:50.0172826Z     
2026-01-11T11:24:50.0173011Z             conn.timeout = timeout_obj.connect_timeout  # type: ignore[assignment]
2026-01-11T11:24:50.0173069Z     
2026-01-11T11:24:50.0173238Z             # Is this a closed/new connection that requires CONNECT tunnelling?
2026-01-11T11:24:50.0173411Z             if self.proxy is not None and http_tunnel_required and conn.is_closed:
2026-01-11T11:24:50.0173476Z                 try:
2026-01-11T11:24:50.0173568Z                     self._prepare_proxy(conn)
2026-01-11T11:24:50.0173712Z                 except (BaseSSLError, OSError, SocketTimeout) as e:
2026-01-11T11:24:50.0173789Z                     self._raise_timeout(
2026-01-11T11:24:50.0173927Z                         err=e, url=self.proxy.url, timeout_value=conn.timeout
2026-01-11T11:24:50.0173990Z                     )
2026-01-11T11:24:50.0174156Z                     raise
2026-01-11T11:24:50.0174216Z     
2026-01-11T11:24:50.0174366Z             # If we're going to release the connection in ``finally:``, then
2026-01-11T11:24:50.0174530Z             # the response doesn't need to know about the connection. Otherwise
2026-01-11T11:24:50.0174676Z             # it will also try to release it and we'll have a double-release
2026-01-11T11:24:50.0174741Z             # mess.
2026-01-11T11:24:50.0174866Z             response_conn = conn if not release_conn else None
2026-01-11T11:24:50.0174923Z     
2026-01-11T11:24:50.0175038Z             # Make the request on the HTTPConnection object
2026-01-11T11:24:50.0175130Z >           response = self._make_request(
2026-01-11T11:24:50.0175200Z                 conn,
2026-01-11T11:24:50.0175267Z                 method,
2026-01-11T11:24:50.0175334Z                 url,
2026-01-11T11:24:50.0175412Z                 timeout=timeout_obj,
2026-01-11T11:24:50.0175478Z                 body=body,
2026-01-11T11:24:50.0175550Z                 headers=headers,
2026-01-11T11:24:50.0175624Z                 chunked=chunked,
2026-01-11T11:24:50.0175693Z                 retries=retries,
2026-01-11T11:24:50.0175782Z                 response_conn=response_conn,
2026-01-11T11:24:50.0175881Z                 preload_content=preload_content,
2026-01-11T11:24:50.0175969Z                 decode_content=decode_content,
2026-01-11T11:24:50.0176041Z                 **response_kw,
2026-01-11T11:24:50.0176106Z             )
2026-01-11T11:24:50.0176111Z 
2026-01-11T11:24:50.0176399Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:787: 
2026-01-11T11:24:50.0176643Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0176981Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:493: in _make_request
2026-01-11T11:24:50.0177054Z     conn.request(
2026-01-11T11:24:50.0177341Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:445: in request
2026-01-11T11:24:50.0177414Z     self.endheaders()
2026-01-11T11:24:50.0177644Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1278: in endheaders
2026-01-11T11:24:50.0177795Z     self._send_output(message_body, encode_chunked=encode_chunked)
2026-01-11T11:24:50.0178028Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1038: in _send_output
2026-01-11T11:24:50.0178098Z     self.send(msg)
2026-01-11T11:24:50.0178300Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:976: in send
2026-01-11T11:24:50.0178367Z     self.connect()
2026-01-11T11:24:50.0178786Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:276: in connect
2026-01-11T11:24:50.0178867Z     self.sock = self._new_conn()
2026-01-11T11:24:50.0178987Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0178992Z 
2026-01-11T11:24:50.0179169Z self = <urllib3.connection.HTTPConnection object at 0x7f29f054c520>
2026-01-11T11:24:50.0179174Z 
2026-01-11T11:24:50.0179264Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:50.0179425Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:50.0179483Z     
2026-01-11T11:24:50.0179570Z         :return: New socket connection.
2026-01-11T11:24:50.0179629Z         """
2026-01-11T11:24:50.0179688Z         try:
2026-01-11T11:24:50.0179791Z             sock = connection.create_connection(
2026-01-11T11:24:50.0179878Z                 (self._dns_host, self.port),
2026-01-11T11:24:50.0179950Z                 self.timeout,
2026-01-11T11:24:50.0180060Z                 source_address=self.source_address,
2026-01-11T11:24:50.0180154Z                 socket_options=self.socket_options,
2026-01-11T11:24:50.0180213Z             )
2026-01-11T11:24:50.0180297Z         except socket.gaierror as e:
2026-01-11T11:24:50.0180435Z             raise NameResolutionError(self.host, self, e) from e
2026-01-11T11:24:50.0180518Z         except SocketTimeout as e:
2026-01-11T11:24:50.0180607Z             raise ConnectTimeoutError(
2026-01-11T11:24:50.0180675Z                 self,
2026-01-11T11:24:50.0180876Z                 f"Connection to {self.host} timed out. (connect timeout={self.timeout})",
2026-01-11T11:24:50.0180939Z             ) from e
2026-01-11T11:24:50.0180998Z     
2026-01-11T11:24:50.0181079Z         except OSError as e:
2026-01-11T11:24:50.0181164Z >           raise NewConnectionError(
2026-01-11T11:24:50.0181290Z                 self, f"Failed to establish a new connection: {e}"
2026-01-11T11:24:50.0181360Z             ) from e
2026-01-11T11:24:50.0181933Z E           urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f29f054c520>: Failed to establish a new connection: [Errno 111] Connection refused
2026-01-11T11:24:50.0181941Z 
2026-01-11T11:24:50.0182270Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:213: NewConnectionError
2026-01-11T11:24:50.0182275Z 
2026-01-11T11:24:50.0182450Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:50.0182456Z 
2026-01-11T11:24:50.0182614Z self = <requests.adapters.HTTPAdapter object at 0x7f29f054f3a0>
2026-01-11T11:24:50.0182727Z request = <PreparedRequest [GET]>, stream = False
2026-01-11T11:24:50.0182917Z timeout = Timeout(connect=10, read=10, total=None), verify = True, cert = None
2026-01-11T11:24:50.0182993Z proxies = OrderedDict()
2026-01-11T11:24:50.0182998Z 
2026-01-11T11:24:50.0183058Z     def send(
2026-01-11T11:24:50.0183270Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:50.0183447Z     ):
2026-01-11T11:24:50.0183590Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:50.0183650Z     
2026-01-11T11:24:50.0183844Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:50.0184003Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:50.0184357Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:50.0184522Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:50.0184612Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:50.0184744Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:50.0184944Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:50.0185116Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:50.0185340Z             must be a path to a CA bundle to use
2026-01-11T11:24:50.0185526Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:50.0185712Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:50.0185793Z         :rtype: requests.Response
2026-01-11T11:24:50.0185857Z         """
2026-01-11T11:24:50.0185913Z     
2026-01-11T11:24:50.0185973Z         try:
2026-01-11T11:24:50.0186095Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:50.0186189Z         except LocationValueError as e:
2026-01-11T11:24:50.0186280Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:50.0186337Z     
2026-01-11T11:24:50.0186462Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:50.0186558Z         url = self.request_url(request, proxies)
2026-01-11T11:24:50.0186630Z         self.add_headers(
2026-01-11T11:24:50.0186693Z             request,
2026-01-11T11:24:50.0186778Z             stream=stream,
2026-01-11T11:24:50.0186850Z             timeout=timeout,
2026-01-11T11:24:50.0186917Z             verify=verify,
2026-01-11T11:24:50.0186986Z             cert=cert,
2026-01-11T11:24:50.0187059Z             proxies=proxies,
2026-01-11T11:24:50.0187119Z         )
2026-01-11T11:24:50.0187177Z     
2026-01-11T11:24:50.0187377Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:50.0187435Z     
2026-01-11T11:24:50.0187519Z         if isinstance(timeout, tuple):
2026-01-11T11:24:50.0187585Z             try:
2026-01-11T11:24:50.0187663Z                 connect, read = timeout
2026-01-11T11:24:50.0187794Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:50.0187870Z             except ValueError:
2026-01-11T11:24:50.0187951Z                 raise ValueError(
2026-01-11T11:24:50.0188135Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:50.0188291Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:50.0188354Z                 )
2026-01-11T11:24:50.0188453Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:50.0188514Z             pass
2026-01-11T11:24:50.0188577Z         else:
2026-01-11T11:24:50.0188707Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:50.0188764Z     
2026-01-11T11:24:50.0188824Z         try:
2026-01-11T11:24:50.0188905Z >           resp = conn.urlopen(
2026-01-11T11:24:50.0188985Z                 method=request.method,
2026-01-11T11:24:50.0189052Z                 url=url,
2026-01-11T11:24:50.0189132Z                 body=request.body,
2026-01-11T11:24:50.0189214Z                 headers=request.headers,
2026-01-11T11:24:50.0189285Z                 redirect=False,
2026-01-11T11:24:50.0189361Z                 assert_same_host=False,
2026-01-11T11:24:50.0189443Z                 preload_content=False,
2026-01-11T11:24:50.0189643Z                 decode_content=False,
2026-01-11T11:24:50.0189729Z                 retries=self.max_retries,
2026-01-11T11:24:50.0189806Z                 timeout=timeout,
2026-01-11T11:24:50.0189876Z                 chunked=chunked,
2026-01-11T11:24:50.0189934Z             )
2026-01-11T11:24:50.0189939Z 
2026-01-11T11:24:50.0190207Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:486: 
2026-01-11T11:24:50.0190327Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0190640Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:841: in urlopen
2026-01-11T11:24:50.0190724Z     retries = retries.increment(
2026-01-11T11:24:50.0190841Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0190847Z 
2026-01-11T11:24:50.0191023Z self = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:50.0191117Z method = 'GET', url = '/', response = None
2026-01-11T11:24:50.0191709Z error = NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f054c520>: Failed to establish a new connection: [Errno 111] Connection refused')
2026-01-11T11:24:50.0191914Z _pool = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f054c2e0>
2026-01-11T11:24:50.0192023Z _stacktrace = <traceback object at 0x7f29f0345d80>
2026-01-11T11:24:50.0192033Z 
2026-01-11T11:24:50.0192097Z     def increment(
2026-01-11T11:24:50.0192155Z         self,
2026-01-11T11:24:50.0192234Z         method: str | None = None,
2026-01-11T11:24:50.0192312Z         url: str | None = None,
2026-01-11T11:24:50.0192414Z         response: BaseHTTPResponse | None = None,
2026-01-11T11:24:50.0192494Z         error: Exception | None = None,
2026-01-11T11:24:50.0192591Z         _pool: ConnectionPool | None = None,
2026-01-11T11:24:50.0192687Z         _stacktrace: TracebackType | None = None,
2026-01-11T11:24:50.0192751Z     ) -> Self:
2026-01-11T11:24:50.0192902Z         """Return a new Retry object with incremented retry counters.
2026-01-11T11:24:50.0192970Z     
2026-01-11T11:24:50.0193137Z         :param response: A response object, or None, if the server did not
2026-01-11T11:24:50.0193212Z             return a response.
2026-01-11T11:24:50.0193375Z         :type response: :class:`~urllib3.response.BaseHTTPResponse`
2026-01-11T11:24:50.0193547Z         :param Exception error: An error encountered during the request, or
2026-01-11T11:24:50.0193665Z             None if the response was received successfully.
2026-01-11T11:24:50.0193726Z     
2026-01-11T11:24:50.0193805Z         :return: A new ``Retry`` object.
2026-01-11T11:24:50.0193863Z         """
2026-01-11T11:24:50.0193946Z         if self.total is False and error:
2026-01-11T11:24:50.0194158Z             # Disabled, indicate to re-raise the error.
2026-01-11T11:24:50.0194275Z             raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:50.0194335Z     
2026-01-11T11:24:50.0194415Z         total = self.total
2026-01-11T11:24:50.0194494Z         if total is not None:
2026-01-11T11:24:50.0194565Z             total -= 1
2026-01-11T11:24:50.0194622Z     
2026-01-11T11:24:50.0194701Z         connect = self.connect
2026-01-11T11:24:50.0194768Z         read = self.read
2026-01-11T11:24:50.0194843Z         redirect = self.redirect
2026-01-11T11:24:50.0194924Z         status_count = self.status
2026-01-11T11:24:50.0194993Z         other = self.other
2026-01-11T11:24:50.0195062Z         cause = "unknown"
2026-01-11T11:24:50.0195127Z         status = None
2026-01-11T11:24:50.0195207Z         redirect_location = None
2026-01-11T11:24:50.0195264Z     
2026-01-11T11:24:50.0195373Z         if error and self._is_connection_error(error):
2026-01-11T11:24:50.0195450Z             # Connect retry?
2026-01-11T11:24:50.0195521Z             if connect is False:
2026-01-11T11:24:50.0195638Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:50.0195717Z             elif connect is not None:
2026-01-11T11:24:50.0195952Z                 connect -= 1
2026-01-11T11:24:50.0196009Z     
2026-01-11T11:24:50.0196106Z         elif error and self._is_read_error(error):
2026-01-11T11:24:50.0196179Z             # Read retry?
2026-01-11T11:24:50.0196369Z             if read is False or method is None or not self._is_method_retryable(method):
2026-01-11T11:24:50.0196484Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:50.0196562Z             elif read is not None:
2026-01-11T11:24:50.0196628Z                 read -= 1
2026-01-11T11:24:50.0196685Z     
2026-01-11T11:24:50.0196748Z         elif error:
2026-01-11T11:24:50.0196820Z             # Other retry?
2026-01-11T11:24:50.0196892Z             if other is not None:
2026-01-11T11:24:50.0196959Z                 other -= 1
2026-01-11T11:24:50.0197018Z     
2026-01-11T11:24:50.0197139Z         elif response and response.get_redirect_location():
2026-01-11T11:24:50.0197209Z             # Redirect retry?
2026-01-11T11:24:50.0197291Z             if redirect is not None:
2026-01-11T11:24:50.0197470Z                 redirect -= 1
2026-01-11T11:24:50.0197550Z             cause = "too many redirects"
2026-01-11T11:24:50.0197713Z             response_redirect_location = response.get_redirect_location()
2026-01-11T11:24:50.0197802Z             if response_redirect_location:
2026-01-11T11:24:50.0197917Z                 redirect_location = response_redirect_location
2026-01-11T11:24:50.0197995Z             status = response.status
2026-01-11T11:24:50.0198059Z     
2026-01-11T11:24:50.0198118Z         else:
2026-01-11T11:24:50.0198251Z             # Incrementing because of a server error like a 500 in
2026-01-11T11:24:50.0198415Z             # status_forcelist and the given method is in the allowed_methods
2026-01-11T11:24:50.0198511Z             cause = ResponseError.GENERIC_ERROR
2026-01-11T11:24:50.0198601Z             if response and response.status:
2026-01-11T11:24:50.0198689Z                 if status_count is not None:
2026-01-11T11:24:50.0198777Z                     status_count -= 1
2026-01-11T11:24:50.0198980Z                 cause = ResponseError.SPECIFIC_ERROR.format(status_code=response.status)
2026-01-11T11:24:50.0199059Z                 status = response.status
2026-01-11T11:24:50.0199118Z     
2026-01-11T11:24:50.0199194Z         history = self.history + (
2026-01-11T11:24:50.0199357Z             RequestHistory(method, url, error, status, redirect_location),
2026-01-11T11:24:50.0199420Z         )
2026-01-11T11:24:50.0199480Z     
2026-01-11T11:24:50.0199550Z         new_retry = self.new(
2026-01-11T11:24:50.0199618Z             total=total,
2026-01-11T11:24:50.0199693Z             connect=connect,
2026-01-11T11:24:50.0199757Z             read=read,
2026-01-11T11:24:50.0199828Z             redirect=redirect,
2026-01-11T11:24:50.0199907Z             status=status_count,
2026-01-11T11:24:50.0199974Z             other=other,
2026-01-11T11:24:50.0200043Z             history=history,
2026-01-11T11:24:50.0200104Z         )
2026-01-11T11:24:50.0200171Z     
2026-01-11T11:24:50.0200248Z         if new_retry.is_exhausted():
2026-01-11T11:24:50.0200347Z             reason = error or ResponseError(cause)
2026-01-11T11:24:50.0200560Z >           raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
2026-01-11T11:24:50.0201499Z E           urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f054c520>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:50.0201506Z 
2026-01-11T11:24:50.0201819Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/retry.py:519: MaxRetryError
2026-01-11T11:24:50.0201829Z 
2026-01-11T11:24:50.0201994Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0202000Z 
2026-01-11T11:24:50.0202161Z self = <test_phd_pipeline.TestPhDPipeline object at 0x7f2aec5b4a30>
2026-01-11T11:24:50.0202254Z 
2026-01-11T11:24:50.0202338Z     def test_frontend_loads(self):
2026-01-11T11:24:50.0202436Z         """Test frontend page loads correctly"""
2026-01-11T11:24:50.0202522Z         print("\n=== Testing Frontend ===")
2026-01-11T11:24:50.0202577Z     
2026-01-11T11:24:50.0202699Z >       response = requests.get(self.BASE_URL, timeout=10)
2026-01-11T11:24:50.0202704Z 
2026-01-11T11:24:50.0202804Z tests/integration/test_phd_pipeline.py:190: 
2026-01-11T11:24:50.0202923Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0203181Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:73: in get
2026-01-11T11:24:50.0203304Z     return request("get", url, params=params, **kwargs)
2026-01-11T11:24:50.0203570Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:59: in request
2026-01-11T11:24:50.0203710Z     return session.request(method=method, url=url, **kwargs)
2026-01-11T11:24:50.0204260Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:589: in request
2026-01-11T11:24:50.0204358Z     resp = self.send(prep, **send_kwargs)
2026-01-11T11:24:50.0204638Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:703: in send
2026-01-11T11:24:50.0204722Z     r = adapter.send(request, **kwargs)
2026-01-11T11:24:50.0204841Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0204847Z 
2026-01-11T11:24:50.0205006Z self = <requests.adapters.HTTPAdapter object at 0x7f29f054f3a0>
2026-01-11T11:24:50.0205115Z request = <PreparedRequest [GET]>, stream = False
2026-01-11T11:24:50.0205305Z timeout = Timeout(connect=10, read=10, total=None), verify = True, cert = None
2026-01-11T11:24:50.0205381Z proxies = OrderedDict()
2026-01-11T11:24:50.0205386Z 
2026-01-11T11:24:50.0205450Z     def send(
2026-01-11T11:24:50.0205657Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:50.0205725Z     ):
2026-01-11T11:24:50.0205871Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:50.0205928Z     
2026-01-11T11:24:50.0206123Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:50.0206284Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:50.0206445Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:50.0206599Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:50.0206686Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:50.0206819Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:50.0207013Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:50.0207187Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:50.0207291Z             must be a path to a CA bundle to use
2026-01-11T11:24:50.0207468Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:50.0207654Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:50.0207739Z         :rtype: requests.Response
2026-01-11T11:24:50.0207798Z         """
2026-01-11T11:24:50.0207855Z     
2026-01-11T11:24:50.0207913Z         try:
2026-01-11T11:24:50.0208037Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:50.0208126Z         except LocationValueError as e:
2026-01-11T11:24:50.0208216Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:50.0208277Z     
2026-01-11T11:24:50.0208397Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:50.0208491Z         url = self.request_url(request, proxies)
2026-01-11T11:24:50.0208565Z         self.add_headers(
2026-01-11T11:24:50.0208628Z             request,
2026-01-11T11:24:50.0208828Z             stream=stream,
2026-01-11T11:24:50.0208898Z             timeout=timeout,
2026-01-11T11:24:50.0208969Z             verify=verify,
2026-01-11T11:24:50.0209032Z             cert=cert,
2026-01-11T11:24:50.0209105Z             proxies=proxies,
2026-01-11T11:24:50.0209168Z         )
2026-01-11T11:24:50.0209224Z     
2026-01-11T11:24:50.0209419Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:50.0209476Z     
2026-01-11T11:24:50.0209564Z         if isinstance(timeout, tuple):
2026-01-11T11:24:50.0209623Z             try:
2026-01-11T11:24:50.0209699Z                 connect, read = timeout
2026-01-11T11:24:50.0209831Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:50.0209906Z             except ValueError:
2026-01-11T11:24:50.0209983Z                 raise ValueError(
2026-01-11T11:24:50.0210165Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:50.0210427Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:50.0210487Z                 )
2026-01-11T11:24:50.0210584Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:50.0210650Z             pass
2026-01-11T11:24:50.0210711Z         else:
2026-01-11T11:24:50.0210843Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:50.0210903Z     
2026-01-11T11:24:50.0210963Z         try:
2026-01-11T11:24:50.0211038Z             resp = conn.urlopen(
2026-01-11T11:24:50.0211116Z                 method=request.method,
2026-01-11T11:24:50.0211188Z                 url=url,
2026-01-11T11:24:50.0211262Z                 body=request.body,
2026-01-11T11:24:50.0211343Z                 headers=request.headers,
2026-01-11T11:24:50.0211418Z                 redirect=False,
2026-01-11T11:24:50.0211493Z                 assert_same_host=False,
2026-01-11T11:24:50.0211570Z                 preload_content=False,
2026-01-11T11:24:50.0211651Z                 decode_content=False,
2026-01-11T11:24:50.0211739Z                 retries=self.max_retries,
2026-01-11T11:24:50.0211816Z                 timeout=timeout,
2026-01-11T11:24:50.0211895Z                 chunked=chunked,
2026-01-11T11:24:50.0211967Z             )
2026-01-11T11:24:50.0212023Z     
2026-01-11T11:24:50.0212118Z         except (ProtocolError, OSError) as err:
2026-01-11T11:24:50.0212226Z             raise ConnectionError(err, request=request)
2026-01-11T11:24:50.0212284Z     
2026-01-11T11:24:50.0212364Z         except MaxRetryError as e:
2026-01-11T11:24:50.0212479Z             if isinstance(e.reason, ConnectTimeoutError):
2026-01-11T11:24:50.0212580Z                 # TODO: Remove this in 3.0.0: see #2811
2026-01-11T11:24:50.0212704Z                 if not isinstance(e.reason, NewConnectionError):
2026-01-11T11:24:50.0212812Z                     raise ConnectTimeout(e, request=request)
2026-01-11T11:24:50.0212872Z     
2026-01-11T11:24:50.0212972Z             if isinstance(e.reason, ResponseError):
2026-01-11T11:24:50.0213077Z                 raise RetryError(e, request=request)
2026-01-11T11:24:50.0213134Z     
2026-01-11T11:24:50.0213232Z             if isinstance(e.reason, _ProxyError):
2026-01-11T11:24:50.0213325Z                 raise ProxyError(e, request=request)
2026-01-11T11:24:50.0213381Z     
2026-01-11T11:24:50.0213474Z             if isinstance(e.reason, _SSLError):
2026-01-11T11:24:50.0213586Z                 # This branch is for urllib3 v1.22 and later.
2026-01-11T11:24:50.0213676Z                 raise SSLError(e, request=request)
2026-01-11T11:24:50.0213735Z     
2026-01-11T11:24:50.0213838Z >           raise ConnectionError(e, request=request)
2026-01-11T11:24:50.0214920Z E           requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f054c520>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:50.0215050Z 
2026-01-11T11:24:50.0215369Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:519: ConnectionError
2026-01-11T11:24:50.0215530Z ----------------------------- Captured stdout call -----------------------------
2026-01-11T11:24:50.0215535Z 
2026-01-11T11:24:50.0215607Z === Testing Frontend ===
2026-01-11T11:24:50.0215783Z _____________________ TestPhDPipeline.test_error_handling ______________________
2026-01-11T11:24:50.0215788Z 
2026-01-11T11:24:50.0215955Z self = <urllib3.connection.HTTPConnection object at 0x7f29f07d39d0>
2026-01-11T11:24:50.0215960Z 
2026-01-11T11:24:50.0216045Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:50.0216207Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:50.0216265Z     
2026-01-11T11:24:50.0216346Z         :return: New socket connection.
2026-01-11T11:24:50.0216404Z         """
2026-01-11T11:24:50.0216468Z         try:
2026-01-11T11:24:50.0216566Z >           sock = connection.create_connection(
2026-01-11T11:24:50.0216757Z                 (self._dns_host, self.port),
2026-01-11T11:24:50.0216833Z                 self.timeout,
2026-01-11T11:24:50.0216929Z                 source_address=self.source_address,
2026-01-11T11:24:50.0217022Z                 socket_options=self.socket_options,
2026-01-11T11:24:50.0217079Z             )
2026-01-11T11:24:50.0217088Z 
2026-01-11T11:24:50.0217350Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:198: 
2026-01-11T11:24:50.0217467Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0217813Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:85: in create_connection
2026-01-11T11:24:50.0217877Z     raise err
2026-01-11T11:24:50.0217989Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0217994Z 
2026-01-11T11:24:50.0218141Z address = ('localhost', 3000), timeout = 10, source_address = None
2026-01-11T11:24:50.0218227Z socket_options = [(6, 1, 1)]
2026-01-11T11:24:50.0218233Z 
2026-01-11T11:24:50.0218305Z     def create_connection(
2026-01-11T11:24:50.0218382Z         address: tuple[str, int],
2026-01-11T11:24:50.0218482Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:50.0218591Z         source_address: tuple[str, int] | None = None,
2026-01-11T11:24:50.0218714Z         socket_options: _TYPE_SOCKET_OPTIONS | None = None,
2026-01-11T11:24:50.0218792Z     ) -> socket.socket:
2026-01-11T11:24:50.0218913Z         """Connect to *address* and return the socket object.
2026-01-11T11:24:50.0218970Z     
2026-01-11T11:24:50.0219132Z         Convenience function.  Connect to *address* (a 2-tuple ``(host,
2026-01-11T11:24:50.0219280Z         port)``) and return the socket object.  Passing the optional
2026-01-11T11:24:50.0219434Z         *timeout* parameter will set the timeout on the socket instance
2026-01-11T11:24:50.0219594Z         before attempting to connect.  If no *timeout* is supplied, the
2026-01-11T11:24:50.0219807Z         global default timeout setting returned by :func:`socket.getdefaulttimeout`
2026-01-11T11:24:50.0219975Z         is used.  If *source_address* is set it must be a tuple of (host, port)
2026-01-11T11:24:50.0220146Z         for the socket to bind as a source address before making the connection.
2026-01-11T11:24:50.0220278Z         An host of '' or port 0 tells the OS to use the default.
2026-01-11T11:24:50.0220336Z         """
2026-01-11T11:24:50.0220393Z     
2026-01-11T11:24:50.0220465Z         host, port = address
2026-01-11T11:24:50.0220547Z         if host.startswith("["):
2026-01-11T11:24:50.0220625Z             host = host.strip("[]")
2026-01-11T11:24:50.0220688Z         err = None
2026-01-11T11:24:50.0220750Z     
2026-01-11T11:24:50.0220945Z         # Using the value from allowed_gai_family() in the context of getaddrinfo lets
2026-01-11T11:24:50.0221121Z         # us select whether to work with IPv4 DNS records, IPv6 records, or both.
2026-01-11T11:24:50.0221390Z         # The original create_connection function always returns all records.
2026-01-11T11:24:50.0221472Z         family = allowed_gai_family()
2026-01-11T11:24:50.0221529Z     
2026-01-11T11:24:50.0221588Z         try:
2026-01-11T11:24:50.0221665Z             host.encode("idna")
2026-01-11T11:24:50.0221740Z         except UnicodeError:
2026-01-11T11:24:50.0221935Z             raise LocationParseError(f"'{host}', label empty or too long") from None
2026-01-11T11:24:50.0221995Z     
2026-01-11T11:24:50.0222172Z         for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
2026-01-11T11:24:50.0222272Z             af, socktype, proto, canonname, sa = res
2026-01-11T11:24:50.0222342Z             sock = None
2026-01-11T11:24:50.0222401Z             try:
2026-01-11T11:24:50.0222510Z                 sock = socket.socket(af, socktype, proto)
2026-01-11T11:24:50.0222567Z     
2026-01-11T11:24:50.0222715Z                 # If provided, set socket level options before connecting.
2026-01-11T11:24:50.0222902Z                 _set_socket_options(sock, socket_options)
2026-01-11T11:24:50.0222958Z     
2026-01-11T11:24:50.0223055Z                 if timeout is not _DEFAULT_TIMEOUT:
2026-01-11T11:24:50.0223140Z                     sock.settimeout(timeout)
2026-01-11T11:24:50.0223214Z                 if source_address:
2026-01-11T11:24:50.0223298Z                     sock.bind(source_address)
2026-01-11T11:24:50.0223375Z >               sock.connect(sa)
2026-01-11T11:24:50.0223524Z E               ConnectionRefusedError: [Errno 111] Connection refused
2026-01-11T11:24:50.0223530Z 
2026-01-11T11:24:50.0223904Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/connection.py:73: ConnectionRefusedError
2026-01-11T11:24:50.0223910Z 
2026-01-11T11:24:50.0224272Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:50.0224281Z 
2026-01-11T11:24:50.0224486Z self = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f07d1f90>
2026-01-11T11:24:50.0224644Z method = 'POST', url = '/api/v2/agent/goal', body = 'invalid json'
2026-01-11T11:24:50.0225195Z headers = {'User-Agent': 'python-requests/2.31.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': '*/*', 'Connection': 'keep-alive', 'Content-Type': 'application/json', 'Content-Length': '12'}
2026-01-11T11:24:50.0225383Z retries = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:50.0225476Z redirect = False, assert_same_host = False
2026-01-11T11:24:50.0225650Z timeout = Timeout(connect=10, read=10, total=None), pool_timeout = None
2026-01-11T11:24:50.0225837Z release_conn = False, chunked = False, body_pos = None, preload_content = False
2026-01-11T11:24:50.0225926Z decode_content = False, response_kw = {}
2026-01-11T11:24:50.0226236Z parsed_url = Url(scheme=None, auth=None, host=None, port=None, path='/api/v2/agent/goal', query=None, fragment=None)
2026-01-11T11:24:50.0226389Z destination_scheme = None, conn = None, release_this_conn = True
2026-01-11T11:24:50.0226540Z http_tunnel_required = False, err = None, clean_exit = False
2026-01-11T11:24:50.0226545Z 
2026-01-11T11:24:50.0226638Z     def urlopen(  # type: ignore[override]
2026-01-11T11:24:50.0226696Z         self,
2026-01-11T11:24:50.0226766Z         method: str,
2026-01-11T11:24:50.0226827Z         url: str,
2026-01-11T11:24:50.0226912Z         body: _TYPE_BODY | None = None,
2026-01-11T11:24:50.0227028Z         headers: typing.Mapping[str, str] | None = None,
2026-01-11T11:24:50.0227123Z         retries: Retry | bool | int | None = None,
2026-01-11T11:24:50.0227200Z         redirect: bool = True,
2026-01-11T11:24:50.0227279Z         assert_same_host: bool = True,
2026-01-11T11:24:50.0227375Z         timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,
2026-01-11T11:24:50.0227457Z         pool_timeout: int | None = None,
2026-01-11T11:24:50.0227537Z         release_conn: bool | None = None,
2026-01-11T11:24:50.0227609Z         chunked: bool = False,
2026-01-11T11:24:50.0227844Z         body_pos: _TYPE_BODY_POSITION | None = None,
2026-01-11T11:24:50.0227930Z         preload_content: bool = True,
2026-01-11T11:24:50.0228007Z         decode_content: bool = True,
2026-01-11T11:24:50.0228085Z         **response_kw: typing.Any,
2026-01-11T11:24:50.0228168Z     ) -> BaseHTTPResponse:
2026-01-11T11:24:50.0228227Z         """
2026-01-11T11:24:50.0228408Z         Get a connection from the pool and perform an HTTP request. This is the
2026-01-11T11:24:50.0228582Z         lowest level call for making a request, so you'll need to specify all
2026-01-11T11:24:50.0228651Z         the raw details.
2026-01-11T11:24:50.0228708Z     
2026-01-11T11:24:50.0228777Z         .. note::
2026-01-11T11:24:50.0228837Z     
2026-01-11T11:24:50.0228987Z            More commonly, it's appropriate to use a convenience method
2026-01-11T11:24:50.0229063Z            such as :meth:`request`.
2026-01-11T11:24:50.0229125Z     
2026-01-11T11:24:50.0229187Z         .. note::
2026-01-11T11:24:50.0229256Z     
2026-01-11T11:24:50.0229479Z            `release_conn` will only behave as expected if
2026-01-11T11:24:50.0229597Z            `preload_content=False` because we want to make
2026-01-11T11:24:50.0229762Z            `preload_content=False` the default behaviour someday soon without
2026-01-11T11:24:50.0229853Z            breaking backwards compatibility.
2026-01-11T11:24:50.0229912Z     
2026-01-11T11:24:50.0229978Z         :param method:
2026-01-11T11:24:50.0230100Z             HTTP request method (such as GET, POST, PUT, etc.)
2026-01-11T11:24:50.0230156Z     
2026-01-11T11:24:50.0230221Z         :param url:
2026-01-11T11:24:50.0230309Z             The URL to perform the request on.
2026-01-11T11:24:50.0230364Z     
2026-01-11T11:24:50.0230432Z         :param body:
2026-01-11T11:24:50.0230600Z             Data to send in the request body, either :class:`str`, :class:`bytes`,
2026-01-11T11:24:50.0230758Z             an iterable of :class:`str`/:class:`bytes`, or a file-like object.
2026-01-11T11:24:50.0230822Z     
2026-01-11T11:24:50.0230895Z         :param headers:
2026-01-11T11:24:50.0231038Z             Dictionary of custom headers to send, such as User-Agent,
2026-01-11T11:24:50.0231201Z             If-None-Match, etc. If None, pool headers are used. If provided,
2026-01-11T11:24:50.0231363Z             these headers completely replace any pool-specific headers.
2026-01-11T11:24:50.0231420Z     
2026-01-11T11:24:50.0231487Z         :param retries:
2026-01-11T11:24:50.0231627Z             Configure the number of retries to allow before raising a
2026-01-11T11:24:50.0231771Z             :class:`~urllib3.exceptions.MaxRetryError` exception.
2026-01-11T11:24:50.0231828Z     
2026-01-11T11:24:50.0231998Z             If ``None`` (default) will retry 3 times, see ``Retry.DEFAULT``. Pass a
2026-01-11T11:24:50.0232170Z             :class:`~urllib3.util.retry.Retry` object for fine-grained control
2026-01-11T11:24:50.0232256Z             over different types of retries.
2026-01-11T11:24:50.0232419Z             Pass an integer number to retry connection errors that many times,
2026-01-11T11:24:50.0232561Z             but no other types of errors. Pass zero to never retry.
2026-01-11T11:24:50.0232619Z     
2026-01-11T11:24:50.0232776Z             If ``False``, then retries are disabled and any exception is raised
2026-01-11T11:24:50.0232946Z             immediately. Also, instead of raising a MaxRetryError on redirects,
2026-01-11T11:24:50.0233048Z             the redirect response will be returned.
2026-01-11T11:24:50.0233105Z     
2026-01-11T11:24:50.0233270Z         :type retries: :class:`~urllib3.util.retry.Retry`, False, or an int.
2026-01-11T11:24:50.0233332Z     
2026-01-11T11:24:50.0233402Z         :param redirect:
2026-01-11T11:24:50.0233556Z             If True, automatically handle redirects (status codes 301, 302,
2026-01-11T11:24:50.0233707Z             303, 307, 308). Each redirect counts as a retry. Disabling retries
2026-01-11T11:24:50.0233792Z             will disable redirect, too.
2026-01-11T11:24:50.0233936Z     
2026-01-11T11:24:50.0234014Z         :param assert_same_host:
2026-01-11T11:24:50.0234268Z             If ``True``, will make sure that the host of the pool requests is
2026-01-11T11:24:50.0234443Z             consistent else will raise HostChangedError. When ``False``, you can
2026-01-11T11:24:50.0234579Z             use the pool on an HTTP proxy and request foreign hosts.
2026-01-11T11:24:50.0234640Z     
2026-01-11T11:24:50.0234708Z         :param timeout:
2026-01-11T11:24:50.0234840Z             If specified, overrides the default timeout for this one
2026-01-11T11:24:50.0234981Z             request. It may be a float (in seconds) or an instance of
2026-01-11T11:24:50.0235067Z             :class:`urllib3.util.Timeout`.
2026-01-11T11:24:50.0235126Z     
2026-01-11T11:24:50.0235199Z         :param pool_timeout:
2026-01-11T11:24:50.0235353Z             If set and the pool is set to block=True, then this method will
2026-01-11T11:24:50.0235516Z             block for ``pool_timeout`` seconds and raise EmptyPoolError if no
2026-01-11T11:24:50.0235755Z             connection is available within the time period.
2026-01-11T11:24:50.0235817Z     
2026-01-11T11:24:50.0235900Z         :param bool preload_content:
2026-01-11T11:24:50.0236040Z             If True, the response's body will be preloaded into memory.
2026-01-11T11:24:50.0236096Z     
2026-01-11T11:24:50.0236179Z         :param bool decode_content:
2026-01-11T11:24:50.0236306Z             If True, will attempt to decode the body based on the
2026-01-11T11:24:50.0236389Z             'content-encoding' header.
2026-01-11T11:24:50.0236450Z     
2026-01-11T11:24:50.0236522Z         :param release_conn:
2026-01-11T11:24:50.0236673Z             If False, then the urlopen call will not release the connection
2026-01-11T11:24:50.0236840Z             back into the pool once a response is received (but will release if
2026-01-11T11:24:50.0236976Z             you read the entire contents of the response such as when
2026-01-11T11:24:50.0237139Z             `preload_content=True`). This is useful if you're not preloading
2026-01-11T11:24:50.0237280Z             the response's content immediately. You will need to call
2026-01-11T11:24:50.0237439Z             ``r.release_conn()`` on the response ``r`` to return the connection
2026-01-11T11:24:50.0237612Z             back into the pool. If None, it takes the value of ``preload_content``
2026-01-11T11:24:50.0237691Z             which defaults to ``True``.
2026-01-11T11:24:50.0237752Z     
2026-01-11T11:24:50.0237822Z         :param bool chunked:
2026-01-11T11:24:50.0237958Z             If True, urllib3 will send the body using chunked transfer
2026-01-11T11:24:50.0238128Z             encoding. Otherwise, urllib3 will send the body using the standard
2026-01-11T11:24:50.0238227Z             content-length form. Defaults to False.
2026-01-11T11:24:50.0238284Z     
2026-01-11T11:24:50.0238354Z         :param int body_pos:
2026-01-11T11:24:50.0238515Z             Position to seek to in file-like body in the event of a retry or
2026-01-11T11:24:50.0238689Z             redirect. Typically this won't need to be set because urllib3 will
2026-01-11T11:24:50.0238784Z             auto-populate the value when needed.
2026-01-11T11:24:50.0238847Z         """
2026-01-11T11:24:50.0238926Z         parsed_url = parse_url(url)
2026-01-11T11:24:50.0239022Z         destination_scheme = parsed_url.scheme
2026-01-11T11:24:50.0239083Z     
2026-01-11T11:24:50.0239160Z         if headers is None:
2026-01-11T11:24:50.0239238Z             headers = self.headers
2026-01-11T11:24:50.0239294Z     
2026-01-11T11:24:50.0239382Z         if not isinstance(retries, Retry):
2026-01-11T11:24:50.0239575Z             retries = Retry.from_int(retries, redirect=redirect, default=self.retries)
2026-01-11T11:24:50.0239632Z     
2026-01-11T11:24:50.0239712Z         if release_conn is None:
2026-01-11T11:24:50.0239794Z             release_conn = preload_content
2026-01-11T11:24:50.0239851Z     
2026-01-11T11:24:50.0239914Z         # Check host
2026-01-11T11:24:50.0240159Z         if assert_same_host and not self.is_same_host(url):
2026-01-11T11:24:50.0240266Z             raise HostChangedError(self, url, retries)
2026-01-11T11:24:50.0240323Z     
2026-01-11T11:24:50.0240471Z         # Ensure that the URL we're connecting to is properly encoded
2026-01-11T11:24:50.0240551Z         if url.startswith("/"):
2026-01-11T11:24:50.0240637Z             url = to_str(_encode_target(url))
2026-01-11T11:24:50.0240700Z         else:
2026-01-11T11:24:50.0240780Z             url = to_str(parsed_url.url)
2026-01-11T11:24:50.0240836Z     
2026-01-11T11:24:50.0240899Z         conn = None
2026-01-11T11:24:50.0240960Z     
2026-01-11T11:24:50.0241072Z         # Track whether `conn` needs to be released before
2026-01-11T11:24:50.0241248Z         # returning/raising/recursing. Update this variable if necessary, and
2026-01-11T11:24:50.0241417Z         # leave `release_conn` constant throughout the function. That way, if
2026-01-11T11:24:50.0241580Z         # the function recurses, the original value of `release_conn` will be
2026-01-11T11:24:50.0241868Z         # passed down into the recursive call, and its value will be respected.
2026-01-11T11:24:50.0241931Z         #
2026-01-11T11:24:50.0242009Z         # See issue #651 [1] for details.
2026-01-11T11:24:50.0242066Z         #
2026-01-11T11:24:50.0242193Z         # [1] <https://github.com/urllib3/urllib3/issues/651>
2026-01-11T11:24:50.0242279Z         release_this_conn = release_conn
2026-01-11T11:24:50.0242335Z     
2026-01-11T11:24:50.0242468Z         http_tunnel_required = connection_requires_http_tunnel(
2026-01-11T11:24:50.0242597Z             self.proxy, self.proxy_config, destination_scheme
2026-01-11T11:24:50.0242654Z         )
2026-01-11T11:24:50.0242711Z     
2026-01-11T11:24:50.0242874Z         # Merge the proxy headers. Only done when not using HTTP CONNECT. We
2026-01-11T11:24:50.0243048Z         # have to copy the headers dict so we can safely change it without those
2026-01-11T11:24:50.0243160Z         # changes being reflected in anyone else's copy.
2026-01-11T11:24:50.0243249Z         if not http_tunnel_required:
2026-01-11T11:24:50.0243388Z             headers = headers.copy()  # type: ignore[attr-defined]
2026-01-11T11:24:50.0243552Z             headers.update(self.proxy_headers)  # type: ignore[union-attr]
2026-01-11T11:24:50.0243608Z     
2026-01-11T11:24:50.0243786Z         # Must keep the exception bound to a separate variable or else Python 3
2026-01-11T11:24:50.0243876Z         # complains about UnboundLocalError.
2026-01-11T11:24:50.0243939Z         err = None
2026-01-11T11:24:50.0243996Z     
2026-01-11T11:24:50.0244354Z         # Keep track of whether we cleanly exited the except block. This
2026-01-11T11:24:50.0244460Z         # ensures we do proper cleanup in finally.
2026-01-11T11:24:50.0244533Z         clean_exit = False
2026-01-11T11:24:50.0244595Z     
2026-01-11T11:24:50.0244733Z         # Rewind body position, if needed. Record current position
2026-01-11T11:24:50.0244855Z         # for future rewinds in the event of a redirect/retry.
2026-01-11T11:24:50.0244974Z         body_pos = set_file_position(body, body_pos)
2026-01-11T11:24:50.0245031Z     
2026-01-11T11:24:50.0245091Z         try:
2026-01-11T11:24:50.0245185Z             # Request a connection from the queue.
2026-01-11T11:24:50.0245284Z             timeout_obj = self._get_timeout(timeout)
2026-01-11T11:24:50.0245389Z             conn = self._get_conn(timeout=pool_timeout)
2026-01-11T11:24:50.0245446Z     
2026-01-11T11:24:50.0245631Z             conn.timeout = timeout_obj.connect_timeout  # type: ignore[assignment]
2026-01-11T11:24:50.0245687Z     
2026-01-11T11:24:50.0245848Z             # Is this a closed/new connection that requires CONNECT tunnelling?
2026-01-11T11:24:50.0246019Z             if self.proxy is not None and http_tunnel_required and conn.is_closed:
2026-01-11T11:24:50.0246086Z                 try:
2026-01-11T11:24:50.0246173Z                     self._prepare_proxy(conn)
2026-01-11T11:24:50.0246305Z                 except (BaseSSLError, OSError, SocketTimeout) as e:
2026-01-11T11:24:50.0246516Z                     self._raise_timeout(
2026-01-11T11:24:50.0246655Z                         err=e, url=self.proxy.url, timeout_value=conn.timeout
2026-01-11T11:24:50.0246718Z                     )
2026-01-11T11:24:50.0246788Z                     raise
2026-01-11T11:24:50.0246843Z     
2026-01-11T11:24:50.0246988Z             # If we're going to release the connection in ``finally:``, then
2026-01-11T11:24:50.0247152Z             # the response doesn't need to know about the connection. Otherwise
2026-01-11T11:24:50.0247302Z             # it will also try to release it and we'll have a double-release
2026-01-11T11:24:50.0247362Z             # mess.
2026-01-11T11:24:50.0247484Z             response_conn = conn if not release_conn else None
2026-01-11T11:24:50.0247545Z     
2026-01-11T11:24:50.0247659Z             # Make the request on the HTTPConnection object
2026-01-11T11:24:50.0247742Z >           response = self._make_request(
2026-01-11T11:24:50.0247918Z                 conn,
2026-01-11T11:24:50.0247982Z                 method,
2026-01-11T11:24:50.0248043Z                 url,
2026-01-11T11:24:50.0248119Z                 timeout=timeout_obj,
2026-01-11T11:24:50.0248190Z                 body=body,
2026-01-11T11:24:50.0248262Z                 headers=headers,
2026-01-11T11:24:50.0248331Z                 chunked=chunked,
2026-01-11T11:24:50.0248402Z                 retries=retries,
2026-01-11T11:24:50.0248490Z                 response_conn=response_conn,
2026-01-11T11:24:50.0248582Z                 preload_content=preload_content,
2026-01-11T11:24:50.0248668Z                 decode_content=decode_content,
2026-01-11T11:24:50.0248742Z                 **response_kw,
2026-01-11T11:24:50.0248800Z             )
2026-01-11T11:24:50.0248806Z 
2026-01-11T11:24:50.0249094Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:787: 
2026-01-11T11:24:50.0249221Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0249566Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:493: in _make_request
2026-01-11T11:24:50.0249632Z     conn.request(
2026-01-11T11:24:50.0249922Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:445: in request
2026-01-11T11:24:50.0249995Z     self.endheaders()
2026-01-11T11:24:50.0250222Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1278: in endheaders
2026-01-11T11:24:50.0250375Z     self._send_output(message_body, encode_chunked=encode_chunked)
2026-01-11T11:24:50.0250607Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:1038: in _send_output
2026-01-11T11:24:50.0250671Z     self.send(msg)
2026-01-11T11:24:50.0250874Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/http/client.py:976: in send
2026-01-11T11:24:50.0250942Z     self.connect()
2026-01-11T11:24:50.0251226Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:276: in connect
2026-01-11T11:24:50.0251310Z     self.sock = self._new_conn()
2026-01-11T11:24:50.0251430Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0251436Z 
2026-01-11T11:24:50.0251606Z self = <urllib3.connection.HTTPConnection object at 0x7f29f07d39d0>
2026-01-11T11:24:50.0251611Z 
2026-01-11T11:24:50.0251698Z     def _new_conn(self) -> socket.socket:
2026-01-11T11:24:50.0251858Z         """Establish a socket connection and set nodelay settings on it.
2026-01-11T11:24:50.0251915Z     
2026-01-11T11:24:50.0251996Z         :return: New socket connection.
2026-01-11T11:24:50.0252058Z         """
2026-01-11T11:24:50.0252116Z         try:
2026-01-11T11:24:50.0252210Z             sock = connection.create_connection(
2026-01-11T11:24:50.0252293Z                 (self._dns_host, self.port),
2026-01-11T11:24:50.0252368Z                 self.timeout,
2026-01-11T11:24:50.0252463Z                 source_address=self.source_address,
2026-01-11T11:24:50.0252646Z                 socket_options=self.socket_options,
2026-01-11T11:24:50.0252711Z             )
2026-01-11T11:24:50.0252793Z         except socket.gaierror as e:
2026-01-11T11:24:50.0252924Z             raise NameResolutionError(self.host, self, e) from e
2026-01-11T11:24:50.0253004Z         except SocketTimeout as e:
2026-01-11T11:24:50.0253091Z             raise ConnectTimeoutError(
2026-01-11T11:24:50.0253154Z                 self,
2026-01-11T11:24:50.0253347Z                 f"Connection to {self.host} timed out. (connect timeout={self.timeout})",
2026-01-11T11:24:50.0253413Z             ) from e
2026-01-11T11:24:50.0253469Z     
2026-01-11T11:24:50.0253543Z         except OSError as e:
2026-01-11T11:24:50.0253628Z >           raise NewConnectionError(
2026-01-11T11:24:50.0253752Z                 self, f"Failed to establish a new connection: {e}"
2026-01-11T11:24:50.0253814Z             ) from e
2026-01-11T11:24:50.0254470Z E           urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f29f07d39d0>: Failed to establish a new connection: [Errno 111] Connection refused
2026-01-11T11:24:50.0254601Z 
2026-01-11T11:24:50.0254937Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connection.py:213: NewConnectionError
2026-01-11T11:24:50.0254942Z 
2026-01-11T11:24:50.0255112Z The above exception was the direct cause of the following exception:
2026-01-11T11:24:50.0255117Z 
2026-01-11T11:24:50.0255274Z self = <requests.adapters.HTTPAdapter object at 0x7f29f07d31f0>
2026-01-11T11:24:50.0255384Z request = <PreparedRequest [POST]>, stream = False
2026-01-11T11:24:50.0255568Z timeout = Timeout(connect=10, read=10, total=None), verify = True, cert = None
2026-01-11T11:24:50.0255643Z proxies = OrderedDict()
2026-01-11T11:24:50.0255652Z 
2026-01-11T11:24:50.0255711Z     def send(
2026-01-11T11:24:50.0255918Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:50.0255981Z     ):
2026-01-11T11:24:50.0256129Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:50.0256187Z     
2026-01-11T11:24:50.0256376Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:50.0256535Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:50.0256693Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:50.0256850Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:50.0256940Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:50.0257069Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:50.0257260Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:50.0257431Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:50.0257526Z             must be a path to a CA bundle to use
2026-01-11T11:24:50.0257715Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:50.0257898Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:50.0257981Z         :rtype: requests.Response
2026-01-11T11:24:50.0258040Z         """
2026-01-11T11:24:50.0258096Z     
2026-01-11T11:24:50.0258161Z         try:
2026-01-11T11:24:50.0258279Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:50.0258365Z         except LocationValueError as e:
2026-01-11T11:24:50.0258455Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:50.0258516Z     
2026-01-11T11:24:50.0258634Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:50.0258729Z         url = self.request_url(request, proxies)
2026-01-11T11:24:50.0258805Z         self.add_headers(
2026-01-11T11:24:50.0258867Z             request,
2026-01-11T11:24:50.0258936Z             stream=stream,
2026-01-11T11:24:50.0259212Z             timeout=timeout,
2026-01-11T11:24:50.0259283Z             verify=verify,
2026-01-11T11:24:50.0259349Z             cert=cert,
2026-01-11T11:24:50.0259431Z             proxies=proxies,
2026-01-11T11:24:50.0259507Z         )
2026-01-11T11:24:50.0259563Z     
2026-01-11T11:24:50.0259757Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:50.0259817Z     
2026-01-11T11:24:50.0259900Z         if isinstance(timeout, tuple):
2026-01-11T11:24:50.0259959Z             try:
2026-01-11T11:24:50.0260035Z                 connect, read = timeout
2026-01-11T11:24:50.0260165Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:50.0260240Z             except ValueError:
2026-01-11T11:24:50.0260313Z                 raise ValueError(
2026-01-11T11:24:50.0260500Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:50.0260646Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:50.0260792Z                 )
2026-01-11T11:24:50.0260894Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:50.0260959Z             pass
2026-01-11T11:24:50.0261018Z         else:
2026-01-11T11:24:50.0261149Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:50.0261213Z     
2026-01-11T11:24:50.0261272Z         try:
2026-01-11T11:24:50.0261348Z >           resp = conn.urlopen(
2026-01-11T11:24:50.0261425Z                 method=request.method,
2026-01-11T11:24:50.0261495Z                 url=url,
2026-01-11T11:24:50.0261567Z                 body=request.body,
2026-01-11T11:24:50.0261648Z                 headers=request.headers,
2026-01-11T11:24:50.0261726Z                 redirect=False,
2026-01-11T11:24:50.0261802Z                 assert_same_host=False,
2026-01-11T11:24:50.0261878Z                 preload_content=False,
2026-01-11T11:24:50.0261956Z                 decode_content=False,
2026-01-11T11:24:50.0262039Z                 retries=self.max_retries,
2026-01-11T11:24:50.0262116Z                 timeout=timeout,
2026-01-11T11:24:50.0262185Z                 chunked=chunked,
2026-01-11T11:24:50.0262247Z             )
2026-01-11T11:24:50.0262253Z 
2026-01-11T11:24:50.0262510Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:486: 
2026-01-11T11:24:50.0262629Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0262941Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/connectionpool.py:841: in urlopen
2026-01-11T11:24:50.0263023Z     retries = retries.increment(
2026-01-11T11:24:50.0263140Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0263145Z 
2026-01-11T11:24:50.0263324Z self = Retry(total=0, connect=None, read=False, redirect=None, status=None)
2026-01-11T11:24:50.0263459Z method = 'POST', url = '/api/v2/agent/goal', response = None
2026-01-11T11:24:50.0263957Z error = NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f07d39d0>: Failed to establish a new connection: [Errno 111] Connection refused')
2026-01-11T11:24:50.0264358Z _pool = <urllib3.connectionpool.HTTPConnectionPool object at 0x7f29f07d1f90>
2026-01-11T11:24:50.0264472Z _stacktrace = <traceback object at 0x7f29f0683280>
2026-01-11T11:24:50.0264478Z 
2026-01-11T11:24:50.0264541Z     def increment(
2026-01-11T11:24:50.0264607Z         self,
2026-01-11T11:24:50.0264681Z         method: str | None = None,
2026-01-11T11:24:50.0264753Z         url: str | None = None,
2026-01-11T11:24:50.0264854Z         response: BaseHTTPResponse | None = None,
2026-01-11T11:24:50.0264938Z         error: Exception | None = None,
2026-01-11T11:24:50.0265026Z         _pool: ConnectionPool | None = None,
2026-01-11T11:24:50.0265123Z         _stacktrace: TracebackType | None = None,
2026-01-11T11:24:50.0265188Z     ) -> Self:
2026-01-11T11:24:50.0265335Z         """Return a new Retry object with incremented retry counters.
2026-01-11T11:24:50.0265519Z     
2026-01-11T11:24:50.0265686Z         :param response: A response object, or None, if the server did not
2026-01-11T11:24:50.0265764Z             return a response.
2026-01-11T11:24:50.0265917Z         :type response: :class:`~urllib3.response.BaseHTTPResponse`
2026-01-11T11:24:50.0266086Z         :param Exception error: An error encountered during the request, or
2026-01-11T11:24:50.0266207Z             None if the response was received successfully.
2026-01-11T11:24:50.0266264Z     
2026-01-11T11:24:50.0266342Z         :return: A new ``Retry`` object.
2026-01-11T11:24:50.0266404Z         """
2026-01-11T11:24:50.0266486Z         if self.total is False and error:
2026-01-11T11:24:50.0266592Z             # Disabled, indicate to re-raise the error.
2026-01-11T11:24:50.0266706Z             raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:50.0266767Z     
2026-01-11T11:24:50.0266836Z         total = self.total
2026-01-11T11:24:50.0266914Z         if total is not None:
2026-01-11T11:24:50.0267091Z             total -= 1
2026-01-11T11:24:50.0267148Z     
2026-01-11T11:24:50.0267220Z         connect = self.connect
2026-01-11T11:24:50.0267287Z         read = self.read
2026-01-11T11:24:50.0267365Z         redirect = self.redirect
2026-01-11T11:24:50.0267440Z         status_count = self.status
2026-01-11T11:24:50.0267509Z         other = self.other
2026-01-11T11:24:50.0267583Z         cause = "unknown"
2026-01-11T11:24:50.0267648Z         status = None
2026-01-11T11:24:50.0267724Z         redirect_location = None
2026-01-11T11:24:50.0267783Z     
2026-01-11T11:24:50.0267891Z         if error and self._is_connection_error(error):
2026-01-11T11:24:50.0267961Z             # Connect retry?
2026-01-11T11:24:50.0268032Z             if connect is False:
2026-01-11T11:24:50.0268153Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:50.0268233Z             elif connect is not None:
2026-01-11T11:24:50.0268307Z                 connect -= 1
2026-01-11T11:24:50.0268372Z     
2026-01-11T11:24:50.0268468Z         elif error and self._is_read_error(error):
2026-01-11T11:24:50.0268535Z             # Read retry?
2026-01-11T11:24:50.0268725Z             if read is False or method is None or not self._is_method_retryable(method):
2026-01-11T11:24:50.0268841Z                 raise reraise(type(error), error, _stacktrace)
2026-01-11T11:24:50.0268915Z             elif read is not None:
2026-01-11T11:24:50.0268982Z                 read -= 1
2026-01-11T11:24:50.0269044Z     
2026-01-11T11:24:50.0269106Z         elif error:
2026-01-11T11:24:50.0269173Z             # Other retry?
2026-01-11T11:24:50.0269246Z             if other is not None:
2026-01-11T11:24:50.0269316Z                 other -= 1
2026-01-11T11:24:50.0269373Z     
2026-01-11T11:24:50.0269495Z         elif response and response.get_redirect_location():
2026-01-11T11:24:50.0269570Z             # Redirect retry?
2026-01-11T11:24:50.0269645Z             if redirect is not None:
2026-01-11T11:24:50.0269723Z                 redirect -= 1
2026-01-11T11:24:50.0269806Z             cause = "too many redirects"
2026-01-11T11:24:50.0269965Z             response_redirect_location = response.get_redirect_location()
2026-01-11T11:24:50.0270051Z             if response_redirect_location:
2026-01-11T11:24:50.0270166Z                 redirect_location = response_redirect_location
2026-01-11T11:24:50.0270247Z             status = response.status
2026-01-11T11:24:50.0270308Z     
2026-01-11T11:24:50.0270365Z         else:
2026-01-11T11:24:50.0270499Z             # Incrementing because of a server error like a 500 in
2026-01-11T11:24:50.0270659Z             # status_forcelist and the given method is in the allowed_methods
2026-01-11T11:24:50.0270755Z             cause = ResponseError.GENERIC_ERROR
2026-01-11T11:24:50.0270849Z             if response and response.status:
2026-01-11T11:24:50.0270929Z                 if status_count is not None:
2026-01-11T11:24:50.0271006Z                     status_count -= 1
2026-01-11T11:24:50.0271304Z                 cause = ResponseError.SPECIFIC_ERROR.format(status_code=response.status)
2026-01-11T11:24:50.0271388Z                 status = response.status
2026-01-11T11:24:50.0271444Z     
2026-01-11T11:24:50.0271521Z         history = self.history + (
2026-01-11T11:24:50.0271687Z             RequestHistory(method, url, error, status, redirect_location),
2026-01-11T11:24:50.0271744Z         )
2026-01-11T11:24:50.0271799Z     
2026-01-11T11:24:50.0271869Z         new_retry = self.new(
2026-01-11T11:24:50.0271942Z             total=total,
2026-01-11T11:24:50.0272011Z             connect=connect,
2026-01-11T11:24:50.0272075Z             read=read,
2026-01-11T11:24:50.0272150Z             redirect=redirect,
2026-01-11T11:24:50.0272221Z             status=status_count,
2026-01-11T11:24:50.0272286Z             other=other,
2026-01-11T11:24:50.0272359Z             history=history,
2026-01-11T11:24:50.0272419Z         )
2026-01-11T11:24:50.0272475Z     
2026-01-11T11:24:50.0272559Z         if new_retry.is_exhausted():
2026-01-11T11:24:50.0272738Z             reason = error or ResponseError(cause)
2026-01-11T11:24:50.0272944Z >           raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
2026-01-11T11:24:50.0273933Z E           urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/goal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f07d39d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:50.0273941Z 
2026-01-11T11:24:50.0274355Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/urllib3/util/retry.py:519: MaxRetryError
2026-01-11T11:24:50.0274362Z 
2026-01-11T11:24:50.0274527Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0274532Z 
2026-01-11T11:24:50.0274692Z self = <test_phd_pipeline.TestPhDPipeline object at 0x7f2aec793d30>
2026-01-11T11:24:50.0274713Z 
2026-01-11T11:24:50.0274792Z     def test_error_handling(self):
2026-01-11T11:24:50.0274892Z         """Test error handling in API endpoints"""
2026-01-11T11:24:50.0274989Z         print("\n=== Testing Error Handling ===")
2026-01-11T11:24:50.0275049Z     
2026-01-11T11:24:50.0275121Z         # Test malformed JSON
2026-01-11T11:24:50.0275201Z >       response = requests.post(
2026-01-11T11:24:50.0275296Z             f"{self.BASE_URL}/api/v2/agent/goal",
2026-01-11T11:24:50.0275369Z             data="invalid json",
2026-01-11T11:24:50.0275487Z             headers={"Content-Type": "application/json"},
2026-01-11T11:24:50.0275552Z             timeout=10
2026-01-11T11:24:50.0275614Z         )
2026-01-11T11:24:50.0275619Z 
2026-01-11T11:24:50.0275721Z tests/integration/test_phd_pipeline.py:225: 
2026-01-11T11:24:50.0275841Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0276115Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:115: in post
2026-01-11T11:24:50.0276263Z     return request("post", url, data=data, json=json, **kwargs)
2026-01-11T11:24:50.0276528Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/api.py:59: in request
2026-01-11T11:24:50.0276669Z     return session.request(method=method, url=url, **kwargs)
2026-01-11T11:24:50.0276959Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:589: in request
2026-01-11T11:24:50.0277049Z     resp = self.send(prep, **send_kwargs)
2026-01-11T11:24:50.0277331Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/sessions.py:703: in send
2026-01-11T11:24:50.0277415Z     r = adapter.send(request, **kwargs)
2026-01-11T11:24:50.0277536Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0277542Z 
2026-01-11T11:24:50.0277700Z self = <requests.adapters.HTTPAdapter object at 0x7f29f07d31f0>
2026-01-11T11:24:50.0277811Z request = <PreparedRequest [POST]>, stream = False
2026-01-11T11:24:50.0278123Z timeout = Timeout(connect=10, read=10, total=None), verify = True, cert = None
2026-01-11T11:24:50.0278201Z proxies = OrderedDict()
2026-01-11T11:24:50.0278210Z 
2026-01-11T11:24:50.0278270Z     def send(
2026-01-11T11:24:50.0278474Z         self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None
2026-01-11T11:24:50.0278532Z     ):
2026-01-11T11:24:50.0278677Z         """Sends PreparedRequest object. Returns Response object.
2026-01-11T11:24:50.0278735Z     
2026-01-11T11:24:50.0278926Z         :param request: The :class:`PreparedRequest <PreparedRequest>` being sent.
2026-01-11T11:24:50.0279088Z         :param stream: (optional) Whether to stream the request content.
2026-01-11T11:24:50.0279247Z         :param timeout: (optional) How long to wait for the server to send
2026-01-11T11:24:50.0279399Z             data before giving up, as a float, or a :ref:`(connect timeout,
2026-01-11T11:24:50.0279485Z             read timeout) <timeouts>` tuple.
2026-01-11T11:24:50.0279735Z         :type timeout: float or tuple or urllib3 Timeout object
2026-01-11T11:24:50.0279930Z         :param verify: (optional) Either a boolean, in which case it controls whether
2026-01-11T11:24:50.0280100Z             we verify the server's TLS certificate, or a string, in which case it
2026-01-11T11:24:50.0280196Z             must be a path to a CA bundle to use
2026-01-11T11:24:50.0280380Z         :param cert: (optional) Any user-provided SSL certificate to be trusted.
2026-01-11T11:24:50.0280565Z         :param proxies: (optional) The proxies dictionary to apply to the request.
2026-01-11T11:24:50.0280650Z         :rtype: requests.Response
2026-01-11T11:24:50.0280709Z         """
2026-01-11T11:24:50.0280768Z     
2026-01-11T11:24:50.0280833Z         try:
2026-01-11T11:24:50.0280951Z             conn = self.get_connection(request.url, proxies)
2026-01-11T11:24:50.0281037Z         except LocationValueError as e:
2026-01-11T11:24:50.0281127Z             raise InvalidURL(e, request=request)
2026-01-11T11:24:50.0281199Z     
2026-01-11T11:24:50.0281318Z         self.cert_verify(conn, request.url, verify, cert)
2026-01-11T11:24:50.0281412Z         url = self.request_url(request, proxies)
2026-01-11T11:24:50.0281491Z         self.add_headers(
2026-01-11T11:24:50.0281554Z             request,
2026-01-11T11:24:50.0281626Z             stream=stream,
2026-01-11T11:24:50.0281696Z             timeout=timeout,
2026-01-11T11:24:50.0281772Z             verify=verify,
2026-01-11T11:24:50.0281835Z             cert=cert,
2026-01-11T11:24:50.0281906Z             proxies=proxies,
2026-01-11T11:24:50.0281967Z         )
2026-01-11T11:24:50.0282024Z     
2026-01-11T11:24:50.0282216Z         chunked = not (request.body is None or "Content-Length" in request.headers)
2026-01-11T11:24:50.0282273Z     
2026-01-11T11:24:50.0282362Z         if isinstance(timeout, tuple):
2026-01-11T11:24:50.0282422Z             try:
2026-01-11T11:24:50.0282498Z                 connect, read = timeout
2026-01-11T11:24:50.0282635Z                 timeout = TimeoutSauce(connect=connect, read=read)
2026-01-11T11:24:50.0282710Z             except ValueError:
2026-01-11T11:24:50.0282783Z                 raise ValueError(
2026-01-11T11:24:50.0282969Z                     f"Invalid timeout {timeout}. Pass a (connect, read) timeout tuple, "
2026-01-11T11:24:50.0283114Z                     f"or a single float to set both timeouts to the same value."
2026-01-11T11:24:50.0283174Z                 )
2026-01-11T11:24:50.0283271Z         elif isinstance(timeout, TimeoutSauce):
2026-01-11T11:24:50.0283338Z             pass
2026-01-11T11:24:50.0283398Z         else:
2026-01-11T11:24:50.0283527Z             timeout = TimeoutSauce(connect=timeout, read=timeout)
2026-01-11T11:24:50.0283588Z     
2026-01-11T11:24:50.0283649Z         try:
2026-01-11T11:24:50.0283732Z             resp = conn.urlopen(
2026-01-11T11:24:50.0283818Z                 method=request.method,
2026-01-11T11:24:50.0283888Z                 url=url,
2026-01-11T11:24:50.0284198Z                 body=request.body,
2026-01-11T11:24:50.0284310Z                 headers=request.headers,
2026-01-11T11:24:50.0284392Z                 redirect=False,
2026-01-11T11:24:50.0284470Z                 assert_same_host=False,
2026-01-11T11:24:50.0284548Z                 preload_content=False,
2026-01-11T11:24:50.0284623Z                 decode_content=False,
2026-01-11T11:24:50.0284707Z                 retries=self.max_retries,
2026-01-11T11:24:50.0284778Z                 timeout=timeout,
2026-01-11T11:24:50.0284847Z                 chunked=chunked,
2026-01-11T11:24:50.0284909Z             )
2026-01-11T11:24:50.0284966Z     
2026-01-11T11:24:50.0285063Z         except (ProtocolError, OSError) as err:
2026-01-11T11:24:50.0285176Z             raise ConnectionError(err, request=request)
2026-01-11T11:24:50.0285233Z     
2026-01-11T11:24:50.0285312Z         except MaxRetryError as e:
2026-01-11T11:24:50.0285426Z             if isinstance(e.reason, ConnectTimeoutError):
2026-01-11T11:24:50.0285652Z                 # TODO: Remove this in 3.0.0: see #2811
2026-01-11T11:24:50.0285775Z                 if not isinstance(e.reason, NewConnectionError):
2026-01-11T11:24:50.0285884Z                     raise ConnectTimeout(e, request=request)
2026-01-11T11:24:50.0285949Z     
2026-01-11T11:24:50.0286048Z             if isinstance(e.reason, ResponseError):
2026-01-11T11:24:50.0286144Z                 raise RetryError(e, request=request)
2026-01-11T11:24:50.0286201Z     
2026-01-11T11:24:50.0286300Z             if isinstance(e.reason, _ProxyError):
2026-01-11T11:24:50.0286396Z                 raise ProxyError(e, request=request)
2026-01-11T11:24:50.0286452Z     
2026-01-11T11:24:50.0286546Z             if isinstance(e.reason, _SSLError):
2026-01-11T11:24:50.0286656Z                 # This branch is for urllib3 v1.22 and later.
2026-01-11T11:24:50.0286746Z                 raise SSLError(e, request=request)
2026-01-11T11:24:50.0286805Z     
2026-01-11T11:24:50.0286908Z >           raise ConnectionError(e, request=request)
2026-01-11T11:24:50.0287919Z E           requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/goal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f07d39d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:50.0287925Z 
2026-01-11T11:24:50.0288242Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/requests/adapters.py:519: ConnectionError
2026-01-11T11:24:50.0288403Z ----------------------------- Captured stdout call -----------------------------
2026-01-11T11:24:50.0288409Z 
2026-01-11T11:24:50.0288485Z === Testing Error Handling ===
2026-01-11T11:24:50.0288663Z ___________________ TestIntegration.test_concurrent_requests ___________________
2026-01-11T11:24:50.0288668Z 
2026-01-11T11:24:50.0288834Z self = <test_phd_pipeline.TestIntegration object at 0x7f2aec792aa0>
2026-01-11T11:24:50.0288839Z 
2026-01-11T11:24:50.0288926Z     def test_concurrent_requests(self):
2026-01-11T11:24:50.0289031Z         """Test handling of concurrent requests"""
2026-01-11T11:24:50.0289143Z         print("\n=== Testing Concurrent Requests ===")
2026-01-11T11:24:50.0289199Z     
2026-01-11T11:24:50.0289277Z         import concurrent.futures
2026-01-11T11:24:50.0289339Z     
2026-01-11T11:24:50.0289415Z         def make_request(goal_id):
2026-01-11T11:24:50.0289496Z             response = requests.post(
2026-01-11T11:24:50.0289595Z                 f"{self.BASE_URL}/api/v2/agent/goal",
2026-01-11T11:24:50.0289660Z                 json={
2026-01-11T11:24:50.0289770Z                     "goal": f"Concurrent test goal {goal_id}",
2026-01-11T11:24:50.0289845Z                     "stage": "early"
2026-01-11T11:24:50.0289904Z                 },
2026-01-11T11:24:50.0289974Z                 timeout=10
2026-01-11T11:24:50.0290032Z             )
2026-01-11T11:24:50.0290118Z             return response.status_code
2026-01-11T11:24:50.0290176Z     
2026-01-11T11:24:50.0290498Z         with concurrent.futures.ThreadPoolExecutor(max_workers=5) as executor:
2026-01-11T11:24:50.0290655Z             futures = [executor.submit(make_request, i) for i in range(5)]
2026-01-11T11:24:50.0290874Z >           results = [future.result() for future in concurrent.futures.as_completed(futures)]
2026-01-11T11:24:50.0290880Z 
2026-01-11T11:24:50.0290981Z tests/integration/test_phd_pipeline.py:340: 
2026-01-11T11:24:50.0291103Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0291239Z tests/integration/test_phd_pipeline.py:340: in <listcomp>
2026-01-11T11:24:50.0291445Z     results = [future.result() for future in concurrent.futures.as_completed(futures)]
2026-01-11T11:24:50.0291702Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py:451: in result
2026-01-11T11:24:50.0291781Z     return self.__get_result()
2026-01-11T11:24:50.0292054Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py:403: in __get_result
2026-01-11T11:24:50.0292245Z     raise self._exception
2026-01-11T11:24:50.0292492Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/thread.py:58: in run
2026-01-11T11:24:50.0292592Z     result = self.fn(*self.args, **self.kwargs)
2026-01-11T11:24:50.0292706Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0292711Z 
2026-01-11T11:24:50.0292775Z goal_id = 0
2026-01-11T11:24:50.0292780Z 
2026-01-11T11:24:50.0292854Z     def make_request(goal_id):
2026-01-11T11:24:50.0292933Z         response = requests.post(
2026-01-11T11:24:50.0293028Z >           f"{self.BASE_URL}/api/v2/agent/goal",
2026-01-11T11:24:50.0293090Z             json={
2026-01-11T11:24:50.0293196Z                 "goal": f"Concurrent test goal {goal_id}",
2026-01-11T11:24:50.0293267Z                 "stage": "early"
2026-01-11T11:24:50.0293329Z             },
2026-01-11T11:24:50.0293394Z             timeout=10
2026-01-11T11:24:50.0293456Z         )
2026-01-11T11:24:50.0293644Z E       AttributeError: 'TestIntegration' object has no attribute 'BASE_URL'
2026-01-11T11:24:50.0293649Z 
2026-01-11T11:24:50.0293787Z tests/integration/test_phd_pipeline.py:329: AttributeError
2026-01-11T11:24:50.0293941Z ----------------------------- Captured stdout call -----------------------------
2026-01-11T11:24:50.0293946Z 
2026-01-11T11:24:50.0294137Z === Testing Concurrent Requests ===
2026-01-11T11:24:50.0294293Z _________________________ test_health_check_structure __________________________
2026-01-11T11:24:50.0294410Z   + Exception Group Traceback (most recent call last):
2026-01-11T11:24:50.0294791Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
2026-01-11T11:24:50.0294853Z   |     yield
2026-01-11T11:24:50.0295219Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 190, in __call__
2026-01-11T11:24:50.0295355Z   |     async with anyio.create_task_group() as task_group:
2026-01-11T11:24:50.0295716Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
2026-01-11T11:24:50.0295800Z   |     raise BaseExceptionGroup(
2026-01-11T11:24:50.0296027Z   | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
2026-01-11T11:24:50.0296107Z   +-+---------------- 1 ----------------
2026-01-11T11:24:50.0296190Z     | Traceback (most recent call last):
2026-01-11T11:24:50.0296522Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/runner.py", line 353, in from_call
2026-01-11T11:24:50.0296609Z     |     result: TResult | None = func()
2026-01-11T11:24:50.0296931Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/runner.py", line 245, in <lambda>
2026-01-11T11:24:50.0297026Z     |     lambda: runtest_hook(item=item, **kwds),
2026-01-11T11:24:50.0297476Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_hooks.py", line 512, in __call__
2026-01-11T11:24:50.0297679Z     |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
2026-01-11T11:24:50.0298007Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_manager.py", line 120, in _hookexec
2026-01-11T11:24:50.0298180Z     |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
2026-01-11T11:24:50.0298509Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 167, in _multicall
2026-01-11T11:24:50.0298580Z     |     raise exception
2026-01-11T11:24:50.0298912Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0298993Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0299360Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
2026-01-11T11:24:50.0299530Z     |     yield
2026-01-11T11:24:50.0299858Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0299937Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0300301Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
2026-01-11T11:24:50.0300374Z     |     return (yield)
2026-01-11T11:24:50.0300701Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0300779Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0301159Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/skipping.py", line 268, in pytest_runtest_call
2026-01-11T11:24:50.0301229Z     |     return (yield)
2026-01-11T11:24:50.0301577Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 121, in _multicall
2026-01-11T11:24:50.0301667Z     |     res = hook_impl.function(*args)
2026-01-11T11:24:50.0302035Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/runner.py", line 179, in pytest_runtest_call
2026-01-11T11:24:50.0302105Z     |     item.runtest()
2026-01-11T11:24:50.0302429Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/python.py", line 1720, in runtest
2026-01-11T11:24:50.0302550Z     |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
2026-01-11T11:24:50.0302869Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_hooks.py", line 512, in __call__
2026-01-11T11:24:50.0303076Z     |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
2026-01-11T11:24:50.0303404Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_manager.py", line 120, in _hookexec
2026-01-11T11:24:50.0303583Z     |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
2026-01-11T11:24:50.0303917Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 167, in _multicall
2026-01-11T11:24:50.0303990Z     |     raise exception
2026-01-11T11:24:50.0304511Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0304601Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0304990Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
2026-01-11T11:24:50.0305068Z     |     return result.get_result()
2026-01-11T11:24:50.0305394Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_result.py", line 103, in get_result
2026-01-11T11:24:50.0305607Z     |     raise exc.with_traceback(tb)
2026-01-11T11:24:50.0305992Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
2026-01-11T11:24:50.0306058Z     |     res = yield
2026-01-11T11:24:50.0306388Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 121, in _multicall
2026-01-11T11:24:50.0306471Z     |     res = hook_impl.function(*args)
2026-01-11T11:24:50.0306831Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/python.py", line 166, in pytest_pyfunc_call
2026-01-11T11:24:50.0306923Z     |     result = testfunction(**testargs)
2026-01-11T11:24:50.0307407Z     |   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/tests/test_api_basics.py", line 12, in test_health_check_structure
2026-01-11T11:24:50.0307494Z     |     response = client.get("/health")
2026-01-11T11:24:50.0307935Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 502, in get
2026-01-11T11:24:50.0308009Z     |     return super().get(
2026-01-11T11:24:50.0308319Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1054, in get
2026-01-11T11:24:50.0308399Z     |     return self.request(
2026-01-11T11:24:50.0308741Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 468, in request
2026-01-11T11:24:50.0308816Z     |     return super().request(
2026-01-11T11:24:50.0309139Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 827, in request
2026-01-11T11:24:50.0309321Z     |     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2026-01-11T11:24:50.0309637Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 914, in send
2026-01-11T11:24:50.0309739Z     |     response = self._send_handling_auth(
2026-01-11T11:24:50.0310103Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 942, in _send_handling_auth
2026-01-11T11:24:50.0310204Z     |     response = self._send_handling_redirects(
2026-01-11T11:24:50.0310581Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
2026-01-11T11:24:50.0310697Z     |     response = self._send_single_request(request)
2026-01-11T11:24:50.0311062Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1015, in _send_single_request
2026-01-11T11:24:50.0311172Z     |     response = transport.handle_request(request)
2026-01-11T11:24:50.0311542Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 344, in handle_request
2026-01-11T11:24:50.0311614Z     |     raise exc
2026-01-11T11:24:50.0311978Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 341, in handle_request
2026-01-11T11:24:50.0312090Z     |     portal.call(self.app, scope, receive, send)
2026-01-11T11:24:50.0312408Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 334, in call
2026-01-11T11:24:50.0312570Z     |     return cast(T_Retval, self.start_task_soon(func, *args).result())
2026-01-11T11:24:50.0312876Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 458, in result
2026-01-11T11:24:50.0312954Z     |     return self.__get_result()
2026-01-11T11:24:50.0313275Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
2026-01-11T11:24:50.0313357Z     |     raise self._exception
2026-01-11T11:24:50.0313697Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 259, in _call_func
2026-01-11T11:24:50.0313870Z     |     retval = await retval_or_awaitable
2026-01-11T11:24:50.0314321Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
2026-01-11T11:24:50.0314454Z     |     await super().__call__(scope, receive, send)
2026-01-11T11:24:50.0314808Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
2026-01-11T11:24:50.0314937Z     |     await self.middleware_stack(scope, receive, send)
2026-01-11T11:24:50.0315306Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
2026-01-11T11:24:50.0315369Z     |     raise exc
2026-01-11T11:24:50.0315736Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0315956Z     |     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0316320Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0316400Z     |     with collapse_excgroups():
2026-01-11T11:24:50.0316666Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0316757Z     |     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0317119Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0317188Z     |     raise exc
2026-01-11T11:24:50.0317546Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0317687Z     |     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0318115Z     |   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0318204Z     |     "client_ip": request.client.host,
2026-01-11T11:24:50.0318345Z     | AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0318423Z     +------------------------------------
2026-01-11T11:24:50.0318428Z 
2026-01-11T11:24:50.0318596Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0318601Z 
2026-01-11T11:24:50.0318683Z Traceback (most recent call last):
2026-01-11T11:24:50.0324538Z   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/tests/test_api_basics.py", line 12, in test_health_check_structure
2026-01-11T11:24:50.0324682Z     response = client.get("/health")
2026-01-11T11:24:50.0325109Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 502, in get
2026-01-11T11:24:50.0325210Z     return super().get(
2026-01-11T11:24:50.0325567Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1054, in get
2026-01-11T11:24:50.0325652Z     return self.request(
2026-01-11T11:24:50.0326025Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 468, in request
2026-01-11T11:24:50.0326104Z     return super().request(
2026-01-11T11:24:50.0326442Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 827, in request
2026-01-11T11:24:50.0326628Z     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2026-01-11T11:24:50.0326953Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 914, in send
2026-01-11T11:24:50.0327045Z     response = self._send_handling_auth(
2026-01-11T11:24:50.0327449Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 942, in _send_handling_auth
2026-01-11T11:24:50.0327741Z     response = self._send_handling_redirects(
2026-01-11T11:24:50.0328154Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
2026-01-11T11:24:50.0328264Z     response = self._send_single_request(request)
2026-01-11T11:24:50.0328669Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1015, in _send_single_request
2026-01-11T11:24:50.0328782Z     response = transport.handle_request(request)
2026-01-11T11:24:50.0329166Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 344, in handle_request
2026-01-11T11:24:50.0329237Z     raise exc
2026-01-11T11:24:50.0329616Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 341, in handle_request
2026-01-11T11:24:50.0329737Z     portal.call(self.app, scope, receive, send)
2026-01-11T11:24:50.0330184Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 334, in call
2026-01-11T11:24:50.0330351Z     return cast(T_Retval, self.start_task_soon(func, *args).result())
2026-01-11T11:24:50.0330672Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 458, in result
2026-01-11T11:24:50.0330752Z     return self.__get_result()
2026-01-11T11:24:50.0331099Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
2026-01-11T11:24:50.0331189Z     raise self._exception
2026-01-11T11:24:50.0331564Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 259, in _call_func
2026-01-11T11:24:50.0331658Z     retval = await retval_or_awaitable
2026-01-11T11:24:50.0332028Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
2026-01-11T11:24:50.0332143Z     await super().__call__(scope, receive, send)
2026-01-11T11:24:50.0332519Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
2026-01-11T11:24:50.0332644Z     await self.middleware_stack(scope, receive, send)
2026-01-11T11:24:50.0333036Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
2026-01-11T11:24:50.0333110Z     raise exc
2026-01-11T11:24:50.0333490Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0333585Z     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0333959Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0334159Z     with collapse_excgroups():
2026-01-11T11:24:50.0334453Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0334543Z     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0334919Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0334992Z     raise exc
2026-01-11T11:24:50.0335360Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0335503Z     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0335941Z   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0336031Z     "client_ip": request.client.host,
2026-01-11T11:24:50.0336176Z AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0336182Z 
2026-01-11T11:24:50.0336481Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0336492Z 
2026-01-11T11:24:50.0336579Z     def test_health_check_structure():
2026-01-11T11:24:50.0336644Z         """
2026-01-11T11:24:50.0336797Z         Verify the /health endpoint returns the correct structure
2026-01-11T11:24:50.0336884Z         (components, status, etc.)
2026-01-11T11:24:50.0336942Z         """
2026-01-11T11:24:50.0337032Z >       response = client.get("/health")
2026-01-11T11:24:50.0337037Z 
2026-01-11T11:24:50.0337118Z tests/test_api_basics.py:12: 
2026-01-11T11:24:50.0337243Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0337541Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:502: in get
2026-01-11T11:24:50.0337615Z     return super().get(
2026-01-11T11:24:50.0337878Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:1054: in get
2026-01-11T11:24:50.0337962Z     return self.request(
2026-01-11T11:24:50.0338362Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:468: in request
2026-01-11T11:24:50.0338436Z     return super().request(
2026-01-11T11:24:50.0338703Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:827: in request
2026-01-11T11:24:50.0338889Z     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2026-01-11T11:24:50.0339146Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:914: in send
2026-01-11T11:24:50.0339232Z     response = self._send_handling_auth(
2026-01-11T11:24:50.0339547Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:942: in _send_handling_auth
2026-01-11T11:24:50.0339643Z     response = self._send_handling_redirects(
2026-01-11T11:24:50.0339968Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:979: in _send_handling_redirects
2026-01-11T11:24:50.0340093Z     response = self._send_single_request(request)
2026-01-11T11:24:50.0340403Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:1015: in _send_single_request
2026-01-11T11:24:50.0340507Z     response = transport.handle_request(request)
2026-01-11T11:24:50.0340819Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:344: in handle_request
2026-01-11T11:24:50.0340881Z     raise exc
2026-01-11T11:24:50.0341190Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:341: in handle_request
2026-01-11T11:24:50.0341298Z     portal.call(self.app, scope, receive, send)
2026-01-11T11:24:50.0341562Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py:334: in call
2026-01-11T11:24:50.0341721Z     return cast(T_Retval, self.start_task_soon(func, *args).result())
2026-01-11T11:24:50.0341975Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py:458: in result
2026-01-11T11:24:50.0342059Z     return self.__get_result()
2026-01-11T11:24:50.0342327Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py:403: in __get_result
2026-01-11T11:24:50.0342400Z     raise self._exception
2026-01-11T11:24:50.0342689Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py:259: in _call_func
2026-01-11T11:24:50.0342773Z     retval = await retval_or_awaitable
2026-01-11T11:24:50.0343068Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py:1054: in __call__
2026-01-11T11:24:50.0343172Z     await super().__call__(scope, receive, send)
2026-01-11T11:24:50.0343483Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/applications.py:123: in __call__
2026-01-11T11:24:50.0343603Z     await self.middleware_stack(scope, receive, send)
2026-01-11T11:24:50.0343930Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py:186: in __call__
2026-01-11T11:24:50.0344342Z     raise exc
2026-01-11T11:24:50.0344690Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py:164: in __call__
2026-01-11T11:24:50.0344790Z     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0345109Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py:189: in __call__
2026-01-11T11:24:50.0345189Z     with collapse_excgroups():
2026-01-11T11:24:50.0345403Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py:153: in __exit__
2026-01-11T11:24:50.0345490Z     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0345798Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py:91: in collapse_excgroups
2026-01-11T11:24:50.0345859Z     raise exc
2026-01-11T11:24:50.0346164Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py:191: in __call__
2026-01-11T11:24:50.0346418Z     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0346543Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0346549Z 
2026-01-11T11:24:50.0346755Z request = <starlette.middleware.base._CachedRequest object at 0x7f29f0410a00>
2026-01-11T11:24:50.0346983Z call_next = <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x7f29f08a9510>
2026-01-11T11:24:50.0346989Z 
2026-01-11T11:24:50.0347066Z     @app.middleware("http")
2026-01-11T11:24:50.0347214Z     async def audit_log_middleware(request: Request, call_next):
2026-01-11T11:24:50.0347273Z         """
2026-01-11T11:24:50.0347420Z         Structured Logging: Audit Trail for all API interactions.
2026-01-11T11:24:50.0347557Z         Logs: Method, Path, IP, Status, Duration, User-Agent.
2026-01-11T11:24:50.0347615Z         """
2026-01-11T11:24:50.0347693Z         start_time = time.time()
2026-01-11T11:24:50.0347758Z     
2026-01-11T11:24:50.0347842Z         # Process Request
2026-01-11T11:24:50.0347901Z         try:
2026-01-11T11:24:50.0347994Z             response = await call_next(request)
2026-01-11T11:24:50.0348090Z             status_code = response.status_code
2026-01-11T11:24:50.0348168Z         except Exception as e:
2026-01-11T11:24:50.0348240Z             status_code = 500
2026-01-11T11:24:50.0348305Z             raise e
2026-01-11T11:24:50.0348366Z         finally:
2026-01-11T11:24:50.0348499Z             process_time = (time.time() - start_time) * 1000 # ms
2026-01-11T11:24:50.0348556Z     
2026-01-11T11:24:50.0348733Z             # Sanitize sensitive paths if needed (e.g. /auth/login passwords)
2026-01-11T11:24:50.0348821Z             # For now, we trust the path logs.
2026-01-11T11:24:50.0348877Z     
2026-01-11T11:24:50.0349033Z             log_cls = logger.info if status_code < 400 else logger.warning
2026-01-11T11:24:50.0349089Z     
2026-01-11T11:24:50.0349156Z             log_data = {
2026-01-11T11:24:50.0349245Z                 "event": "api_request",
2026-01-11T11:24:50.0349338Z                 "method": request.method,
2026-01-11T11:24:50.0349422Z                 "path": request.url.path,
2026-01-11T11:24:50.0349524Z >               "client_ip": request.client.host,
2026-01-11T11:24:50.0349695Z                 "status_code": status_code,
2026-01-11T11:24:50.0349827Z                 "duration_ms": round(process_time, 2),
2026-01-11T11:24:50.0350188Z                 "user_agent": request.headers.get("user-agent", "unknown")
2026-01-11T11:24:50.0350296Z             }
2026-01-11T11:24:50.0350479Z E           AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0350485Z 
2026-01-11T11:24:50.0355048Z api/main.py:312: AttributeError
2026-01-11T11:24:50.0355269Z ----------------------------- Captured stderr call -----------------------------
2026-01-11T11:24:50.0365785Z {"timestamp": "2026-01-11 11:24:49,265", "level": "ERROR", "message": "Global Exception: 'NoneType' object has no attribute 'host'", "module": "main", "func": "global_exception_handler", "exception": "  + Exception Group Traceback (most recent call last):\n  |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n  |     yield\n  |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 190, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/_backends/_asyncio.py\", line 783, in __aexit__\n  |     raise BaseExceptionGroup(\n  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 189, in __call__\n    |     with collapse_excgroups():\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py\", line 153, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py\", line 91, in collapse_excgroups\n    |     raise exc\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |   File \"/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py\", line 312, in audit_log_middleware\n    |     \"client_ip\": request.client.host,\n    | AttributeError: 'NoneType' object has no attribute 'host'\n    +------------------------------------\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 189, in __call__\n    with collapse_excgroups():\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py\", line 153, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py\", line 91, in collapse_excgroups\n    raise exc\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py\", line 312, in audit_log_middleware\n    \"client_ip\": request.client.host,\nAttributeError: 'NoneType' object has no attribute 'host'"}
2026-01-11T11:24:50.0366277Z ------------------------------ Captured log call -------------------------------
2026-01-11T11:24:50.0366540Z ERROR    biodockify_api:main.py:323 Global Exception: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0366666Z   + Exception Group Traceback (most recent call last):
2026-01-11T11:24:50.0367052Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
2026-01-11T11:24:50.0367121Z   |     yield
2026-01-11T11:24:50.0367488Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 190, in __call__
2026-01-11T11:24:50.0367619Z   |     async with anyio.create_task_group() as task_group:
2026-01-11T11:24:50.0367985Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
2026-01-11T11:24:50.0368155Z   |     raise BaseExceptionGroup(
2026-01-11T11:24:50.0368390Z   | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
2026-01-11T11:24:50.0368473Z   +-+---------------- 1 ----------------
2026-01-11T11:24:50.0368557Z     | Traceback (most recent call last):
2026-01-11T11:24:50.0368936Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0369037Z     |     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0369405Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0369490Z     |     with collapse_excgroups():
2026-01-11T11:24:50.0369761Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0369860Z     |     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0370317Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0370383Z     |     raise exc
2026-01-11T11:24:50.0370746Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0370887Z     |     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0371307Z     |   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0371399Z     |     "client_ip": request.client.host,
2026-01-11T11:24:50.0371542Z     | AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0371616Z     +------------------------------------
2026-01-11T11:24:50.0371622Z 
2026-01-11T11:24:50.0371795Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0371812Z 
2026-01-11T11:24:50.0371898Z Traceback (most recent call last):
2026-01-11T11:24:50.0372326Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0372428Z     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0372827Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0372917Z     with collapse_excgroups():
2026-01-11T11:24:50.0373211Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0373302Z     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0373692Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0373761Z     raise exc
2026-01-11T11:24:50.0374259Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0374416Z     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0374867Z   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0374958Z     "client_ip": request.client.host,
2026-01-11T11:24:50.0375103Z AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0375263Z ________________________ test_health_check_system_info _________________________
2026-01-11T11:24:50.0375384Z   + Exception Group Traceback (most recent call last):
2026-01-11T11:24:50.0375765Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
2026-01-11T11:24:50.0375826Z   |     yield
2026-01-11T11:24:50.0376199Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 190, in __call__
2026-01-11T11:24:50.0376465Z   |     async with anyio.create_task_group() as task_group:
2026-01-11T11:24:50.0376833Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
2026-01-11T11:24:50.0376920Z   |     raise BaseExceptionGroup(
2026-01-11T11:24:50.0377153Z   | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
2026-01-11T11:24:50.0377231Z   +-+---------------- 1 ----------------
2026-01-11T11:24:50.0377315Z     | Traceback (most recent call last):
2026-01-11T11:24:50.0377648Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/runner.py", line 353, in from_call
2026-01-11T11:24:50.0377734Z     |     result: TResult | None = func()
2026-01-11T11:24:50.0378056Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/runner.py", line 245, in <lambda>
2026-01-11T11:24:50.0378156Z     |     lambda: runtest_hook(item=item, **kwds),
2026-01-11T11:24:50.0378594Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_hooks.py", line 512, in __call__
2026-01-11T11:24:50.0378803Z     |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
2026-01-11T11:24:50.0379131Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_manager.py", line 120, in _hookexec
2026-01-11T11:24:50.0379309Z     |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
2026-01-11T11:24:50.0379642Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 167, in _multicall
2026-01-11T11:24:50.0379714Z     |     raise exception
2026-01-11T11:24:50.0380048Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0380130Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0380502Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
2026-01-11T11:24:50.0380573Z     |     yield
2026-01-11T11:24:50.0380899Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0380977Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0381347Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
2026-01-11T11:24:50.0381418Z     |     return (yield)
2026-01-11T11:24:50.0381744Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0381824Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0382191Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/skipping.py", line 268, in pytest_runtest_call
2026-01-11T11:24:50.0382265Z     |     return (yield)
2026-01-11T11:24:50.0382590Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 121, in _multicall
2026-01-11T11:24:50.0382678Z     |     res = hook_impl.function(*args)
2026-01-11T11:24:50.0383039Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/runner.py", line 179, in pytest_runtest_call
2026-01-11T11:24:50.0383108Z     |     item.runtest()
2026-01-11T11:24:50.0383431Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/python.py", line 1720, in runtest
2026-01-11T11:24:50.0383552Z     |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
2026-01-11T11:24:50.0383868Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_hooks.py", line 512, in __call__
2026-01-11T11:24:50.0384223Z     |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
2026-01-11T11:24:50.0384770Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_manager.py", line 120, in _hookexec
2026-01-11T11:24:50.0384958Z     |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
2026-01-11T11:24:50.0385309Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 167, in _multicall
2026-01-11T11:24:50.0385381Z     |     raise exception
2026-01-11T11:24:50.0385710Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0385795Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0386184Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
2026-01-11T11:24:50.0386264Z     |     return result.get_result()
2026-01-11T11:24:50.0386592Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_result.py", line 103, in get_result
2026-01-11T11:24:50.0386797Z     |     raise exc.with_traceback(tb)
2026-01-11T11:24:50.0387179Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
2026-01-11T11:24:50.0387251Z     |     res = yield
2026-01-11T11:24:50.0387580Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 121, in _multicall
2026-01-11T11:24:50.0387664Z     |     res = hook_impl.function(*args)
2026-01-11T11:24:50.0388023Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/python.py", line 166, in pytest_pyfunc_call
2026-01-11T11:24:50.0388115Z     |     result = testfunction(**testargs)
2026-01-11T11:24:50.0388609Z     |   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/tests/test_api_basics.py", line 24, in test_health_check_system_info
2026-01-11T11:24:50.0388697Z     |     response = client.get("/health")
2026-01-11T11:24:50.0389045Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 502, in get
2026-01-11T11:24:50.0389121Z     |     return super().get(
2026-01-11T11:24:50.0389432Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1054, in get
2026-01-11T11:24:50.0389512Z     |     return self.request(
2026-01-11T11:24:50.0389855Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 468, in request
2026-01-11T11:24:50.0389931Z     |     return super().request(
2026-01-11T11:24:50.0390246Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 827, in request
2026-01-11T11:24:50.0390430Z     |     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2026-01-11T11:24:50.0390740Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 914, in send
2026-01-11T11:24:50.0390845Z     |     response = self._send_handling_auth(
2026-01-11T11:24:50.0391209Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 942, in _send_handling_auth
2026-01-11T11:24:50.0391311Z     |     response = self._send_handling_redirects(
2026-01-11T11:24:50.0391692Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
2026-01-11T11:24:50.0391804Z     |     response = self._send_single_request(request)
2026-01-11T11:24:50.0392171Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1015, in _send_single_request
2026-01-11T11:24:50.0392287Z     |     response = transport.handle_request(request)
2026-01-11T11:24:50.0392656Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 344, in handle_request
2026-01-11T11:24:50.0392808Z     |     raise exc
2026-01-11T11:24:50.0393180Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 341, in handle_request
2026-01-11T11:24:50.0393292Z     |     portal.call(self.app, scope, receive, send)
2026-01-11T11:24:50.0393612Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 334, in call
2026-01-11T11:24:50.0393778Z     |     return cast(T_Retval, self.start_task_soon(func, *args).result())
2026-01-11T11:24:50.0394192Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 458, in result
2026-01-11T11:24:50.0394274Z     |     return self.__get_result()
2026-01-11T11:24:50.0394600Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
2026-01-11T11:24:50.0394676Z     |     raise self._exception
2026-01-11T11:24:50.0395141Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 259, in _call_func
2026-01-11T11:24:50.0395234Z     |     retval = await retval_or_awaitable
2026-01-11T11:24:50.0395589Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
2026-01-11T11:24:50.0395694Z     |     await super().__call__(scope, receive, send)
2026-01-11T11:24:50.0396051Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
2026-01-11T11:24:50.0396180Z     |     await self.middleware_stack(scope, receive, send)
2026-01-11T11:24:50.0396554Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
2026-01-11T11:24:50.0396618Z     |     raise exc
2026-01-11T11:24:50.0396992Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0397097Z     |     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0397459Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0397544Z     |     with collapse_excgroups():
2026-01-11T11:24:50.0397806Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0397897Z     |     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0398266Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0398329Z     |     raise exc
2026-01-11T11:24:50.0398686Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0398829Z     |     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0399252Z     |   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0399341Z     |     "client_ip": request.client.host,
2026-01-11T11:24:50.0399488Z     | AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0399564Z     +------------------------------------
2026-01-11T11:24:50.0399570Z 
2026-01-11T11:24:50.0399744Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0399750Z 
2026-01-11T11:24:50.0399838Z Traceback (most recent call last):
2026-01-11T11:24:50.0400382Z   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/tests/test_api_basics.py", line 24, in test_health_check_system_info
2026-01-11T11:24:50.0400473Z     response = client.get("/health")
2026-01-11T11:24:50.0400836Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 502, in get
2026-01-11T11:24:50.0401036Z     return super().get(
2026-01-11T11:24:50.0401368Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1054, in get
2026-01-11T11:24:50.0401451Z     return self.request(
2026-01-11T11:24:50.0401812Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 468, in request
2026-01-11T11:24:50.0401894Z     return super().request(
2026-01-11T11:24:50.0402222Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 827, in request
2026-01-11T11:24:50.0402409Z     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2026-01-11T11:24:50.0402732Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 914, in send
2026-01-11T11:24:50.0402820Z     response = self._send_handling_auth(
2026-01-11T11:24:50.0403200Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 942, in _send_handling_auth
2026-01-11T11:24:50.0403388Z     response = self._send_handling_redirects(
2026-01-11T11:24:50.0403790Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
2026-01-11T11:24:50.0403902Z     response = self._send_single_request(request)
2026-01-11T11:24:50.0404504Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1015, in _send_single_request
2026-01-11T11:24:50.0404619Z     response = transport.handle_request(request)
2026-01-11T11:24:50.0405012Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 344, in handle_request
2026-01-11T11:24:50.0405083Z     raise exc
2026-01-11T11:24:50.0405462Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 341, in handle_request
2026-01-11T11:24:50.0405584Z     portal.call(self.app, scope, receive, send)
2026-01-11T11:24:50.0405920Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 334, in call
2026-01-11T11:24:50.0406103Z     return cast(T_Retval, self.start_task_soon(func, *args).result())
2026-01-11T11:24:50.0406419Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 458, in result
2026-01-11T11:24:50.0406500Z     return self.__get_result()
2026-01-11T11:24:50.0406839Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
2026-01-11T11:24:50.0406924Z     raise self._exception
2026-01-11T11:24:50.0407275Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 259, in _call_func
2026-01-11T11:24:50.0407371Z     retval = await retval_or_awaitable
2026-01-11T11:24:50.0407734Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
2026-01-11T11:24:50.0407842Z     await super().__call__(scope, receive, send)
2026-01-11T11:24:50.0408213Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
2026-01-11T11:24:50.0408337Z     await self.middleware_stack(scope, receive, send)
2026-01-11T11:24:50.0408728Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
2026-01-11T11:24:50.0408796Z     raise exc
2026-01-11T11:24:50.0409177Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0409274Z     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0409648Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0409859Z     with collapse_excgroups():
2026-01-11T11:24:50.0410159Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0410251Z     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0410642Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0410710Z     raise exc
2026-01-11T11:24:50.0411084Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0411225Z     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0411658Z   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0411746Z     "client_ip": request.client.host,
2026-01-11T11:24:50.0411889Z AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0411898Z 
2026-01-11T11:24:50.0412183Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0412188Z 
2026-01-11T11:24:50.0412273Z     def test_health_check_system_info():
2026-01-11T11:24:50.0412337Z         """
2026-01-11T11:24:50.0412460Z         Verify system info is being populated (RAM/Disk).
2026-01-11T11:24:50.0412518Z         """
2026-01-11T11:24:50.0412607Z >       response = client.get("/health")
2026-01-11T11:24:50.0412612Z 
2026-01-11T11:24:50.0412694Z tests/test_api_basics.py:24: 
2026-01-11T11:24:50.0412820Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0413119Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:502: in get
2026-01-11T11:24:50.0413192Z     return super().get(
2026-01-11T11:24:50.0413453Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:1054: in get
2026-01-11T11:24:50.0413527Z     return self.request(
2026-01-11T11:24:50.0413836Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:468: in request
2026-01-11T11:24:50.0413911Z     return super().request(
2026-01-11T11:24:50.0414283Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:827: in request
2026-01-11T11:24:50.0414497Z     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2026-01-11T11:24:50.0414754Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:914: in send
2026-01-11T11:24:50.0414839Z     response = self._send_handling_auth(
2026-01-11T11:24:50.0415151Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:942: in _send_handling_auth
2026-01-11T11:24:50.0415248Z     response = self._send_handling_redirects(
2026-01-11T11:24:50.0415573Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:979: in _send_handling_redirects
2026-01-11T11:24:50.0415686Z     response = self._send_single_request(request)
2026-01-11T11:24:50.0416006Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:1015: in _send_single_request
2026-01-11T11:24:50.0416110Z     response = transport.handle_request(request)
2026-01-11T11:24:50.0416428Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:344: in handle_request
2026-01-11T11:24:50.0416490Z     raise exc
2026-01-11T11:24:50.0416803Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:341: in handle_request
2026-01-11T11:24:50.0416905Z     portal.call(self.app, scope, receive, send)
2026-01-11T11:24:50.0417179Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py:334: in call
2026-01-11T11:24:50.0417335Z     return cast(T_Retval, self.start_task_soon(func, *args).result())
2026-01-11T11:24:50.0417589Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py:458: in result
2026-01-11T11:24:50.0417793Z     return self.__get_result()
2026-01-11T11:24:50.0418064Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py:403: in __get_result
2026-01-11T11:24:50.0418140Z     raise self._exception
2026-01-11T11:24:50.0418434Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py:259: in _call_func
2026-01-11T11:24:50.0418516Z     retval = await retval_or_awaitable
2026-01-11T11:24:50.0418819Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py:1054: in __call__
2026-01-11T11:24:50.0418926Z     await super().__call__(scope, receive, send)
2026-01-11T11:24:50.0419236Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/applications.py:123: in __call__
2026-01-11T11:24:50.0419353Z     await self.middleware_stack(scope, receive, send)
2026-01-11T11:24:50.0419681Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py:186: in __call__
2026-01-11T11:24:50.0419850Z     raise exc
2026-01-11T11:24:50.0420168Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py:164: in __call__
2026-01-11T11:24:50.0420256Z     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0420570Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py:189: in __call__
2026-01-11T11:24:50.0420648Z     with collapse_excgroups():
2026-01-11T11:24:50.0420859Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py:153: in __exit__
2026-01-11T11:24:50.0420951Z     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0421262Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py:91: in collapse_excgroups
2026-01-11T11:24:50.0421322Z     raise exc
2026-01-11T11:24:50.0421629Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py:191: in __call__
2026-01-11T11:24:50.0421766Z     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0421892Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0421898Z 
2026-01-11T11:24:50.0422107Z request = <starlette.middleware.base._CachedRequest object at 0x7f29ef136890>
2026-01-11T11:24:50.0422333Z call_next = <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x7f29f06b71c0>
2026-01-11T11:24:50.0422338Z 
2026-01-11T11:24:50.0422414Z     @app.middleware("http")
2026-01-11T11:24:50.0422564Z     async def audit_log_middleware(request: Request, call_next):
2026-01-11T11:24:50.0422623Z         """
2026-01-11T11:24:50.0422774Z         Structured Logging: Audit Trail for all API interactions.
2026-01-11T11:24:50.0422906Z         Logs: Method, Path, IP, Status, Duration, User-Agent.
2026-01-11T11:24:50.0422969Z         """
2026-01-11T11:24:50.0423048Z         start_time = time.time()
2026-01-11T11:24:50.0423107Z     
2026-01-11T11:24:50.0423187Z         # Process Request
2026-01-11T11:24:50.0423255Z         try:
2026-01-11T11:24:50.0423348Z             response = await call_next(request)
2026-01-11T11:24:50.0423444Z             status_code = response.status_code
2026-01-11T11:24:50.0423521Z         except Exception as e:
2026-01-11T11:24:50.0423591Z             status_code = 500
2026-01-11T11:24:50.0423652Z             raise e
2026-01-11T11:24:50.0423717Z         finally:
2026-01-11T11:24:50.0423846Z             process_time = (time.time() - start_time) * 1000 # ms
2026-01-11T11:24:50.0423904Z     
2026-01-11T11:24:50.0424254Z             # Sanitize sensitive paths if needed (e.g. /auth/login passwords)
2026-01-11T11:24:50.0424354Z             # For now, we trust the path logs.
2026-01-11T11:24:50.0424412Z     
2026-01-11T11:24:50.0424565Z             log_cls = logger.info if status_code < 400 else logger.warning
2026-01-11T11:24:50.0424629Z     
2026-01-11T11:24:50.0424697Z             log_data = {
2026-01-11T11:24:50.0424777Z                 "event": "api_request",
2026-01-11T11:24:50.0424992Z                 "method": request.method,
2026-01-11T11:24:50.0425073Z                 "path": request.url.path,
2026-01-11T11:24:50.0425166Z >               "client_ip": request.client.host,
2026-01-11T11:24:50.0425245Z                 "status_code": status_code,
2026-01-11T11:24:50.0425361Z                 "duration_ms": round(process_time, 2),
2026-01-11T11:24:50.0425507Z                 "user_agent": request.headers.get("user-agent", "unknown")
2026-01-11T11:24:50.0425565Z             }
2026-01-11T11:24:50.0425724Z E           AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0425729Z 
2026-01-11T11:24:50.0425809Z api/main.py:312: AttributeError
2026-01-11T11:24:50.0425969Z ----------------------------- Captured stderr call -----------------------------
2026-01-11T11:24:50.0436373Z {"timestamp": "2026-01-11 11:24:49,447", "level": "ERROR", "message": "Global Exception: 'NoneType' object has no attribute 'host'", "module": "main", "func": "global_exception_handler", "exception": "  + Exception Group Traceback (most recent call last):\n  |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n  |     yield\n  |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 190, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/_backends/_asyncio.py\", line 783, in __aexit__\n  |     raise BaseExceptionGroup(\n  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 189, in __call__\n    |     with collapse_excgroups():\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py\", line 153, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py\", line 91, in collapse_excgroups\n    |     raise exc\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |   File \"/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py\", line 312, in audit_log_middleware\n    |     \"client_ip\": request.client.host,\n    | AttributeError: 'NoneType' object has no attribute 'host'\n    +------------------------------------\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 189, in __call__\n    with collapse_excgroups():\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py\", line 153, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py\", line 91, in collapse_excgroups\n    raise exc\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py\", line 312, in audit_log_middleware\n    \"client_ip\": request.client.host,\nAttributeError: 'NoneType' object has no attribute 'host'"}
2026-01-11T11:24:50.0436776Z ------------------------------ Captured log call -------------------------------
2026-01-11T11:24:50.0437027Z ERROR    biodockify_api:main.py:323 Global Exception: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0437147Z   + Exception Group Traceback (most recent call last):
2026-01-11T11:24:50.0437528Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
2026-01-11T11:24:50.0437592Z   |     yield
2026-01-11T11:24:50.0437959Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 190, in __call__
2026-01-11T11:24:50.0438084Z   |     async with anyio.create_task_group() as task_group:
2026-01-11T11:24:50.0438446Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
2026-01-11T11:24:50.0438615Z   |     raise BaseExceptionGroup(
2026-01-11T11:24:50.0438846Z   | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
2026-01-11T11:24:50.0438931Z   +-+---------------- 1 ----------------
2026-01-11T11:24:50.0439015Z     | Traceback (most recent call last):
2026-01-11T11:24:50.0439394Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0439496Z     |     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0439871Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0439952Z     |     with collapse_excgroups():
2026-01-11T11:24:50.0440221Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0440316Z     |     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0440685Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0440759Z     |     raise exc
2026-01-11T11:24:50.0441120Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0441256Z     |     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0441674Z     |   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0441770Z     |     "client_ip": request.client.host,
2026-01-11T11:24:50.0441912Z     | AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0441988Z     +------------------------------------
2026-01-11T11:24:50.0441993Z 
2026-01-11T11:24:50.0442168Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0442174Z 
2026-01-11T11:24:50.0442266Z Traceback (most recent call last):
2026-01-11T11:24:50.0442680Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0442779Z     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0443166Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0443255Z     with collapse_excgroups():
2026-01-11T11:24:50.0443532Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0443622Z     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0444006Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0444280Z     raise exc
2026-01-11T11:24:50.0444671Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0444950Z     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0445395Z   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0445490Z     "client_ip": request.client.host,
2026-01-11T11:24:50.0445631Z AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0445787Z ____________________________ test_settings_endpoint ____________________________
2026-01-11T11:24:50.0445905Z   + Exception Group Traceback (most recent call last):
2026-01-11T11:24:50.0446285Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
2026-01-11T11:24:50.0446345Z   |     yield
2026-01-11T11:24:50.0446707Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 190, in __call__
2026-01-11T11:24:50.0446944Z   |     async with anyio.create_task_group() as task_group:
2026-01-11T11:24:50.0447309Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
2026-01-11T11:24:50.0447394Z   |     raise BaseExceptionGroup(
2026-01-11T11:24:50.0447629Z   | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
2026-01-11T11:24:50.0447704Z   +-+---------------- 1 ----------------
2026-01-11T11:24:50.0447787Z     | Traceback (most recent call last):
2026-01-11T11:24:50.0448123Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/runner.py", line 353, in from_call
2026-01-11T11:24:50.0448203Z     |     result: TResult | None = func()
2026-01-11T11:24:50.0448525Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/runner.py", line 245, in <lambda>
2026-01-11T11:24:50.0448626Z     |     lambda: runtest_hook(item=item, **kwds),
2026-01-11T11:24:50.0448955Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_hooks.py", line 512, in __call__
2026-01-11T11:24:50.0449160Z     |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
2026-01-11T11:24:50.0449496Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_manager.py", line 120, in _hookexec
2026-01-11T11:24:50.0449669Z     |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
2026-01-11T11:24:50.0450003Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 167, in _multicall
2026-01-11T11:24:50.0450083Z     |     raise exception
2026-01-11T11:24:50.0450419Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0450504Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0450875Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
2026-01-11T11:24:50.0450948Z     |     yield
2026-01-11T11:24:50.0451276Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0451354Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0451727Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
2026-01-11T11:24:50.0451797Z     |     return (yield)
2026-01-11T11:24:50.0452126Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0452209Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0452579Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/skipping.py", line 268, in pytest_runtest_call
2026-01-11T11:24:50.0452648Z     |     return (yield)
2026-01-11T11:24:50.0453107Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 121, in _multicall
2026-01-11T11:24:50.0453191Z     |     res = hook_impl.function(*args)
2026-01-11T11:24:50.0453654Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/runner.py", line 179, in pytest_runtest_call
2026-01-11T11:24:50.0453791Z     |     item.runtest()
2026-01-11T11:24:50.0454220Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/python.py", line 1720, in runtest
2026-01-11T11:24:50.0454345Z     |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
2026-01-11T11:24:50.0454667Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_hooks.py", line 512, in __call__
2026-01-11T11:24:50.0454877Z     |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
2026-01-11T11:24:50.0455208Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_manager.py", line 120, in _hookexec
2026-01-11T11:24:50.0455530Z     |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
2026-01-11T11:24:50.0455870Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 167, in _multicall
2026-01-11T11:24:50.0455942Z     |     raise exception
2026-01-11T11:24:50.0456270Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0456355Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0456740Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
2026-01-11T11:24:50.0456820Z     |     return result.get_result()
2026-01-11T11:24:50.0457152Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_result.py", line 103, in get_result
2026-01-11T11:24:50.0457244Z     |     raise exc.with_traceback(tb)
2026-01-11T11:24:50.0457626Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
2026-01-11T11:24:50.0457698Z     |     res = yield
2026-01-11T11:24:50.0458026Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 121, in _multicall
2026-01-11T11:24:50.0458109Z     |     res = hook_impl.function(*args)
2026-01-11T11:24:50.0458475Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/python.py", line 166, in pytest_pyfunc_call
2026-01-11T11:24:50.0458562Z     |     result = testfunction(**testargs)
2026-01-11T11:24:50.0459028Z     |   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/tests/test_api_basics.py", line 35, in test_settings_endpoint
2026-01-11T11:24:50.0459131Z     |     response = client.get("/api/settings")
2026-01-11T11:24:50.0459468Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 502, in get
2026-01-11T11:24:50.0459544Z     |     return super().get(
2026-01-11T11:24:50.0459854Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1054, in get
2026-01-11T11:24:50.0459935Z     |     return self.request(
2026-01-11T11:24:50.0460277Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 468, in request
2026-01-11T11:24:50.0460352Z     |     return super().request(
2026-01-11T11:24:50.0460670Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 827, in request
2026-01-11T11:24:50.0460853Z     |     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2026-01-11T11:24:50.0461160Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 914, in send
2026-01-11T11:24:50.0461380Z     |     response = self._send_handling_auth(
2026-01-11T11:24:50.0461747Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 942, in _send_handling_auth
2026-01-11T11:24:50.0461849Z     |     response = self._send_handling_redirects(
2026-01-11T11:24:50.0462235Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
2026-01-11T11:24:50.0462347Z     |     response = self._send_single_request(request)
2026-01-11T11:24:50.0462715Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1015, in _send_single_request
2026-01-11T11:24:50.0462832Z     |     response = transport.handle_request(request)
2026-01-11T11:24:50.0463198Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 344, in handle_request
2026-01-11T11:24:50.0463339Z     |     raise exc
2026-01-11T11:24:50.0463706Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 341, in handle_request
2026-01-11T11:24:50.0463816Z     |     portal.call(self.app, scope, receive, send)
2026-01-11T11:24:50.0464331Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 334, in call
2026-01-11T11:24:50.0464521Z     |     return cast(T_Retval, self.start_task_soon(func, *args).result())
2026-01-11T11:24:50.0464843Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 458, in result
2026-01-11T11:24:50.0464921Z     |     return self.__get_result()
2026-01-11T11:24:50.0465247Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
2026-01-11T11:24:50.0465324Z     |     raise self._exception
2026-01-11T11:24:50.0465660Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 259, in _call_func
2026-01-11T11:24:50.0465760Z     |     retval = await retval_or_awaitable
2026-01-11T11:24:50.0466117Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
2026-01-11T11:24:50.0466224Z     |     await super().__call__(scope, receive, send)
2026-01-11T11:24:50.0466580Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
2026-01-11T11:24:50.0466711Z     |     await self.middleware_stack(scope, receive, send)
2026-01-11T11:24:50.0467085Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
2026-01-11T11:24:50.0467148Z     |     raise exc
2026-01-11T11:24:50.0467522Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0467626Z     |     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0467990Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0468074Z     |     with collapse_excgroups():
2026-01-11T11:24:50.0468337Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0468430Z     |     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0468798Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0468859Z     |     raise exc
2026-01-11T11:24:50.0469217Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0469358Z     |     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0469908Z     |   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0469999Z     |     "client_ip": request.client.host,
2026-01-11T11:24:50.0470145Z     | AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0470220Z     +------------------------------------
2026-01-11T11:24:50.0470226Z 
2026-01-11T11:24:50.0470395Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0470401Z 
2026-01-11T11:24:50.0470488Z Traceback (most recent call last):
2026-01-11T11:24:50.0470997Z   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/tests/test_api_basics.py", line 35, in test_settings_endpoint
2026-01-11T11:24:50.0471096Z     response = client.get("/api/settings")
2026-01-11T11:24:50.0471448Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 502, in get
2026-01-11T11:24:50.0471640Z     return super().get(
2026-01-11T11:24:50.0471978Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1054, in get
2026-01-11T11:24:50.0472061Z     return self.request(
2026-01-11T11:24:50.0472426Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 468, in request
2026-01-11T11:24:50.0472506Z     return super().request(
2026-01-11T11:24:50.0472844Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 827, in request
2026-01-11T11:24:50.0473029Z     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2026-01-11T11:24:50.0473352Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 914, in send
2026-01-11T11:24:50.0473442Z     response = self._send_handling_auth(
2026-01-11T11:24:50.0473820Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 942, in _send_handling_auth
2026-01-11T11:24:50.0473933Z     response = self._send_handling_redirects(
2026-01-11T11:24:50.0474436Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
2026-01-11T11:24:50.0474546Z     response = self._send_single_request(request)
2026-01-11T11:24:50.0474935Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1015, in _send_single_request
2026-01-11T11:24:50.0475042Z     response = transport.handle_request(request)
2026-01-11T11:24:50.0475427Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 344, in handle_request
2026-01-11T11:24:50.0475497Z     raise exc
2026-01-11T11:24:50.0475875Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 341, in handle_request
2026-01-11T11:24:50.0475990Z     portal.call(self.app, scope, receive, send)
2026-01-11T11:24:50.0476325Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 334, in call
2026-01-11T11:24:50.0476486Z     return cast(T_Retval, self.start_task_soon(func, *args).result())
2026-01-11T11:24:50.0476807Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 458, in result
2026-01-11T11:24:50.0476886Z     return self.__get_result()
2026-01-11T11:24:50.0477223Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
2026-01-11T11:24:50.0477310Z     raise self._exception
2026-01-11T11:24:50.0477660Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 259, in _call_func
2026-01-11T11:24:50.0477751Z     retval = await retval_or_awaitable
2026-01-11T11:24:50.0478117Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
2026-01-11T11:24:50.0478348Z     await super().__call__(scope, receive, send)
2026-01-11T11:24:50.0478721Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
2026-01-11T11:24:50.0478842Z     await self.middleware_stack(scope, receive, send)
2026-01-11T11:24:50.0479233Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
2026-01-11T11:24:50.0479301Z     raise exc
2026-01-11T11:24:50.0479691Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0479784Z     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0480159Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0480238Z     with collapse_excgroups():
2026-01-11T11:24:50.0480625Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0480714Z     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0481098Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0481169Z     raise exc
2026-01-11T11:24:50.0481540Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0481679Z     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0482112Z   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0482200Z     "client_ip": request.client.host,
2026-01-11T11:24:50.0482345Z AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0482351Z 
2026-01-11T11:24:50.0482524Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0482534Z 
2026-01-11T11:24:50.0482614Z     def test_settings_endpoint():
2026-01-11T11:24:50.0482676Z         """
2026-01-11T11:24:50.0482758Z         Verify settings can be retrieved.
2026-01-11T11:24:50.0482815Z         """
2026-01-11T11:24:50.0482911Z >       response = client.get("/api/settings")
2026-01-11T11:24:50.0482916Z 
2026-01-11T11:24:50.0482999Z tests/test_api_basics.py:35: 
2026-01-11T11:24:50.0483123Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0483408Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:502: in get
2026-01-11T11:24:50.0483485Z     return super().get(
2026-01-11T11:24:50.0483747Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:1054: in get
2026-01-11T11:24:50.0483822Z     return self.request(
2026-01-11T11:24:50.0484297Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:468: in request
2026-01-11T11:24:50.0484387Z     return super().request(
2026-01-11T11:24:50.0484658Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:827: in request
2026-01-11T11:24:50.0484843Z     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2026-01-11T11:24:50.0485099Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:914: in send
2026-01-11T11:24:50.0485184Z     response = self._send_handling_auth(
2026-01-11T11:24:50.0485490Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:942: in _send_handling_auth
2026-01-11T11:24:50.0485594Z     response = self._send_handling_redirects(
2026-01-11T11:24:50.0485921Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:979: in _send_handling_redirects
2026-01-11T11:24:50.0486025Z     response = self._send_single_request(request)
2026-01-11T11:24:50.0486485Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:1015: in _send_single_request
2026-01-11T11:24:50.0486591Z     response = transport.handle_request(request)
2026-01-11T11:24:50.0486908Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:344: in handle_request
2026-01-11T11:24:50.0486976Z     raise exc
2026-01-11T11:24:50.0487286Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:341: in handle_request
2026-01-11T11:24:50.0487389Z     portal.call(self.app, scope, receive, send)
2026-01-11T11:24:50.0487668Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py:334: in call
2026-01-11T11:24:50.0487826Z     return cast(T_Retval, self.start_task_soon(func, *args).result())
2026-01-11T11:24:50.0488079Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py:458: in result
2026-01-11T11:24:50.0488159Z     return self.__get_result()
2026-01-11T11:24:50.0488540Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py:403: in __get_result
2026-01-11T11:24:50.0488614Z     raise self._exception
2026-01-11T11:24:50.0488901Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py:259: in _call_func
2026-01-11T11:24:50.0488989Z     retval = await retval_or_awaitable
2026-01-11T11:24:50.0489291Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py:1054: in __call__
2026-01-11T11:24:50.0489390Z     await super().__call__(scope, receive, send)
2026-01-11T11:24:50.0489701Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/applications.py:123: in __call__
2026-01-11T11:24:50.0489822Z     await self.middleware_stack(scope, receive, send)
2026-01-11T11:24:50.0490144Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py:186: in __call__
2026-01-11T11:24:50.0490214Z     raise exc
2026-01-11T11:24:50.0490535Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py:164: in __call__
2026-01-11T11:24:50.0490623Z     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0490938Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py:189: in __call__
2026-01-11T11:24:50.0491017Z     with collapse_excgroups():
2026-01-11T11:24:50.0491228Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py:153: in __exit__
2026-01-11T11:24:50.0491318Z     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0491627Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py:91: in collapse_excgroups
2026-01-11T11:24:50.0491687Z     raise exc
2026-01-11T11:24:50.0491991Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py:191: in __call__
2026-01-11T11:24:50.0492128Z     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0492259Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0492264Z 
2026-01-11T11:24:50.0492466Z request = <starlette.middleware.base._CachedRequest object at 0x7f29eef5ad10>
2026-01-11T11:24:50.0492698Z call_next = <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x7f29f036fa30>
2026-01-11T11:24:50.0492703Z 
2026-01-11T11:24:50.0492780Z     @app.middleware("http")
2026-01-11T11:24:50.0492925Z     async def audit_log_middleware(request: Request, call_next):
2026-01-11T11:24:50.0492988Z         """
2026-01-11T11:24:50.0493132Z         Structured Logging: Audit Trail for all API interactions.
2026-01-11T11:24:50.0493261Z         Logs: Method, Path, IP, Status, Duration, User-Agent.
2026-01-11T11:24:50.0493324Z         """
2026-01-11T11:24:50.0493404Z         start_time = time.time()
2026-01-11T11:24:50.0493462Z     
2026-01-11T11:24:50.0493532Z         # Process Request
2026-01-11T11:24:50.0493595Z         try:
2026-01-11T11:24:50.0493778Z             response = await call_next(request)
2026-01-11T11:24:50.0493869Z             status_code = response.status_code
2026-01-11T11:24:50.0493950Z         except Exception as e:
2026-01-11T11:24:50.0494120Z             status_code = 500
2026-01-11T11:24:50.0494182Z             raise e
2026-01-11T11:24:50.0494242Z         finally:
2026-01-11T11:24:50.0494374Z             process_time = (time.time() - start_time) * 1000 # ms
2026-01-11T11:24:50.0494433Z     
2026-01-11T11:24:50.0494601Z             # Sanitize sensitive paths if needed (e.g. /auth/login passwords)
2026-01-11T11:24:50.0494695Z             # For now, we trust the path logs.
2026-01-11T11:24:50.0494752Z     
2026-01-11T11:24:50.0494901Z             log_cls = logger.info if status_code < 400 else logger.warning
2026-01-11T11:24:50.0494962Z     
2026-01-11T11:24:50.0495029Z             log_data = {
2026-01-11T11:24:50.0495108Z                 "event": "api_request",
2026-01-11T11:24:50.0495188Z                 "method": request.method,
2026-01-11T11:24:50.0495397Z                 "path": request.url.path,
2026-01-11T11:24:50.0495491Z >               "client_ip": request.client.host,
2026-01-11T11:24:50.0495571Z                 "status_code": status_code,
2026-01-11T11:24:50.0495675Z                 "duration_ms": round(process_time, 2),
2026-01-11T11:24:50.0495819Z                 "user_agent": request.headers.get("user-agent", "unknown")
2026-01-11T11:24:50.0495879Z             }
2026-01-11T11:24:50.0496031Z E           AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0496041Z 
2026-01-11T11:24:50.0496121Z api/main.py:312: AttributeError
2026-01-11T11:24:50.0496280Z ----------------------------- Captured stderr call -----------------------------
2026-01-11T11:24:50.0506870Z {"timestamp": "2026-01-11 11:24:49,611", "level": "ERROR", "message": "Global Exception: 'NoneType' object has no attribute 'host'", "module": "main", "func": "global_exception_handler", "exception": "  + Exception Group Traceback (most recent call last):\n  |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n  |     yield\n  |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 190, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/_backends/_asyncio.py\", line 783, in __aexit__\n  |     raise BaseExceptionGroup(\n  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 189, in __call__\n    |     with collapse_excgroups():\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py\", line 153, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py\", line 91, in collapse_excgroups\n    |     raise exc\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |   File \"/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py\", line 312, in audit_log_middleware\n    |     \"client_ip\": request.client.host,\n    | AttributeError: 'NoneType' object has no attribute 'host'\n    +------------------------------------\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 189, in __call__\n    with collapse_excgroups():\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py\", line 153, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py\", line 91, in collapse_excgroups\n    raise exc\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py\", line 312, in audit_log_middleware\n    \"client_ip\": request.client.host,\nAttributeError: 'NoneType' object has no attribute 'host'"}
2026-01-11T11:24:50.0507298Z ------------------------------ Captured log call -------------------------------
2026-01-11T11:24:50.0507556Z ERROR    biodockify_api:main.py:323 Global Exception: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0507677Z   + Exception Group Traceback (most recent call last):
2026-01-11T11:24:50.0508063Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
2026-01-11T11:24:50.0508128Z   |     yield
2026-01-11T11:24:50.0508493Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 190, in __call__
2026-01-11T11:24:50.0508619Z   |     async with anyio.create_task_group() as task_group:
2026-01-11T11:24:50.0508985Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
2026-01-11T11:24:50.0509071Z   |     raise BaseExceptionGroup(
2026-01-11T11:24:50.0509310Z   | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
2026-01-11T11:24:50.0509391Z   +-+---------------- 1 ----------------
2026-01-11T11:24:50.0509474Z     | Traceback (most recent call last):
2026-01-11T11:24:50.0509849Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0509946Z     |     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0510315Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0510398Z     |     with collapse_excgroups():
2026-01-11T11:24:50.0510661Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0510759Z     |     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0511122Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0511192Z     |     raise exc
2026-01-11T11:24:50.0511555Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0511691Z     |     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0512105Z     |   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0512196Z     |     "client_ip": request.client.host,
2026-01-11T11:24:50.0512341Z     | AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0512414Z     +------------------------------------
2026-01-11T11:24:50.0512420Z 
2026-01-11T11:24:50.0512589Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0512594Z 
2026-01-11T11:24:50.0512676Z Traceback (most recent call last):
2026-01-11T11:24:50.0513176Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0513274Z     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0513668Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0513751Z     with collapse_excgroups():
2026-01-11T11:24:50.0514156Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0514249Z     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0514665Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0514732Z     raise exc
2026-01-11T11:24:50.0515107Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0515409Z     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0515852Z   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0515941Z     "client_ip": request.client.host,
2026-01-11T11:24:50.0516086Z AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0516237Z ______________________________ test_rate_limiter _______________________________
2026-01-11T11:24:50.0516354Z   + Exception Group Traceback (most recent call last):
2026-01-11T11:24:50.0516728Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
2026-01-11T11:24:50.0516789Z   |     yield
2026-01-11T11:24:50.0517152Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 190, in __call__
2026-01-11T11:24:50.0517276Z   |     async with anyio.create_task_group() as task_group:
2026-01-11T11:24:50.0517646Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
2026-01-11T11:24:50.0517730Z   |     raise BaseExceptionGroup(
2026-01-11T11:24:50.0517964Z   | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
2026-01-11T11:24:50.0518040Z   +-+---------------- 1 ----------------
2026-01-11T11:24:50.0518123Z     | Traceback (most recent call last):
2026-01-11T11:24:50.0518455Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/runner.py", line 353, in from_call
2026-01-11T11:24:50.0518540Z     |     result: TResult | None = func()
2026-01-11T11:24:50.0518862Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/runner.py", line 245, in <lambda>
2026-01-11T11:24:50.0518960Z     |     lambda: runtest_hook(item=item, **kwds),
2026-01-11T11:24:50.0519292Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_hooks.py", line 512, in __call__
2026-01-11T11:24:50.0519506Z     |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
2026-01-11T11:24:50.0519835Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_manager.py", line 120, in _hookexec
2026-01-11T11:24:50.0520013Z     |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
2026-01-11T11:24:50.0520348Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 167, in _multicall
2026-01-11T11:24:50.0520420Z     |     raise exception
2026-01-11T11:24:50.0520758Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0520840Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0521210Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
2026-01-11T11:24:50.0521394Z     |     yield
2026-01-11T11:24:50.0521738Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0521818Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0522187Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
2026-01-11T11:24:50.0522259Z     |     return (yield)
2026-01-11T11:24:50.0522586Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0522665Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0523038Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/skipping.py", line 268, in pytest_runtest_call
2026-01-11T11:24:50.0523106Z     |     return (yield)
2026-01-11T11:24:50.0523433Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 121, in _multicall
2026-01-11T11:24:50.0523599Z     |     res = hook_impl.function(*args)
2026-01-11T11:24:50.0523962Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/runner.py", line 179, in pytest_runtest_call
2026-01-11T11:24:50.0524180Z     |     item.runtest()
2026-01-11T11:24:50.0524554Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/python.py", line 1720, in runtest
2026-01-11T11:24:50.0524679Z     |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
2026-01-11T11:24:50.0525001Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_hooks.py", line 512, in __call__
2026-01-11T11:24:50.0525212Z     |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
2026-01-11T11:24:50.0525544Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_manager.py", line 120, in _hookexec
2026-01-11T11:24:50.0525733Z     |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
2026-01-11T11:24:50.0526074Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 167, in _multicall
2026-01-11T11:24:50.0526145Z     |     raise exception
2026-01-11T11:24:50.0526476Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 139, in _multicall
2026-01-11T11:24:50.0526560Z     |     teardown.throw(exception)
2026-01-11T11:24:50.0526947Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
2026-01-11T11:24:50.0527028Z     |     return result.get_result()
2026-01-11T11:24:50.0527356Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_result.py", line 103, in get_result
2026-01-11T11:24:50.0527443Z     |     raise exc.with_traceback(tb)
2026-01-11T11:24:50.0527832Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
2026-01-11T11:24:50.0527897Z     |     res = yield
2026-01-11T11:24:50.0528231Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pluggy/_callers.py", line 121, in _multicall
2026-01-11T11:24:50.0528312Z     |     res = hook_impl.function(*args)
2026-01-11T11:24:50.0528674Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/_pytest/python.py", line 166, in pytest_pyfunc_call
2026-01-11T11:24:50.0528766Z     |     result = testfunction(**testargs)
2026-01-11T11:24:50.0529217Z     |   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/tests/test_api_basics.py", line 46, in test_rate_limiter
2026-01-11T11:24:50.0529304Z     |     response = client.get("/health")
2026-01-11T11:24:50.0529636Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 502, in get
2026-01-11T11:24:50.0529933Z     |     return super().get(
2026-01-11T11:24:50.0530322Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1054, in get
2026-01-11T11:24:50.0530404Z     |     return self.request(
2026-01-11T11:24:50.0530870Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 468, in request
2026-01-11T11:24:50.0530950Z     |     return super().request(
2026-01-11T11:24:50.0531284Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 827, in request
2026-01-11T11:24:50.0531472Z     |     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2026-01-11T11:24:50.0531846Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 914, in send
2026-01-11T11:24:50.0531950Z     |     response = self._send_handling_auth(
2026-01-11T11:24:50.0532452Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 942, in _send_handling_auth
2026-01-11T11:24:50.0532555Z     |     response = self._send_handling_redirects(
2026-01-11T11:24:50.0532935Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
2026-01-11T11:24:50.0533051Z     |     response = self._send_single_request(request)
2026-01-11T11:24:50.0533418Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1015, in _send_single_request
2026-01-11T11:24:50.0533531Z     |     response = transport.handle_request(request)
2026-01-11T11:24:50.0533900Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 344, in handle_request
2026-01-11T11:24:50.0533963Z     |     raise exc
2026-01-11T11:24:50.0534454Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 341, in handle_request
2026-01-11T11:24:50.0534569Z     |     portal.call(self.app, scope, receive, send)
2026-01-11T11:24:50.0534968Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 334, in call
2026-01-11T11:24:50.0535133Z     |     return cast(T_Retval, self.start_task_soon(func, *args).result())
2026-01-11T11:24:50.0535442Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 458, in result
2026-01-11T11:24:50.0535519Z     |     return self.__get_result()
2026-01-11T11:24:50.0535842Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
2026-01-11T11:24:50.0535921Z     |     raise self._exception
2026-01-11T11:24:50.0536260Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 259, in _call_func
2026-01-11T11:24:50.0536358Z     |     retval = await retval_or_awaitable
2026-01-11T11:24:50.0536714Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
2026-01-11T11:24:50.0536819Z     |     await super().__call__(scope, receive, send)
2026-01-11T11:24:50.0537173Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
2026-01-11T11:24:50.0537300Z     |     await self.middleware_stack(scope, receive, send)
2026-01-11T11:24:50.0537671Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
2026-01-11T11:24:50.0537734Z     |     raise exc
2026-01-11T11:24:50.0538102Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0538332Z     |     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0538695Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0538774Z     |     with collapse_excgroups():
2026-01-11T11:24:50.0539040Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0539135Z     |     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0539498Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0539563Z     |     raise exc
2026-01-11T11:24:50.0539922Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0540071Z     |     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0540488Z     |   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0540686Z     |     "client_ip": request.client.host,
2026-01-11T11:24:50.0540827Z     | AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0540905Z     +------------------------------------
2026-01-11T11:24:50.0540911Z 
2026-01-11T11:24:50.0541076Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0541082Z 
2026-01-11T11:24:50.0541166Z Traceback (most recent call last):
2026-01-11T11:24:50.0541655Z   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/tests/test_api_basics.py", line 46, in test_rate_limiter
2026-01-11T11:24:50.0541744Z     response = client.get("/health")
2026-01-11T11:24:50.0542087Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 502, in get
2026-01-11T11:24:50.0542167Z     return super().get(
2026-01-11T11:24:50.0542500Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1054, in get
2026-01-11T11:24:50.0542578Z     return self.request(
2026-01-11T11:24:50.0542933Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 468, in request
2026-01-11T11:24:50.0543010Z     return super().request(
2026-01-11T11:24:50.0543341Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 827, in request
2026-01-11T11:24:50.0543524Z     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2026-01-11T11:24:50.0543839Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 914, in send
2026-01-11T11:24:50.0543930Z     response = self._send_handling_auth(
2026-01-11T11:24:50.0544524Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 942, in _send_handling_auth
2026-01-11T11:24:50.0544639Z     response = self._send_handling_redirects(
2026-01-11T11:24:50.0545054Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
2026-01-11T11:24:50.0545165Z     response = self._send_single_request(request)
2026-01-11T11:24:50.0545560Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py", line 1015, in _send_single_request
2026-01-11T11:24:50.0545669Z     response = transport.handle_request(request)
2026-01-11T11:24:50.0546053Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 344, in handle_request
2026-01-11T11:24:50.0546128Z     raise exc
2026-01-11T11:24:50.0546506Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py", line 341, in handle_request
2026-01-11T11:24:50.0546612Z     portal.call(self.app, scope, receive, send)
2026-01-11T11:24:50.0547097Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 334, in call
2026-01-11T11:24:50.0547277Z     return cast(T_Retval, self.start_task_soon(func, *args).result())
2026-01-11T11:24:50.0547611Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 458, in result
2026-01-11T11:24:50.0547697Z     return self.__get_result()
2026-01-11T11:24:50.0548037Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
2026-01-11T11:24:50.0548129Z     raise self._exception
2026-01-11T11:24:50.0548490Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py", line 259, in _call_func
2026-01-11T11:24:50.0548579Z     retval = await retval_or_awaitable
2026-01-11T11:24:50.0548953Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
2026-01-11T11:24:50.0549061Z     await super().__call__(scope, receive, send)
2026-01-11T11:24:50.0549538Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
2026-01-11T11:24:50.0549665Z     await self.middleware_stack(scope, receive, send)
2026-01-11T11:24:50.0550063Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
2026-01-11T11:24:50.0550135Z     raise exc
2026-01-11T11:24:50.0550523Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0550614Z     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0551001Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0551084Z     with collapse_excgroups():
2026-01-11T11:24:50.0551374Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0551482Z     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0551869Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0551936Z     raise exc
2026-01-11T11:24:50.0552317Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0552455Z     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0552897Z   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0552986Z     "client_ip": request.client.host,
2026-01-11T11:24:50.0553125Z AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0553130Z 
2026-01-11T11:24:50.0553305Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0553320Z 
2026-01-11T11:24:50.0553396Z     def test_rate_limiter():
2026-01-11T11:24:50.0553455Z         """
2026-01-11T11:24:50.0553631Z         Verify rate limiter middleware allows requests (Integration Test).
2026-01-11T11:24:50.0553768Z         Note: We won't flood it here to avoid slowing down tests,
2026-01-11T11:24:50.0553860Z         but we ensure normal requests pass.
2026-01-11T11:24:50.0553920Z         """
2026-01-11T11:24:50.0554009Z >       response = client.get("/health")
2026-01-11T11:24:50.0554014Z 
2026-01-11T11:24:50.0554202Z tests/test_api_basics.py:46: 
2026-01-11T11:24:50.0554326Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0554633Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:502: in get
2026-01-11T11:24:50.0554707Z     return super().get(
2026-01-11T11:24:50.0554973Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:1054: in get
2026-01-11T11:24:50.0555177Z     return self.request(
2026-01-11T11:24:50.0555483Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:468: in request
2026-01-11T11:24:50.0555559Z     return super().request(
2026-01-11T11:24:50.0555831Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:827: in request
2026-01-11T11:24:50.0556012Z     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2026-01-11T11:24:50.0556272Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:914: in send
2026-01-11T11:24:50.0556357Z     response = self._send_handling_auth(
2026-01-11T11:24:50.0556673Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:942: in _send_handling_auth
2026-01-11T11:24:50.0556770Z     response = self._send_handling_redirects(
2026-01-11T11:24:50.0557101Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:979: in _send_handling_redirects
2026-01-11T11:24:50.0557318Z     response = self._send_single_request(request)
2026-01-11T11:24:50.0557638Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:1015: in _send_single_request
2026-01-11T11:24:50.0557742Z     response = transport.handle_request(request)
2026-01-11T11:24:50.0558063Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:344: in handle_request
2026-01-11T11:24:50.0558125Z     raise exc
2026-01-11T11:24:50.0558438Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/testclient.py:341: in handle_request
2026-01-11T11:24:50.0558548Z     portal.call(self.app, scope, receive, send)
2026-01-11T11:24:50.0558818Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py:334: in call
2026-01-11T11:24:50.0558976Z     return cast(T_Retval, self.start_task_soon(func, *args).result())
2026-01-11T11:24:50.0559236Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py:458: in result
2026-01-11T11:24:50.0559322Z     return self.__get_result()
2026-01-11T11:24:50.0559595Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/concurrent/futures/_base.py:403: in __get_result
2026-01-11T11:24:50.0559669Z     raise self._exception
2026-01-11T11:24:50.0559965Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/from_thread.py:259: in _call_func
2026-01-11T11:24:50.0560048Z     retval = await retval_or_awaitable
2026-01-11T11:24:50.0560347Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py:1054: in __call__
2026-01-11T11:24:50.0560452Z     await super().__call__(scope, receive, send)
2026-01-11T11:24:50.0560758Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/applications.py:123: in __call__
2026-01-11T11:24:50.0560876Z     await self.middleware_stack(scope, receive, send)
2026-01-11T11:24:50.0561204Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py:186: in __call__
2026-01-11T11:24:50.0561273Z     raise exc
2026-01-11T11:24:50.0561591Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py:164: in __call__
2026-01-11T11:24:50.0561685Z     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0561998Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py:189: in __call__
2026-01-11T11:24:50.0562077Z     with collapse_excgroups():
2026-01-11T11:24:50.0562297Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py:153: in __exit__
2026-01-11T11:24:50.0562384Z     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0562698Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py:91: in collapse_excgroups
2026-01-11T11:24:50.0562759Z     raise exc
2026-01-11T11:24:50.0563072Z /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py:191: in __call__
2026-01-11T11:24:50.0563295Z     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0563416Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2026-01-11T11:24:50.0563422Z 
2026-01-11T11:24:50.0563629Z request = <starlette.middleware.base._CachedRequest object at 0x7f29f06f3220>
2026-01-11T11:24:50.0563856Z call_next = <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x7f29f050ab90>
2026-01-11T11:24:50.0563861Z 
2026-01-11T11:24:50.0563939Z     @app.middleware("http")
2026-01-11T11:24:50.0564277Z     async def audit_log_middleware(request: Request, call_next):
2026-01-11T11:24:50.0564340Z         """
2026-01-11T11:24:50.0564488Z         Structured Logging: Audit Trail for all API interactions.
2026-01-11T11:24:50.0564625Z         Logs: Method, Path, IP, Status, Duration, User-Agent.
2026-01-11T11:24:50.0564684Z         """
2026-01-11T11:24:50.0564764Z         start_time = time.time()
2026-01-11T11:24:50.0564956Z     
2026-01-11T11:24:50.0565028Z         # Process Request
2026-01-11T11:24:50.0565089Z         try:
2026-01-11T11:24:50.0565182Z             response = await call_next(request)
2026-01-11T11:24:50.0565280Z             status_code = response.status_code
2026-01-11T11:24:50.0565357Z         except Exception as e:
2026-01-11T11:24:50.0565428Z             status_code = 500
2026-01-11T11:24:50.0565495Z             raise e
2026-01-11T11:24:50.0565558Z         finally:
2026-01-11T11:24:50.0565685Z             process_time = (time.time() - start_time) * 1000 # ms
2026-01-11T11:24:50.0565742Z     
2026-01-11T11:24:50.0565915Z             # Sanitize sensitive paths if needed (e.g. /auth/login passwords)
2026-01-11T11:24:50.0566003Z             # For now, we trust the path logs.
2026-01-11T11:24:50.0566061Z     
2026-01-11T11:24:50.0566217Z             log_cls = logger.info if status_code < 400 else logger.warning
2026-01-11T11:24:50.0566273Z     
2026-01-11T11:24:50.0566340Z             log_data = {
2026-01-11T11:24:50.0566427Z                 "event": "api_request",
2026-01-11T11:24:50.0566512Z                 "method": request.method,
2026-01-11T11:24:50.0566593Z                 "path": request.url.path,
2026-01-11T11:24:50.0566686Z >               "client_ip": request.client.host,
2026-01-11T11:24:50.0566776Z                 "status_code": status_code,
2026-01-11T11:24:50.0566876Z                 "duration_ms": round(process_time, 2),
2026-01-11T11:24:50.0567021Z                 "user_agent": request.headers.get("user-agent", "unknown")
2026-01-11T11:24:50.0567084Z             }
2026-01-11T11:24:50.0567235Z E           AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0567240Z 
2026-01-11T11:24:50.0567321Z api/main.py:312: AttributeError
2026-01-11T11:24:50.0567478Z ----------------------------- Captured stderr call -----------------------------
2026-01-11T11:24:50.0578103Z {"timestamp": "2026-01-11 11:24:49,773", "level": "ERROR", "message": "Global Exception: 'NoneType' object has no attribute 'host'", "module": "main", "func": "global_exception_handler", "exception": "  + Exception Group Traceback (most recent call last):\n  |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n  |     yield\n  |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 190, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/_backends/_asyncio.py\", line 783, in __aexit__\n  |     raise BaseExceptionGroup(\n  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 189, in __call__\n    |     with collapse_excgroups():\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py\", line 153, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py\", line 91, in collapse_excgroups\n    |     raise exc\n    |   File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |   File \"/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py\", line 312, in audit_log_middleware\n    |     \"client_ip\": request.client.host,\n    | AttributeError: 'NoneType' object has no attribute 'host'\n    +------------------------------------\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 189, in __call__\n    with collapse_excgroups():\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py\", line 153, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py\", line 91, in collapse_excgroups\n    raise exc\n  File \"/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py\", line 312, in audit_log_middleware\n    \"client_ip\": request.client.host,\nAttributeError: 'NoneType' object has no attribute 'host'"}
2026-01-11T11:24:50.0578516Z ------------------------------ Captured log call -------------------------------
2026-01-11T11:24:50.0578766Z ERROR    biodockify_api:main.py:323 Global Exception: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0578885Z   + Exception Group Traceback (most recent call last):
2026-01-11T11:24:50.0579274Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
2026-01-11T11:24:50.0579336Z   |     yield
2026-01-11T11:24:50.0579704Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 190, in __call__
2026-01-11T11:24:50.0579831Z   |     async with anyio.create_task_group() as task_group:
2026-01-11T11:24:50.0580199Z   |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
2026-01-11T11:24:50.0580290Z   |     raise BaseExceptionGroup(
2026-01-11T11:24:50.0580528Z   | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
2026-01-11T11:24:50.0580603Z   +-+---------------- 1 ----------------
2026-01-11T11:24:50.0580686Z     | Traceback (most recent call last):
2026-01-11T11:24:50.0581069Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0581168Z     |     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0581538Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0581619Z     |     with collapse_excgroups():
2026-01-11T11:24:50.0581891Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0581985Z     |     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0582436Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0582505Z     |     raise exc
2026-01-11T11:24:50.0582866Z     |   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0583003Z     |     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0583424Z     |   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0583513Z     |     "client_ip": request.client.host,
2026-01-11T11:24:50.0583654Z     | AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0583731Z     +------------------------------------
2026-01-11T11:24:50.0583737Z 
2026-01-11T11:24:50.0583904Z During handling of the above exception, another exception occurred:
2026-01-11T11:24:50.0584168Z 
2026-01-11T11:24:50.0584301Z Traceback (most recent call last):
2026-01-11T11:24:50.0584746Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
2026-01-11T11:24:50.0584846Z     await self.app(scope, receive, _send)
2026-01-11T11:24:50.0585234Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 189, in __call__
2026-01-11T11:24:50.0585325Z     with collapse_excgroups():
2026-01-11T11:24:50.0585620Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/contextlib.py", line 153, in __exit__
2026-01-11T11:24:50.0585713Z     self.gen.throw(typ, value, traceback)
2026-01-11T11:24:50.0586111Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
2026-01-11T11:24:50.0586182Z     raise exc
2026-01-11T11:24:50.0586579Z   File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/middleware/base.py", line 191, in __call__
2026-01-11T11:24:50.0586730Z     response = await self.dispatch_func(request, call_next)
2026-01-11T11:24:50.0587173Z   File "/home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py", line 312, in audit_log_middleware
2026-01-11T11:24:50.0587269Z     "client_ip": request.client.host,
2026-01-11T11:24:50.0587410Z AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:50.0587535Z =============================== warnings summary ===============================
2026-01-11T11:24:50.0587836Z ../../../../../opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/formparsers.py:10
2026-01-11T11:24:50.0588371Z   /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/starlette/formparsers.py:10: PendingDeprecationWarning: Please use `import python_multipart` instead.
2026-01-11T11:24:50.0588444Z     import multipart
2026-01-11T11:24:50.0588456Z 
2026-01-11T11:24:50.0588530Z api/main.py:82
2026-01-11T11:24:50.0588888Z   /home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py:82: DeprecationWarning: 
2026-01-11T11:24:50.0589041Z           on_event is deprecated, use lifespan event handlers instead.
2026-01-11T11:24:50.0589110Z   
2026-01-11T11:24:50.0589189Z           Read more about it in the
2026-01-11T11:24:50.0589420Z           [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
2026-01-11T11:24:50.0589481Z           
2026-01-11T11:24:50.0589563Z     @app.on_event("startup")
2026-01-11T11:24:50.0589569Z 
2026-01-11T11:24:50.0589859Z ../../../../../opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py:4495
2026-01-11T11:24:50.0590139Z ../../../../../opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py:4495
2026-01-11T11:24:50.0590493Z   /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/fastapi/applications.py:4495: DeprecationWarning: 
2026-01-11T11:24:50.0590790Z           on_event is deprecated, use lifespan event handlers instead.
2026-01-11T11:24:50.0590850Z   
2026-01-11T11:24:50.0590932Z           Read more about it in the
2026-01-11T11:24:50.0591162Z           [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
2026-01-11T11:24:50.0591221Z           
2026-01-11T11:24:50.0591320Z     return self.router.on_event(event_type)
2026-01-11T11:24:50.0591325Z 
2026-01-11T11:24:50.0591392Z api/main.py:131
2026-01-11T11:24:57.9458018Z   /home/runner/work/BioDockify-pharma-research-ai/BioDockify-pharma-research-ai/api/main.py:131: DeprecationWarning: 
2026-01-11T11:24:57.9459399Z           on_event is deprecated, use lifespan event handlers instead.
2026-01-11T11:24:57.9459974Z   
2026-01-11T11:24:57.9460258Z           Read more about it in the
2026-01-11T11:24:57.9460962Z           [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
2026-01-11T11:24:57.9462025Z           
2026-01-11T11:24:57.9462318Z     @app.on_event("shutdown")
2026-01-11T11:24:57.9462579Z 
2026-01-11T11:24:57.9462741Z <frozen importlib._bootstrap>:241
2026-01-11T11:24:57.9463587Z   <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute
2026-01-11T11:24:57.9464694Z 
2026-01-11T11:24:57.9464842Z <frozen importlib._bootstrap>:241
2026-01-11T11:24:57.9465675Z   <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute
2026-01-11T11:24:57.9466417Z 
2026-01-11T11:24:57.9466555Z <frozen importlib._bootstrap>:241
2026-01-11T11:24:57.9467356Z   <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type swigvarlink has no __module__ attribute
2026-01-11T11:24:57.9467943Z 
2026-01-11T11:24:57.9468332Z ../../../../../opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:680
2026-01-11T11:24:57.9469847Z   /opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/httpx/_client.py:680: DeprecationWarning: The 'app' shortcut is now deprecated. Use the explicit style 'transport=WSGITransport(app=...)' instead.
2026-01-11T11:24:57.9471127Z     warnings.warn(message, DeprecationWarning)
2026-01-11T11:24:57.9471403Z 
2026-01-11T11:24:57.9471660Z -- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
2026-01-11T11:24:57.9472253Z =========================== short test summary info ============================
2026-01-11T11:24:57.9474918Z FAILED tests/integration/test_phd_pipeline.py::TestPhDPipeline::test_literature_review_pipeline - requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/goal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2aeb2cdab0>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:57.9478713Z FAILED tests/integration/test_phd_pipeline.py::TestPhDPipeline::test_hypothesis_generation - requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/goal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f078ddb0>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:57.9481508Z FAILED tests/integration/test_phd_pipeline.py::TestPhDPipeline::test_api_goal_endpoint - requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/goal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f0550d90>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:57.9484405Z FAILED tests/integration/test_phd_pipeline.py::TestPhDPipeline::test_api_thinking_endpoint - requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/thinking (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f0677250>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:57.9487348Z FAILED tests/integration/test_phd_pipeline.py::TestPhDPipeline::test_docker_services - requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8070): Max retries exceeded with url: /api/version (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f0415e10>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:57.9492672Z FAILED tests/integration/test_phd_pipeline.py::TestPhDPipeline::test_frontend_loads - requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f054c520>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:57.9497655Z FAILED tests/integration/test_phd_pipeline.py::TestPhDPipeline::test_error_handling - requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/v2/agent/goal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f29f07d39d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
2026-01-11T11:24:57.9501363Z FAILED tests/integration/test_phd_pipeline.py::TestIntegration::test_concurrent_requests - AttributeError: 'TestIntegration' object has no attribute 'BASE_URL'
2026-01-11T11:24:57.9502621Z FAILED tests/test_api_basics.py::test_health_check_structure - AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:57.9503423Z FAILED tests/test_api_basics.py::test_health_check_system_info - AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:57.9504471Z FAILED tests/test_api_basics.py::test_settings_endpoint - AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:57.9505213Z FAILED tests/test_api_basics.py::test_rate_limiter - AttributeError: 'NoneType' object has no attribute 'host'
2026-01-11T11:24:57.9505766Z ============= 12 failed, 5 passed, 9 warnings in 261.07s (0:04:21) =============
2026-01-11T11:25:05.4946928Z ##[error]Process completed with exit code 1.
